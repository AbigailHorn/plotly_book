--- 
title: "Interactive web-based data visualization with R, plotly, and shiny"
author: "Carson Sievert"
date: "`r Sys.Date()`"
documentclass: krantz
bibliography: [book.bib, packages.bib]
biblio-style: apalike
link-citations: yes
colorlinks: yes
lot: false
lof: false
site: bookdown::bookdown_site
description: "A useR guide to creating highly interactive graphics for exploratory and expository visualization."
github-repo: ropensci/plotly
twitter-handle: cpsievert
#cover-image: images/plotly.png
always_allow_html: yes
fontsize: 12pt
monofont: "Source Code Pro"
monofontoptions: "Scale=0.7"
---

```{r setup, include=FALSE}
library(knitr)
# global chunk options
opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  comment = "#>",
  collapse = TRUE,
  cache = TRUE,
  fig.show = "hold",
  fig.align = "center"
)

# conditionally global chunk options
if (knitr::is_latex_output()) {
  opts_chunk$set(
    # why does specifying this lead to so many issues?
    # https://github.com/yihui/bookdown-crc/issues/3
    # https://github.com/hadley/adv-r/commit/4f99def#diff-04c6e90f
    out.width = "\\textwidth", 
    fig.width = 8, 
    fig.asp = 0.618,
    fig.pos = "H"
  )
}
if (knitr::is_html_output()) {
  opts_chunk$set(out.width = "100%")
  
  knit_hooks$set(summary = function(before, options, envir) {
    if (length(options$summary)) {
      if (before) {
        return(sprintf("<details><summary>%s</summary>\n", options$summary))
      } else {
        return("\n</details>")
      }
    }
  })
}

include_vimeo <- function(id, width = "100%", height = "400") {
  if (knitr::is_latex_output()) {
    img <- paste0("vimeo-images/", id, "/final.png")
    knitr::include_graphics(img)
  } else {
    url <- sprintf("https://player.vimeo.com/video/%s?title=0&byline=0&portrait=0", id)
    htmltools::tags$iframe(
      src = url, 
      width = width, 
      height = height, 
      frameborder = "0", 
      seamless = "seamless",
      webkitAllowFullScreen = NA, 
      mozallowfullscreen = NA, 
      allowFullScreen = NA
    )
  }
}

options(
  dplyr.print_min = 6, dplyr.print_max = 6, 
  digits = 3, htmltools.dir.version = FALSE,
  width = 55, formatR.indent = 2
)
```


```{r, echo = FALSE}
if (is_html_output()) htmltools::includeMarkdown("welcome.md")
```
