<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>31 Improving ggplotly() | Interactive web-based data visualization with R, plotly, and shiny</title>
  <meta name="description" content="A useR guide to creating highly interactive graphics for exploratory and expository visualization.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="31 Improving ggplotly() | Interactive web-based data visualization with R, plotly, and shiny" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A useR guide to creating highly interactive graphics for exploratory and expository visualization." />
  <meta name="github-repo" content="ropensci/plotly" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="31 Improving ggplotly() | Interactive web-based data visualization with R, plotly, and shiny" />
  <meta name="twitter:site" content="@cpsievert" />
  <meta name="twitter:description" content="A useR guide to creating highly interactive graphics for exploratory and expository visualization." />
  

<meta name="author" content="Carson Sievert">


<meta name="date" content="2019-03-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="the-data-plot-pipeline.html">
<link rel="next" href="embedding-images.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>
<link href="libs/selectize/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize/selectize.min.js"></script>
<link href="libs/colourpicker/colourpicker.min.css" rel="stylesheet" />
<script src="libs/colourpicker/colourpicker.min.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/plotly.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/summary-fix.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#why-interactive-web-graphics-from-r"><i class="fa fa-check"></i><b>1.1</b> Why interactive web graphics <em>from R</em>?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-you-will-learn"><i class="fa fa-check"></i><b>1.2</b> What you will learn</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-you-wont-learn"><i class="fa fa-check"></i><b>1.3</b> What you won’t learn</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#web-technologies"><i class="fa fa-check"></i><b>1.3.1</b> Web technologies</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#d3js"><i class="fa fa-check"></i><b>1.3.2</b> d3js</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#ggplot2"><i class="fa fa-check"></i><b>1.3.3</b> ggplot2</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#graphical-data-analysis"><i class="fa fa-check"></i><b>1.3.4</b> Graphical data analysis</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#data-visualization-best-practices"><i class="fa fa-check"></i><b>1.3.5</b> Data visualization best practices</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#prerequisites"><i class="fa fa-check"></i><b>1.4</b> Prerequisites</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#run-code-examples"><i class="fa fa-check"></i><b>1.5</b> Run code examples</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#getting-help-and-learning-more"><i class="fa fa-check"></i><b>1.6</b> Getting help and learning more</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#acknowledgements"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.8</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Creating views</b></span></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a><ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#intro-plotly"><i class="fa fa-check"></i><b>2.1</b> Intro to <code>plot_ly()</code></a></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#intro-plotly-js"><i class="fa fa-check"></i><b>2.2</b> Intro to plotly.js</a></li>
<li class="chapter" data-level="2.3" data-path="overview.html"><a href="overview.html#intro-ggplotly"><i class="fa fa-check"></i><b>2.3</b> Intro to <code>ggplotly()</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scatter-traces.html"><a href="scatter-traces.html"><i class="fa fa-check"></i><b>3</b> Scattered foundations</a><ul>
<li class="chapter" data-level="3.1" data-path="scatter-traces.html"><a href="scatter-traces.html#markers"><i class="fa fa-check"></i><b>3.1</b> Markers</a><ul>
<li class="chapter" data-level="3.1.1" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-alpha"><i class="fa fa-check"></i><b>3.1.1</b> Alpha blending</a></li>
<li class="chapter" data-level="3.1.2" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-color"><i class="fa fa-check"></i><b>3.1.2</b> Colors</a></li>
<li class="chapter" data-level="3.1.3" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-symbol"><i class="fa fa-check"></i><b>3.1.3</b> Symbols</a></li>
<li class="chapter" data-level="3.1.4" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-stroke"><i class="fa fa-check"></i><b>3.1.4</b> Stroke and span</a></li>
<li class="chapter" data-level="3.1.5" data-path="scatter-traces.html"><a href="scatter-traces.html#marker-size"><i class="fa fa-check"></i><b>3.1.5</b> Size</a></li>
<li class="chapter" data-level="3.1.6" data-path="scatter-traces.html"><a href="scatter-traces.html#dot-plots"><i class="fa fa-check"></i><b>3.1.6</b> Dotplots &amp; error bars</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="scatter-traces.html"><a href="scatter-traces.html#lines"><i class="fa fa-check"></i><b>3.2</b> Lines</a><ul>
<li class="chapter" data-level="3.2.1" data-path="scatter-traces.html"><a href="scatter-traces.html#linetypes"><i class="fa fa-check"></i><b>3.2.1</b> Linetypes</a></li>
<li class="chapter" data-level="3.2.2" data-path="scatter-traces.html"><a href="scatter-traces.html#segments"><i class="fa fa-check"></i><b>3.2.2</b> Segments</a></li>
<li class="chapter" data-level="3.2.3" data-path="scatter-traces.html"><a href="scatter-traces.html#density-plots"><i class="fa fa-check"></i><b>3.2.3</b> Density plots</a></li>
<li class="chapter" data-level="3.2.4" data-path="scatter-traces.html"><a href="scatter-traces.html#parallel-coordinates"><i class="fa fa-check"></i><b>3.2.4</b> Parallel Coordinates</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scatter-traces.html"><a href="scatter-traces.html#polygons"><i class="fa fa-check"></i><b>3.3</b> Polygons</a><ul>
<li class="chapter" data-level="3.3.1" data-path="scatter-traces.html"><a href="scatter-traces.html#ribbons"><i class="fa fa-check"></i><b>3.3.1</b> Ribbons</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>4</b> Maps</a><ul>
<li class="chapter" data-level="4.1" data-path="maps.html"><a href="maps.html#maps-integrated"><i class="fa fa-check"></i><b>4.1</b> Integrated maps</a><ul>
<li class="chapter" data-level="4.1.1" data-path="maps.html"><a href="maps.html#overview-1"><i class="fa fa-check"></i><b>4.1.1</b> Overview</a></li>
<li class="chapter" data-level="4.1.2" data-path="maps.html"><a href="maps.html#choropleths"><i class="fa fa-check"></i><b>4.1.2</b> Choropleths</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="maps.html"><a href="maps.html#maps-custom"><i class="fa fa-check"></i><b>4.2</b> Custom maps</a><ul>
<li class="chapter" data-level="4.2.1" data-path="maps.html"><a href="maps.html#sf"><i class="fa fa-check"></i><b>4.2.1</b> Simple features (sf)</a></li>
<li class="chapter" data-level="4.2.2" data-path="maps.html"><a href="maps.html#cartograms"><i class="fa fa-check"></i><b>4.2.2</b> Cartograms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bars-histograms.html"><a href="bars-histograms.html"><i class="fa fa-check"></i><b>5</b> Bars &amp; histograms</a><ul>
<li class="chapter" data-level="5.1" data-path="bars-histograms.html"><a href="bars-histograms.html#multiple-numeric-distributions"><i class="fa fa-check"></i><b>5.1</b> Multiple numeric distributions</a></li>
<li class="chapter" data-level="5.2" data-path="bars-histograms.html"><a href="bars-histograms.html#multiple-discrete-distributions"><i class="fa fa-check"></i><b>5.2</b> Multiple discrete distributions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>6</b> Boxplots</a></li>
<li class="chapter" data-level="7" data-path="frequencies-2D.html"><a href="frequencies-2D.html"><i class="fa fa-check"></i><b>7</b> 2D frequencies</a><ul>
<li class="chapter" data-level="7.1" data-path="frequencies-2D.html"><a href="frequencies-2D.html#rectangular-binning-in-plotly.js"><i class="fa fa-check"></i><b>7.1</b> Rectangular binning in plotly.js</a></li>
<li class="chapter" data-level="7.2" data-path="frequencies-2D.html"><a href="frequencies-2D.html#rectangular-binning-in-r"><i class="fa fa-check"></i><b>7.2</b> Rectangular binning in R</a></li>
<li class="chapter" data-level="7.3" data-path="frequencies-2D.html"><a href="frequencies-2D.html#categorical-axes"><i class="fa fa-check"></i><b>7.3</b> Categorical axes</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="d-charts.html"><a href="d-charts.html"><i class="fa fa-check"></i><b>8</b> 3D charts</a><ul>
<li class="chapter" data-level="8.0.1" data-path="d-charts.html"><a href="d-charts.html#markers-and-lines"><i class="fa fa-check"></i><b>8.0.1</b> Markers and lines</a></li>
<li class="chapter" data-level="8.0.2" data-path="d-charts.html"><a href="d-charts.html#d-paths"><i class="fa fa-check"></i><b>8.0.2</b> 3D paths</a></li>
<li class="chapter" data-level="8.0.3" data-path="d-charts.html"><a href="d-charts.html#d-surfaces"><i class="fa fa-check"></i><b>8.0.3</b> 3D surfaces</a></li>
</ul></li>
<li class="part"><span><b>II Publishing views</b></span></li>
<li class="chapter" data-level="9" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>9</b> Introduction</a></li>
<li class="chapter" data-level="10" data-path="saving-and-embedding-html.html"><a href="saving-and-embedding-html.html"><i class="fa fa-check"></i><b>10</b> Saving and embedding HTML</a></li>
<li class="chapter" data-level="11" data-path="exporting-static-images.html"><a href="exporting-static-images.html"><i class="fa fa-check"></i><b>11</b> Exporting static images</a><ul>
<li class="chapter" data-level="11.1" data-path="exporting-static-images.html"><a href="exporting-static-images.html#with-code"><i class="fa fa-check"></i><b>11.1</b> With code</a></li>
<li class="chapter" data-level="11.2" data-path="exporting-static-images.html"><a href="exporting-static-images.html#from-a-browser"><i class="fa fa-check"></i><b>11.2</b> From a browser</a></li>
<li class="chapter" data-level="11.3" data-path="exporting-static-images.html"><a href="exporting-static-images.html#sizing-exports"><i class="fa fa-check"></i><b>11.3</b> Sizing exports</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="editing-views.html"><a href="editing-views.html"><i class="fa fa-check"></i><b>12</b> Editing views for publishing</a></li>
<li class="part"><span><b>III Combining multiple views</b></span></li>
<li class="chapter" data-level="13" data-path="arranging-views.html"><a href="arranging-views.html"><i class="fa fa-check"></i><b>13</b> Arranging views</a><ul>
<li class="chapter" data-level="13.1" data-path="arranging-views.html"><a href="arranging-views.html#arranging-plotly-objects"><i class="fa fa-check"></i><b>13.1</b> Arranging plotly objects</a><ul>
<li class="chapter" data-level="13.1.1" data-path="arranging-views.html"><a href="arranging-views.html#recursive-subplots"><i class="fa fa-check"></i><b>13.1.1</b> Recursive subplots</a></li>
<li class="chapter" data-level="13.1.2" data-path="arranging-views.html"><a href="arranging-views.html#other-approaches-applications"><i class="fa fa-check"></i><b>13.1.2</b> Other approaches &amp; applications</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="arranging-views.html"><a href="arranging-views.html#arranging-htmlwidgets"><i class="fa fa-check"></i><b>13.2</b> Arranging htmlwidgets</a><ul>
<li class="chapter" data-level="13.2.1" data-path="arranging-views.html"><a href="arranging-views.html#flexdashboard"><i class="fa fa-check"></i><b>13.2.1</b> Flexdashboard</a></li>
<li class="chapter" data-level="13.2.2" data-path="arranging-views.html"><a href="arranging-views.html#bootstrap-grid-layout"><i class="fa fa-check"></i><b>13.2.2</b> Bootstrap grid layout</a></li>
<li class="chapter" data-level="13.2.3" data-path="arranging-views.html"><a href="arranging-views.html#css-flexbox"><i class="fa fa-check"></i><b>13.2.3</b> CSS flexbox</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="arranging-views.html"><a href="arranging-views.html#navigating-many-views"><i class="fa fa-check"></i><b>13.3</b> Navigating many views</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="animating-views.html"><a href="animating-views.html"><i class="fa fa-check"></i><b>14</b> Animating views</a><ul>
<li class="chapter" data-level="14.1" data-path="animating-views.html"><a href="animating-views.html#animation-api"><i class="fa fa-check"></i><b>14.1</b> Animation API</a></li>
<li class="chapter" data-level="14.2" data-path="animating-views.html"><a href="animating-views.html#animation-support"><i class="fa fa-check"></i><b>14.2</b> Animation support</a></li>
</ul></li>
<li class="part"><span><b>IV Linking multiple views</b></span></li>
<li class="chapter" data-level="15" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>15</b> Introduction</a></li>
<li class="chapter" data-level="16" data-path="client-side-linking.html"><a href="client-side-linking.html"><i class="fa fa-check"></i><b>16</b> Client-side linking</a><ul>
<li class="chapter" data-level="16.1" data-path="client-side-linking.html"><a href="client-side-linking.html#graphical-queries"><i class="fa fa-check"></i><b>16.1</b> Graphical queries</a></li>
<li class="chapter" data-level="16.2" data-path="client-side-linking.html"><a href="client-side-linking.html#filter"><i class="fa fa-check"></i><b>16.2</b> Highlight versus filter events</a></li>
<li class="chapter" data-level="16.3" data-path="client-side-linking.html"><a href="client-side-linking.html#linking-animated-views"><i class="fa fa-check"></i><b>16.3</b> Linking animated views</a></li>
<li class="chapter" data-level="16.4" data-path="client-side-linking.html"><a href="client-side-linking.html#querying-examples"><i class="fa fa-check"></i><b>16.4</b> Examples</a><ul>
<li class="chapter" data-level="16.4.1" data-path="client-side-linking.html"><a href="client-side-linking.html#trellis-linking"><i class="fa fa-check"></i><b>16.4.1</b> Querying facetted charts</a></li>
<li class="chapter" data-level="16.4.2" data-path="client-side-linking.html"><a href="client-side-linking.html#statistical-queries"><i class="fa fa-check"></i><b>16.4.2</b> Statistical queries</a></li>
<li class="chapter" data-level="16.4.3" data-path="client-side-linking.html"><a href="client-side-linking.html#statistical-queries-ggplot"><i class="fa fa-check"></i><b>16.4.3</b> Statistical queries with <code>ggplotly()</code></a></li>
<li class="chapter" data-level="16.4.4" data-path="client-side-linking.html"><a href="client-side-linking.html#geo-spatial-queries"><i class="fa fa-check"></i><b>16.4.4</b> Geo-spatial queries</a></li>
<li class="chapter" data-level="16.4.5" data-path="client-side-linking.html"><a href="client-side-linking.html#linking-with-other-htmlwidgets"><i class="fa fa-check"></i><b>16.4.5</b> Linking with other htmlwidgets</a></li>
<li class="chapter" data-level="16.4.6" data-path="client-side-linking.html"><a href="client-side-linking.html#ggally-ggpairs"><i class="fa fa-check"></i><b>16.4.6</b> Generalized pairs plots</a></li>
<li class="chapter" data-level="16.4.7" data-path="client-side-linking.html"><a href="client-side-linking.html#ggally-ggnostic"><i class="fa fa-check"></i><b>16.4.7</b> Querying diagnostic plots</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="client-side-linking.html"><a href="client-side-linking.html#limitations"><i class="fa fa-check"></i><b>16.5</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linking-server-side.html"><a href="linking-server-side.html"><i class="fa fa-check"></i><b>17</b> Server-side linking with shiny</a><ul>
<li class="chapter" data-level="17.1" data-path="linking-server-side.html"><a href="linking-server-side.html#hello-shiny"><i class="fa fa-check"></i><b>17.1</b> Embedding plotly in shiny</a><ul>
<li class="chapter" data-level="17.1.1" data-path="linking-server-side.html"><a href="linking-server-side.html#your-first-shiny-app"><i class="fa fa-check"></i><b>17.1.1</b> Your first shiny app</a></li>
<li class="chapter" data-level="17.1.2" data-path="linking-server-side.html"><a href="linking-server-side.html#hiding-and-redrawing-on-resize"><i class="fa fa-check"></i><b>17.1.2</b> Hiding and redrawing on resize</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="linking-server-side.html"><a href="linking-server-side.html#shiny-plotly-inputs"><i class="fa fa-check"></i><b>17.2</b> Leveraging plotly input events</a><ul>
<li class="chapter" data-level="17.2.1" data-path="linking-server-side.html"><a href="linking-server-side.html#dragging-events"><i class="fa fa-check"></i><b>17.2.1</b> Dragging events</a></li>
<li class="chapter" data-level="17.2.2" data-path="linking-server-side.html"><a href="linking-server-side.html#d-events"><i class="fa fa-check"></i><b>17.2.2</b> 3D events</a></li>
<li class="chapter" data-level="17.2.3" data-path="linking-server-side.html"><a href="linking-server-side.html#edit-events"><i class="fa fa-check"></i><b>17.2.3</b> Edit events</a></li>
<li class="chapter" data-level="17.2.4" data-path="linking-server-side.html"><a href="linking-server-side.html#relayout-vs-restyle-events"><i class="fa fa-check"></i><b>17.2.4</b> Relayout vs restyle events</a></li>
<li class="chapter" data-level="17.2.5" data-path="linking-server-side.html"><a href="linking-server-side.html#scoping-events"><i class="fa fa-check"></i><b>17.2.5</b> Scoping events</a></li>
<li class="chapter" data-level="17.2.6" data-path="linking-server-side.html"><a href="linking-server-side.html#event-priority"><i class="fa fa-check"></i><b>17.2.6</b> Event priority</a></li>
<li class="chapter" data-level="17.2.7" data-path="linking-server-side.html"><a href="linking-server-side.html#handling-discrete-axes"><i class="fa fa-check"></i><b>17.2.7</b> Handling discrete axes</a></li>
<li class="chapter" data-level="17.2.8" data-path="linking-server-side.html"><a href="linking-server-side.html#reactive-vals"><i class="fa fa-check"></i><b>17.2.8</b> Accumulating and managing event data</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="linking-server-side.html"><a href="linking-server-side.html#shiny-performance"><i class="fa fa-check"></i><b>17.3</b> Improving performance</a><ul>
<li class="chapter" data-level="17.3.1" data-path="linking-server-side.html"><a href="linking-server-side.html#proxies"><i class="fa fa-check"></i><b>17.3.1</b> Partial plotly updates</a></li>
<li class="chapter" data-level="17.3.2" data-path="linking-server-side.html"><a href="linking-server-side.html#partial-update-examples"><i class="fa fa-check"></i><b>17.3.2</b> Partial update examples</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="linking-server-side.html"><a href="linking-server-side.html#advanced-applications"><i class="fa fa-check"></i><b>17.4</b> Advanced applications</a><ul>
<li class="chapter" data-level="17.4.1" data-path="linking-server-side.html"><a href="linking-server-side.html#drill-down"><i class="fa fa-check"></i><b>17.4.1</b> Drill-down</a></li>
<li class="chapter" data-level="17.4.2" data-path="linking-server-side.html"><a href="linking-server-side.html#crossfilter"><i class="fa fa-check"></i><b>17.4.2</b> Cross-filter</a></li>
<li class="chapter" data-level="17.4.3" data-path="linking-server-side.html"><a href="linking-server-side.html#drag-brush"><i class="fa fa-check"></i><b>17.4.3</b> A draggable brush</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linking-server-side.html"><a href="linking-server-side.html#discussion"><i class="fa fa-check"></i><b>17.5</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>V Custom behavior with JavaScript</b></span></li>
<li class="chapter" data-level="18" data-path="javascript.html"><a href="javascript.html"><i class="fa fa-check"></i><b>18</b> Introduction</a></li>
<li class="chapter" data-level="19" data-path="json.html"><a href="json.html"><i class="fa fa-check"></i><b>19</b> Working with JSON</a><ul>
<li class="chapter" data-level="19.1" data-path="json.html"><a href="json.html#assignment-subsetting-and-iteration"><i class="fa fa-check"></i><b>19.1</b> Assignment, subsetting, and iteration</a></li>
<li class="chapter" data-level="19.2" data-path="json.html"><a href="json.html#mapping-r-to-json"><i class="fa fa-check"></i><b>19.2</b> Mapping R to JSON</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="js-event-handlers.html"><a href="js-event-handlers.html"><i class="fa fa-check"></i><b>20</b> Adding custom event handlers</a></li>
<li class="chapter" data-level="21" data-path="supplying-custom-data.html"><a href="supplying-custom-data.html"><i class="fa fa-check"></i><b>21</b> Supplying custom data</a></li>
<li class="chapter" data-level="22" data-path="client-side.html"><a href="client-side.html"><i class="fa fa-check"></i><b>22</b> Leveraging web technologies from R</a></li>
<li class="part"><span><b>VI Various special topics</b></span></li>
<li class="chapter" data-level="23" data-path="is-plotly-free-secure.html"><a href="is-plotly-free-secure.html"><i class="fa fa-check"></i><b>23</b> Is plotly free &amp; secure?</a></li>
<li class="chapter" data-level="24" data-path="controlling-tooltips.html"><a href="controlling-tooltips.html"><i class="fa fa-check"></i><b>24</b> Controlling tooltips</a><ul>
<li class="chapter" data-level="24.1" data-path="controlling-tooltips.html"><a href="controlling-tooltips.html#tooltip-text"><i class="fa fa-check"></i><b>24.1</b> <code>plot_ly()</code> tooltips</a></li>
<li class="chapter" data-level="24.2" data-path="controlling-tooltips.html"><a href="controlling-tooltips.html#tooltip-text-ggplotly"><i class="fa fa-check"></i><b>24.2</b> <code>ggplotly()</code> tooltips</a></li>
<li class="chapter" data-level="24.3" data-path="controlling-tooltips.html"><a href="controlling-tooltips.html#styling"><i class="fa fa-check"></i><b>24.3</b> Styling</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="control-modebar.html"><a href="control-modebar.html"><i class="fa fa-check"></i><b>25</b> Control the modebar</a><ul>
<li class="chapter" data-level="25.1" data-path="control-modebar.html"><a href="control-modebar.html#remove-the-entire-modebar"><i class="fa fa-check"></i><b>25.1</b> Remove the entire modebar</a></li>
<li class="chapter" data-level="25.2" data-path="control-modebar.html"><a href="control-modebar.html#remove-the-plotly-logo"><i class="fa fa-check"></i><b>25.2</b> Remove the plotly logo</a></li>
<li class="chapter" data-level="25.3" data-path="control-modebar.html"><a href="control-modebar.html#remove-modebar-buttons-by-name"><i class="fa fa-check"></i><b>25.3</b> Remove modebar buttons by name</a></li>
<li class="chapter" data-level="25.4" data-path="control-modebar.html"><a href="control-modebar.html#add-custom-modebar-buttons"><i class="fa fa-check"></i><b>25.4</b> Add custom modebar buttons</a></li>
<li class="chapter" data-level="25.5" data-path="control-modebar.html"><a href="control-modebar.html#control-image-downloads"><i class="fa fa-check"></i><b>25.5</b> Control image downloads</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="working-with-colors.html"><a href="working-with-colors.html"><i class="fa fa-check"></i><b>26</b> Working with colors</a></li>
<li class="chapter" data-level="27" data-path="working-with-symbols.html"><a href="working-with-symbols.html"><i class="fa fa-check"></i><b>27</b> Working with symbols and glyphs</a></li>
<li class="chapter" data-level="28" data-path="locales.html"><a href="locales.html"><i class="fa fa-check"></i><b>28</b> Language support</a></li>
<li class="chapter" data-level="29" data-path="mathjax.html"><a href="mathjax.html"><i class="fa fa-check"></i><b>29</b> LaTeX rendering</a><ul>
<li class="chapter" data-level="29.1" data-path="mathjax.html"><a href="mathjax.html#mathjax-caveats"><i class="fa fa-check"></i><b>29.1</b> MathJax caveats</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="the-data-plot-pipeline.html"><a href="the-data-plot-pipeline.html"><i class="fa fa-check"></i><b>30</b> The data-plot-pipeline</a></li>
<li class="chapter" data-level="31" data-path="modifying-ggplotly.html"><a href="modifying-ggplotly.html"><i class="fa fa-check"></i><b>31</b> Improving <code>ggplotly()</code></a><ul>
<li class="chapter" data-level="31.1" data-path="modifying-ggplotly.html"><a href="modifying-ggplotly.html#modifying-layout"><i class="fa fa-check"></i><b>31.1</b> Modifying layout</a></li>
<li class="chapter" data-level="31.2" data-path="modifying-ggplotly.html"><a href="modifying-ggplotly.html#modifying-data"><i class="fa fa-check"></i><b>31.2</b> Modifying data</a></li>
<li class="chapter" data-level="31.3" data-path="modifying-ggplotly.html"><a href="modifying-ggplotly.html#leveraging-statistical-output"><i class="fa fa-check"></i><b>31.3</b> Leveraging statistical output</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="embedding-images.html"><a href="embedding-images.html"><i class="fa fa-check"></i><b>32</b> Embedding images</a></li>
<li class="part"><span><b>VII Developer-facing topics</b></span></li>
<li class="chapter" data-level="33" data-path="custom-geoms.html"><a href="custom-geoms.html"><i class="fa fa-check"></i><b>33</b> Translating custom ggplot2 geoms</a></li>
<li class="chapter" data-level="34" data-path="designing-an-htmlwidget-interface.html"><a href="designing-an-htmlwidget-interface.html"><i class="fa fa-check"></i><b>34</b> Designing an htmlwidget interface</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive web-based data visualization with R, plotly, and shiny</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modifying-ggplotly" class="section level1">
<h1><span class="header-section-number">31</span> Improving <code>ggplotly()</code></h1>
<p>Since the <code>ggplotly()</code> function returns a <strong>plotly</strong> object, we can use that object in the same way you can use any other <strong>plotly</strong> object. Modifying this object is <em>always</em> going to be useful when you want more control over certain (interactive) behavior that <strong>ggplot2</strong> doesn’t provide an API to describe<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a>, for example:</p>
<ul>
<li><code>layout()</code> for modifying aspects of the layout, which can be used to:
<ul>
<li>Change default <a href="https://plot.ly/r/reference/#layout-hovermode"><code>hovermode</code></a> behavior (See Figure <a href="modifying-ggplotly.html#fig:ggplotly-rangeslider">31.1</a>).</li>
<li>Stylizing hover labels (<a href="https://plot.ly/r/reference/#layout-hoverlabel"><code>hoverlabel</code></a>).</li>
<li>Changing click+drag mode (<a href="https://plot.ly/r/reference/#layout-dragmode"><code>dragmode</code></a>) and/or constraining rectangular selections (<code>dragmode='select'</code>) vertically or horizontally (<a href="https://plot.ly/r/reference/#layout-selectdirection"><code>selectdirection</code></a>).</li>
<li>Add dropdowns <a href="https://plot.ly/r/dropdowns/" class="uri">https://plot.ly/r/dropdowns/</a>, sliders <a href="https://plot.ly/r/sliders/" class="uri">https://plot.ly/r/sliders/</a>, and rangesliders (see Figure <a href="modifying-ggplotly.html#fig:ggplotly-rangeslider">31.1</a>).</li>
</ul></li>
<li><code>style()</code> for modifying data-level attributes, which can be used to:
<ul>
<li>Control the tooltip content and styling (see Chapter <a href="controlling-tooltips.html#tooltip-text-ggplotly">24.2</a>).</li>
<li>Turn hovering on/off (see Figure <a href="modifying-ggplotly.html#fig:style-hoverinfo">31.4</a>).</li>
<li>Add marker points to lines (e.g., <code>style(p, mode = "markers+lines")</code>).</li>
</ul></li>
<li><code>config()</code> for modifying the plot configuration, which can be used to:
<ul>
<li>Control the modebar (see Chapter <a href="control-modebar.html#control-modebar">25</a>).</li>
<li>Change the default language (see Chapter <a href="locales.html#locales">28</a>).</li>
<li>Enable LaTeX rendering (see Chapter <a href="mathjax.html#mathjax">29</a>).</li>
<li>Enable editable shapes (see Chapter <a href="editing-views.html#editing-views">12</a>).</li>
</ul></li>
</ul>
<p>In addition to using the functions above to modify <code>ggplotly()</code>’s return value, the <code>ggplotly()</code> function itself provides some arguments for controling that return value. In this chapter, we’ll see a couple of them:</p>
<ul>
<li><code>dynamicTicks</code>: should plotly.js dynamically generate axis tick labels? Dynamic ticks are useful for updating ticks in response to zoom/pan interactions; however, they can not always reproduce labels as they would appear in the static ggplot2 image (see Figure <a href="modifying-ggplotly.html#fig:ggplotly-rangeslider">31.1</a>).</li>
<li><code>layerData</code>: return a reference to which <strong>ggplot2</strong> layer’s data (see Figure <a href="modifying-ggplotly.html#fig:se-annotations">31.5</a>)?</li>
</ul>
<div id="modifying-layout" class="section level2">
<h2><span class="header-section-number">31.1</span> Modifying layout</h2>
<p>Any aspect of a <strong>plotly</strong> objects layout can be modified^[Or, in the case of cumulative attributes, like <code>shapes</code>, <code>images</code>, <code>annotations</code>, etc, these items will be added to the existing items) via the <code>layout()</code> function. By default, since it doesn’t always make sense to compare values, <code>ggplotly()</code> will usually set <code>layout.hovermode='closest'</code>. As shown in Figure <a href="modifying-ggplotly.html#fig:ggplotly-rangeslider">31.1</a>, when we have multiple y-values of interest at a specific x-value, it can be helpful to set <code>layout.hovermode='x'</code>. Moreover, for a long time series graph like this, zooming in on the x-axis can be useful – <code>dynamicTicks</code> allows plotly.js to handle the generation of axis ticks and the <code>rangeslider()</code> allows us to zoom on the x-axis without losing the global context.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(babynames)
nms &lt;-<span class="st"> </span><span class="kw">filter</span>(babynames, name <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sam&quot;</span>, <span class="st">&quot;Alex&quot;</span>))
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nms) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(year, prop, <span class="dt">color =</span> sex, <span class="dt">linetype =</span> name))
  
<span class="kw">ggplotly</span>(p, <span class="dt">dynamicTicks =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">rangeslider</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">layout</span>(<span class="dt">hovermode =</span> <span class="st">&quot;x&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:ggplotly-rangeslider"></span>
<iframe src="https://player.vimeo.com/video/325298724?title=0&amp;byline=0&amp;portrait=0" width="100%" height="400" frameborder="0" seamless="seamless" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<p class="caption">
FIGURE 31.1: Adding <code>dynamicTicks</code>, a <code>rangeslider()</code>, and a comparison hovermode to improve the interactive experience of a <code>ggplotly()</code> graph.
</p>
</div>
<p>Since a single <strong>plotly</strong> object can only have one layout, modifying the layout of <code>ggplotly()</code> is fairly easy, but it’s trickier to modify the data underlying the graph.</p>
</div>
<div id="modifying-data" class="section level2">
<h2><span class="header-section-number">31.2</span> Modifying data</h2>
<p>As mentioned previously, <code>ggplotly()</code> translates each ggplot2 layer into one or more plotly.js traces. In this translation, it is forced to make a number of assumptions about trace attribute values that may or may not be appropriate for the use case. To demonstrate, consider Figure <a href="modifying-ggplotly.html#fig:simple-scatterplot">31.2</a>, which shows hover information for the points, the fitted line, and the confidence band. How could we make it so hover information is only displayed for the points?</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span>
<span class="st">   </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>()
<span class="kw">ggplotly</span>(p)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:simple-scatterplot"></span>
<div id="htmlwidget-4b013ee6f762fd30f9ae" style="width:100%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4b013ee6f762fd30f9ae">{"x":{"data":[{"x":[2.62,2.875,2.32,3.215,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.424,5.345,2.2,1.615,1.835,2.465,3.52,3.435,3.84,3.845,1.935,2.14,1.513,3.17,2.77,3.57,2.78],"y":[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],"text":["wt: 2.62<br />mpg: 21.0","wt: 2.88<br />mpg: 21.0","wt: 2.32<br />mpg: 22.8","wt: 3.21<br />mpg: 21.4","wt: 3.44<br />mpg: 18.7","wt: 3.46<br />mpg: 18.1","wt: 3.57<br />mpg: 14.3","wt: 3.19<br />mpg: 24.4","wt: 3.15<br />mpg: 22.8","wt: 3.44<br />mpg: 19.2","wt: 3.44<br />mpg: 17.8","wt: 4.07<br />mpg: 16.4","wt: 3.73<br />mpg: 17.3","wt: 3.78<br />mpg: 15.2","wt: 5.25<br />mpg: 10.4","wt: 5.42<br />mpg: 10.4","wt: 5.34<br />mpg: 14.7","wt: 2.20<br />mpg: 32.4","wt: 1.61<br />mpg: 30.4","wt: 1.83<br />mpg: 33.9","wt: 2.46<br />mpg: 21.5","wt: 3.52<br />mpg: 15.5","wt: 3.44<br />mpg: 15.2","wt: 3.84<br />mpg: 13.3","wt: 3.85<br />mpg: 19.2","wt: 1.94<br />mpg: 27.3","wt: 2.14<br />mpg: 26.0","wt: 1.51<br />mpg: 30.4","wt: 3.17<br />mpg: 15.8","wt: 2.77<br />mpg: 19.7","wt: 3.57<br />mpg: 15.0","wt: 2.78<br />mpg: 21.4"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.513,1.56250632911392,1.61201265822785,1.66151898734177,1.7110253164557,1.76053164556962,1.81003797468354,1.85954430379747,1.90905063291139,1.95855696202532,2.00806329113924,2.05756962025316,2.10707594936709,2.15658227848101,2.20608860759494,2.25559493670886,2.30510126582278,2.35460759493671,2.40411392405063,2.45362025316456,2.50312658227848,2.55263291139241,2.60213924050633,2.65164556962025,2.70115189873418,2.7506582278481,2.80016455696203,2.84967088607595,2.89917721518987,2.9486835443038,2.99818987341772,3.04769620253165,3.09720253164557,3.14670886075949,3.19621518987342,3.24572151898734,3.29522784810127,3.34473417721519,3.39424050632911,3.44374683544304,3.49325316455696,3.54275949367089,3.59226582278481,3.64177215189873,3.69127848101266,3.74078481012658,3.79029113924051,3.83979746835443,3.88930379746835,3.93881012658228,3.9883164556962,4.03782278481013,4.08732911392405,4.13683544303798,4.1863417721519,4.23584810126582,4.28535443037975,4.33486075949367,4.3843670886076,4.43387341772152,4.48337974683544,4.53288607594937,4.58239240506329,4.63189873417722,4.68140506329114,4.73091139240506,4.78041772151899,4.82992405063291,4.87943037974684,4.92893670886076,4.97844303797468,5.02794936708861,5.07745569620253,5.12696202531646,5.17646835443038,5.2259746835443,5.27548101265823,5.32498734177215,5.37449367088608,5.424],"y":[32.08897233857,31.6878645869701,31.2816303797919,30.8703709543688,30.4541875480347,30.0331813981232,29.6074537419678,29.1771058169022,28.7422388602601,28.3001719301537,27.834621969428,27.3476575600419,26.84497968394,26.3322893230667,25.8152874593666,25.2996750747841,24.7911531512637,24.29542267075,23.8181846151875,23.3651399665205,22.955253039598,22.6138488714952,22.3275852300224,22.0817586181852,21.8616655389892,21.65260249544,21.4398659905432,21.2087525273044,20.953335722037,20.7158424594628,20.4957065225374,20.2829337645837,20.0675300389245,19.8395011988825,19.5888530977805,19.2971559094315,18.9444093670088,18.5670026794964,18.2056968860288,17.9009022641924,17.620602502374,17.3400153015964,17.079077805285,16.8175887231322,16.5575726926136,16.3083303048321,16.0791621508901,15.8793688218903,15.7018119854881,15.5259429561214,15.3517253848296,15.1793328075288,15.0089387601353,14.8407167785652,14.6748403987346,14.5114831565596,14.3508185879563,14.193020228841,14.0382616151298,13.8867162827388,13.7385577675841,13.5939596055819,13.4530953326483,13.3161384846995,13.1832625976516,13.0546412074207,12.930447849923,12.8108560610747,12.6960393767918,12.5861713329905,12.4814254655869,12.3819753104973,12.2879944036376,12.1996562809241,12.117134478273,12.0406025316002,11.9702339768221,11.9062023498547,11.8486811866141,11.7978440230166],"text":["wt: 1.51<br />mpg: 32.1","wt: 1.56<br />mpg: 31.7","wt: 1.61<br />mpg: 31.3","wt: 1.66<br />mpg: 30.9","wt: 1.71<br />mpg: 30.5","wt: 1.76<br />mpg: 30.0","wt: 1.81<br />mpg: 29.6","wt: 1.86<br />mpg: 29.2","wt: 1.91<br />mpg: 28.7","wt: 1.96<br />mpg: 28.3","wt: 2.01<br />mpg: 27.8","wt: 2.06<br />mpg: 27.3","wt: 2.11<br />mpg: 26.8","wt: 2.16<br />mpg: 26.3","wt: 2.21<br />mpg: 25.8","wt: 2.26<br />mpg: 25.3","wt: 2.31<br />mpg: 24.8","wt: 2.35<br />mpg: 24.3","wt: 2.40<br />mpg: 23.8","wt: 2.45<br />mpg: 23.4","wt: 2.50<br />mpg: 23.0","wt: 2.55<br />mpg: 22.6","wt: 2.60<br />mpg: 22.3","wt: 2.65<br />mpg: 22.1","wt: 2.70<br />mpg: 21.9","wt: 2.75<br />mpg: 21.7","wt: 2.80<br />mpg: 21.4","wt: 2.85<br />mpg: 21.2","wt: 2.90<br />mpg: 21.0","wt: 2.95<br />mpg: 20.7","wt: 3.00<br />mpg: 20.5","wt: 3.05<br />mpg: 20.3","wt: 3.10<br />mpg: 20.1","wt: 3.15<br />mpg: 19.8","wt: 3.20<br />mpg: 19.6","wt: 3.25<br />mpg: 19.3","wt: 3.30<br />mpg: 18.9","wt: 3.34<br />mpg: 18.6","wt: 3.39<br />mpg: 18.2","wt: 3.44<br />mpg: 17.9","wt: 3.49<br />mpg: 17.6","wt: 3.54<br />mpg: 17.3","wt: 3.59<br />mpg: 17.1","wt: 3.64<br />mpg: 16.8","wt: 3.69<br />mpg: 16.6","wt: 3.74<br />mpg: 16.3","wt: 3.79<br />mpg: 16.1","wt: 3.84<br />mpg: 15.9","wt: 3.89<br />mpg: 15.7","wt: 3.94<br />mpg: 15.5","wt: 3.99<br />mpg: 15.4","wt: 4.04<br />mpg: 15.2","wt: 4.09<br />mpg: 15.0","wt: 4.14<br />mpg: 14.8","wt: 4.19<br />mpg: 14.7","wt: 4.24<br />mpg: 14.5","wt: 4.29<br />mpg: 14.4","wt: 4.33<br />mpg: 14.2","wt: 4.38<br />mpg: 14.0","wt: 4.43<br />mpg: 13.9","wt: 4.48<br />mpg: 13.7","wt: 4.53<br />mpg: 13.6","wt: 4.58<br />mpg: 13.5","wt: 4.63<br />mpg: 13.3","wt: 4.68<br />mpg: 13.2","wt: 4.73<br />mpg: 13.1","wt: 4.78<br />mpg: 12.9","wt: 4.83<br />mpg: 12.8","wt: 4.88<br />mpg: 12.7","wt: 4.93<br />mpg: 12.6","wt: 4.98<br />mpg: 12.5","wt: 5.03<br />mpg: 12.4","wt: 5.08<br />mpg: 12.3","wt: 5.13<br />mpg: 12.2","wt: 5.18<br />mpg: 12.1","wt: 5.23<br />mpg: 12.0","wt: 5.28<br />mpg: 12.0","wt: 5.32<br />mpg: 11.9","wt: 5.37<br />mpg: 11.8","wt: 5.42<br />mpg: 11.8"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.77952755905512,"color":"rgba(51,102,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.513,1.56250632911392,1.61201265822785,1.66151898734177,1.7110253164557,1.76053164556962,1.81003797468354,1.85954430379747,1.90905063291139,1.95855696202532,2.00806329113924,2.05756962025316,2.10707594936709,2.15658227848101,2.20608860759494,2.25559493670886,2.30510126582278,2.35460759493671,2.40411392405063,2.45362025316456,2.50312658227848,2.55263291139241,2.60213924050633,2.65164556962025,2.70115189873418,2.7506582278481,2.80016455696203,2.84967088607595,2.89917721518987,2.9486835443038,2.99818987341772,3.04769620253165,3.09720253164557,3.14670886075949,3.19621518987342,3.24572151898734,3.29522784810127,3.34473417721519,3.39424050632911,3.44374683544304,3.49325316455696,3.54275949367089,3.59226582278481,3.64177215189873,3.69127848101266,3.74078481012658,3.79029113924051,3.83979746835443,3.88930379746835,3.93881012658228,3.9883164556962,4.03782278481013,4.08732911392405,4.13683544303798,4.1863417721519,4.23584810126582,4.28535443037975,4.33486075949367,4.3843670886076,4.43387341772152,4.48337974683544,4.53288607594937,4.58239240506329,4.63189873417722,4.68140506329114,4.73091139240506,4.78041772151899,4.82992405063291,4.87943037974684,4.92893670886076,4.97844303797468,5.02794936708861,5.07745569620253,5.12696202531646,5.17646835443038,5.2259746835443,5.27548101265823,5.32498734177215,5.37449367088608,5.424,5.424,5.424,5.37449367088608,5.32498734177215,5.27548101265823,5.2259746835443,5.17646835443038,5.12696202531646,5.07745569620253,5.02794936708861,4.97844303797468,4.92893670886076,4.87943037974684,4.82992405063291,4.78041772151899,4.73091139240506,4.68140506329114,4.63189873417722,4.58239240506329,4.53288607594937,4.48337974683544,4.43387341772152,4.3843670886076,4.33486075949367,4.28535443037975,4.23584810126582,4.1863417721519,4.13683544303798,4.08732911392405,4.03782278481013,3.9883164556962,3.93881012658228,3.88930379746835,3.83979746835443,3.79029113924051,3.74078481012658,3.69127848101266,3.64177215189873,3.59226582278481,3.54275949367089,3.49325316455696,3.44374683544304,3.39424050632911,3.34473417721519,3.29522784810127,3.24572151898734,3.19621518987342,3.14670886075949,3.09720253164557,3.04769620253165,2.99818987341772,2.9486835443038,2.89917721518987,2.84967088607595,2.80016455696203,2.7506582278481,2.70115189873418,2.65164556962025,2.60213924050633,2.55263291139241,2.50312658227848,2.45362025316456,2.40411392405063,2.35460759493671,2.30510126582278,2.25559493670886,2.20608860759494,2.15658227848101,2.10707594936709,2.05756962025316,2.00806329113924,1.95855696202532,1.90905063291139,1.85954430379747,1.81003797468354,1.76053164556962,1.7110253164557,1.66151898734177,1.61201265822785,1.56250632911392,1.513,1.513],"y":[28.1482086220996,28.1543901127744,28.1099674436912,28.0124927543079,27.8597327000998,27.65029180851,27.3844510391609,27.0649645489388,26.6973896057635,26.2875171160579,25.8324317349282,25.3425270424539,24.8283183379919,24.2983639184935,23.760112467877,23.2206139894969,22.687036670636,22.1669802400544,21.6686013586079,21.2005795966642,20.7958707916955,20.4925717120642,20.2505759220062,20.029411327989,19.7997196881028,19.5493238069997,19.2825463474608,19.0136396315242,18.7710547647632,18.6211620442909,18.5230794674341,18.4189767758076,18.2669703402974,18.0571226848891,17.8114857990939,17.5530651234175,17.2593882498087,16.9389000862352,16.6206523252766,16.3538304090665,16.1088696663206,15.8521950118163,15.5982657057393,15.310315393258,14.9820175870996,14.6192730587362,14.2305037174933,13.8250338832656,13.4106256557153,12.9994899989408,12.6032526728482,12.2284161008376,11.878558950985,11.5555601503064,11.2602695449179,10.9928832380879,10.7531583791314,10.5405374596263,10.3542190987777,10.1931951633603,10.0562649052018,9.94203169291403,9.84888494120486,9.77496807618837,9.71813244341526,9.67587696866419,9.64527447672617,9.62288862080818,9.60469153661199,9.58600284245437,9.56148555087706,9.52525005390405,9.47112215607742,9.39310561955942,9.28599841671342,9.14602153848871,8.97125544941046,8.76172457616168,8.5191180560953,8.24628312123558,8.24628312123558,15.3494049247976,15.1782443171329,15.0506801235477,14.9692125042337,14.9351835247118,14.9482705398325,15.0062069422889,15.1048666511978,15.2387005670905,15.4013653802968,15.5863398235266,15.7873872169716,15.9988235013412,16.2156212231199,16.4334054461773,16.6483927518879,16.8573088932106,17.0573057240918,17.2458875182498,17.4208506299664,17.5802374021172,17.722304131482,17.8455029980558,17.9484787967813,18.0300830750312,18.0894112525512,18.1258734068239,18.1393185692856,18.1302495142201,18.1001980968109,18.052395913302,17.992998315261,17.9337037605149,17.9278205842869,17.997387550928,18.1331277981277,18.3248620530063,18.5598899048308,18.8278355913766,19.1323353384275,19.4479741193182,19.7907414467811,20.1951052727576,20.6294304842089,21.0412466954455,21.3662203964672,21.621879712876,21.8680897375516,22.1468907533599,22.4683335776407,22.8105228746346,23.1356166793108,23.4038654230847,23.5971856336257,23.7558811838804,23.9236113898757,24.1341059083815,24.4045945380386,24.7351260309263,25.1146352875006,25.5297003363769,25.967767871767,26.4238651014456,26.8952696318915,27.3787361600713,27.8704624508562,28.36621472764,28.8616410298881,29.3527880776299,29.8368122039277,30.3128267442494,30.7870881147566,31.2892470848656,31.8304564447746,32.4160709877363,33.0486423959696,33.7282491544298,34.4532933158925,35.2213390611659,36.0297360550404,28.1482086220996],"text":["wt: 1.51<br />mpg: 32.1","wt: 1.56<br />mpg: 31.7","wt: 1.61<br />mpg: 31.3","wt: 1.66<br />mpg: 30.9","wt: 1.71<br />mpg: 30.5","wt: 1.76<br />mpg: 30.0","wt: 1.81<br />mpg: 29.6","wt: 1.86<br />mpg: 29.2","wt: 1.91<br />mpg: 28.7","wt: 1.96<br />mpg: 28.3","wt: 2.01<br />mpg: 27.8","wt: 2.06<br />mpg: 27.3","wt: 2.11<br />mpg: 26.8","wt: 2.16<br />mpg: 26.3","wt: 2.21<br />mpg: 25.8","wt: 2.26<br />mpg: 25.3","wt: 2.31<br />mpg: 24.8","wt: 2.35<br />mpg: 24.3","wt: 2.40<br />mpg: 23.8","wt: 2.45<br />mpg: 23.4","wt: 2.50<br />mpg: 23.0","wt: 2.55<br />mpg: 22.6","wt: 2.60<br />mpg: 22.3","wt: 2.65<br />mpg: 22.1","wt: 2.70<br />mpg: 21.9","wt: 2.75<br />mpg: 21.7","wt: 2.80<br />mpg: 21.4","wt: 2.85<br />mpg: 21.2","wt: 2.90<br />mpg: 21.0","wt: 2.95<br />mpg: 20.7","wt: 3.00<br />mpg: 20.5","wt: 3.05<br />mpg: 20.3","wt: 3.10<br />mpg: 20.1","wt: 3.15<br />mpg: 19.8","wt: 3.20<br />mpg: 19.6","wt: 3.25<br />mpg: 19.3","wt: 3.30<br />mpg: 18.9","wt: 3.34<br />mpg: 18.6","wt: 3.39<br />mpg: 18.2","wt: 3.44<br />mpg: 17.9","wt: 3.49<br />mpg: 17.6","wt: 3.54<br />mpg: 17.3","wt: 3.59<br />mpg: 17.1","wt: 3.64<br />mpg: 16.8","wt: 3.69<br />mpg: 16.6","wt: 3.74<br />mpg: 16.3","wt: 3.79<br />mpg: 16.1","wt: 3.84<br />mpg: 15.9","wt: 3.89<br />mpg: 15.7","wt: 3.94<br />mpg: 15.5","wt: 3.99<br />mpg: 15.4","wt: 4.04<br />mpg: 15.2","wt: 4.09<br />mpg: 15.0","wt: 4.14<br />mpg: 14.8","wt: 4.19<br />mpg: 14.7","wt: 4.24<br />mpg: 14.5","wt: 4.29<br />mpg: 14.4","wt: 4.33<br />mpg: 14.2","wt: 4.38<br />mpg: 14.0","wt: 4.43<br />mpg: 13.9","wt: 4.48<br />mpg: 13.7","wt: 4.53<br />mpg: 13.6","wt: 4.58<br />mpg: 13.5","wt: 4.63<br />mpg: 13.3","wt: 4.68<br />mpg: 13.2","wt: 4.73<br />mpg: 13.1","wt: 4.78<br />mpg: 12.9","wt: 4.83<br />mpg: 12.8","wt: 4.88<br />mpg: 12.7","wt: 4.93<br />mpg: 12.6","wt: 4.98<br />mpg: 12.5","wt: 5.03<br />mpg: 12.4","wt: 5.08<br />mpg: 12.3","wt: 5.13<br />mpg: 12.2","wt: 5.18<br />mpg: 12.1","wt: 5.23<br />mpg: 12.0","wt: 5.28<br />mpg: 12.0","wt: 5.32<br />mpg: 11.9","wt: 5.37<br />mpg: 11.8","wt: 5.42<br />mpg: 11.8","wt: 5.42<br />mpg: 11.8","wt: 5.42<br />mpg: 11.8","wt: 5.37<br />mpg: 11.8","wt: 5.32<br />mpg: 11.9","wt: 5.28<br />mpg: 12.0","wt: 5.23<br />mpg: 12.0","wt: 5.18<br />mpg: 12.1","wt: 5.13<br />mpg: 12.2","wt: 5.08<br />mpg: 12.3","wt: 5.03<br />mpg: 12.4","wt: 4.98<br />mpg: 12.5","wt: 4.93<br />mpg: 12.6","wt: 4.88<br />mpg: 12.7","wt: 4.83<br />mpg: 12.8","wt: 4.78<br />mpg: 12.9","wt: 4.73<br />mpg: 13.1","wt: 4.68<br />mpg: 13.2","wt: 4.63<br />mpg: 13.3","wt: 4.58<br />mpg: 13.5","wt: 4.53<br />mpg: 13.6","wt: 4.48<br />mpg: 13.7","wt: 4.43<br />mpg: 13.9","wt: 4.38<br />mpg: 14.0","wt: 4.33<br />mpg: 14.2","wt: 4.29<br />mpg: 14.4","wt: 4.24<br />mpg: 14.5","wt: 4.19<br />mpg: 14.7","wt: 4.14<br />mpg: 14.8","wt: 4.09<br />mpg: 15.0","wt: 4.04<br />mpg: 15.2","wt: 3.99<br />mpg: 15.4","wt: 3.94<br />mpg: 15.5","wt: 3.89<br />mpg: 15.7","wt: 3.84<br />mpg: 15.9","wt: 3.79<br />mpg: 16.1","wt: 3.74<br />mpg: 16.3","wt: 3.69<br />mpg: 16.6","wt: 3.64<br />mpg: 16.8","wt: 3.59<br />mpg: 17.1","wt: 3.54<br />mpg: 17.3","wt: 3.49<br />mpg: 17.6","wt: 3.44<br />mpg: 17.9","wt: 3.39<br />mpg: 18.2","wt: 3.34<br />mpg: 18.6","wt: 3.30<br />mpg: 18.9","wt: 3.25<br />mpg: 19.3","wt: 3.20<br />mpg: 19.6","wt: 3.15<br />mpg: 19.8","wt: 3.10<br />mpg: 20.1","wt: 3.05<br />mpg: 20.3","wt: 3.00<br />mpg: 20.5","wt: 2.95<br />mpg: 20.7","wt: 2.90<br />mpg: 21.0","wt: 2.85<br />mpg: 21.2","wt: 2.80<br />mpg: 21.4","wt: 2.75<br />mpg: 21.7","wt: 2.70<br />mpg: 21.9","wt: 2.65<br />mpg: 22.1","wt: 2.60<br />mpg: 22.3","wt: 2.55<br />mpg: 22.6","wt: 2.50<br />mpg: 23.0","wt: 2.45<br />mpg: 23.4","wt: 2.40<br />mpg: 23.8","wt: 2.35<br />mpg: 24.3","wt: 2.31<br />mpg: 24.8","wt: 2.26<br />mpg: 25.3","wt: 2.21<br />mpg: 25.8","wt: 2.16<br />mpg: 26.3","wt: 2.11<br />mpg: 26.8","wt: 2.06<br />mpg: 27.3","wt: 2.01<br />mpg: 27.8","wt: 1.96<br />mpg: 28.3","wt: 1.91<br />mpg: 28.7","wt: 1.86<br />mpg: 29.2","wt: 1.81<br />mpg: 29.6","wt: 1.76<br />mpg: 30.0","wt: 1.71<br />mpg: 30.5","wt: 1.66<br />mpg: 30.9","wt: 1.61<br />mpg: 31.3","wt: 1.56<br />mpg: 31.7","wt: 1.51<br />mpg: 32.1","wt: 1.51<br />mpg: 32.1"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.4)","hoveron":"points","hoverinfo":"x+y","showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.31745,5.61955],"tickmode":"array","ticktext":["2","3","4","5"],"tickvals":[2,3,4,5],"categoryorder":"array","categoryarray":["2","3","4","5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"wt","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[6.85711047454534,37.4189087017306],"tickmode":"array","ticktext":["10","20","30"],"tickvals":[10,20,30],"categoryorder":"array","categoryarray":["10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"mpg","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"ca3c7637cbad":{"x":{},"y":{},"type":"scatter"},"ca3c491d077d":{"x":{},"y":{}}},"cur_data":"ca3c7637cbad","visdat":{"ca3c7637cbad":["function (y) ","x"],"ca3c491d077d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
<p class="caption">
FIGURE 31.2: A scatterplot with a fitted line and confidence band.
</p>
</div>
<p>The <strong>ggplot2</strong> package doesn’t provide an API for interactive features, but by changing the <a href="https://plot.ly/r/reference/#scatter-hoverinfo">hoverinfo</a> attribute to <code>"none"</code>, we can turn off hover for the relevant traces. This sort of task (i.e. modifying trace attribute values) is best achieved through the <code>style()</code> function. Before using it, you may want to study the underlying traces with <code>plotly_json()</code> which uses the <strong>listviewer</strong> package to display a convenient interactive view of the JSON object sent to plotly.js <span class="citation">(de Jong and Russell <a href="#ref-listviewer" role="doc-biblioref">2016</a>)</span>. By clicking on the arrow next to the data element, you can see the traces (data) behind the plot. As shown in Figure <a href="modifying-ggplotly.html#fig:listviewer">31.3</a>, we have three traces: one for the <code>geom_point()</code> layer and two for the <code>geom_smooth()</code> layer.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotly_json</span>(p)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:listviewer"></span>
<img src="images/listviewer.png" alt="Using listviewer to inspect the JSON representation of a plotly object." width="100%" />
<p class="caption">
FIGURE 31.3: Using listviewer to inspect the JSON representation of a plotly object.
</p>
</div>
<p>This output indicates that the fitted line and confidence band are implemented in the 2nd and 3rd trace of the plotly object, so to turn off the hover of those traces:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">style</span>(p, <span class="dt">hoverinfo =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">traces =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:style-hoverinfo"></span>
<img src="images/style-hoverinfo.png" alt="Using the `style()` function to modify hoverinfo attribute values of a plotly object created via `ggplotly()` (by default, `ggplotly()` displays hoverinfo for all traces). In this case, the hoverinfo for a fitted line and error bounds are hidden." width="100%" />
<p class="caption">
FIGURE 31.4: Using the <code>style()</code> function to modify hoverinfo attribute values of a plotly object created via <code>ggplotly()</code> (by default, <code>ggplotly()</code> displays hoverinfo for all traces). In this case, the hoverinfo for a fitted line and error bounds are hidden.
</p>
</div>
</div>
<div id="leveraging-statistical-output" class="section level2">
<h2><span class="header-section-number">31.3</span> Leveraging statistical output</h2>
<p>Since <code>ggplotly()</code> returns a plotly object, and <strong>plotly</strong> objects can have data attached to them, it attaches data from <strong>ggplot2</strong> layer(s) (either before or after summary statistics have been applied). Furthermore, since each ggplot layer owns a data frame, it is useful to have some way to specify the particular layer of data of interest, which is done via the <code>layerData</code> argument in <code>ggplotly()</code>. Also, when a particular layer applies a summary statistic (e.g., <code>geom_bin()</code>), or applies a statistical model (e.g., <code>geom_smooth()</code>) to the data, it might be useful to access the output of that transformation, which is the point of the <code>originalData</code> argument in <code>ggplotly()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span>
<span class="st">   </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>()
p <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplotly</span>(<span class="dt">layerData =</span> <span class="dv">2</span>, <span class="dt">originalData =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">plotly_data</span>()
<span class="co">#&gt; # A tibble: 80 x 13</span>
<span class="co">#&gt;   PANEL     x     y  ymin  ymax    se group colour fill   size linetype</span>
<span class="co">#&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1      1.51  32.1  28.1  36.0  1.92    -1 #3366… grey…     1        1</span>
<span class="co">#&gt; 2 1      1.56  31.7  28.2  35.2  1.72    -1 #3366… grey…     1        1</span>
<span class="co">#&gt; 3 1      1.61  31.3  28.1  34.5  1.54    -1 #3366… grey…     1        1</span>
<span class="co">#&gt; 4 1      1.66  30.9  28.0  33.7  1.39    -1 #3366… grey…     1        1</span>
<span class="co">#&gt; 5 1      1.71  30.5  27.9  33.0  1.26    -1 #3366… grey…     1        1</span>
<span class="co">#&gt; 6 1      1.76  30.0  27.7  32.4  1.16    -1 #3366… grey…     1        1</span>
<span class="co">#&gt; # … with 74 more rows, and 2 more variables: weight &lt;dbl&gt;, alpha &lt;dbl&gt;</span></code></pre>
<p>The data shown above is the data ggplot2 uses to actually draw the fitted values (as a line) and standard error bounds (as a ribbon). Figure <a href="modifying-ggplotly.html#fig:se-annotations">31.5</a> leverages this data to add additional information about the model fit; in particular, it adds a vertical lines and annotations at the x-values that are associated with the highest and lowest amount uncertainty in the fitted values. Producing a plot like this with <strong>ggplot2</strong> would be impossible using <code>geom_smooth()</code> alone.<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a> Providing a simple visual clue like this can help combat visual misperceptions of uncertainty bands due to the sine illusion <span class="citation">(VanderPlas and Hofmann <a href="#ref-sine-illusion" role="doc-biblioref">2015</a>)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">p <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplotly</span>(<span class="dt">layerData =</span> <span class="dv">2</span>, <span class="dt">originalData =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_fun</span>(<span class="cf">function</span>(p) {
    p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="kw">which.max</span>(se)) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">add_segments</span>(<span class="dt">x =</span> <span class="op">~</span>x, <span class="dt">xend =</span> <span class="op">~</span>x, <span class="dt">y =</span> <span class="op">~</span>ymin, <span class="dt">yend =</span> <span class="op">~</span>ymax) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">add_annotations</span>(<span class="st">&quot;Maximum uncertainty&quot;</span>, <span class="dt">ax =</span> <span class="dv">60</span>)
  }) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">add_fun</span>(<span class="cf">function</span>(p) {
    p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="kw">which.min</span>(se)) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">add_segments</span>(<span class="dt">x =</span> <span class="op">~</span>x, <span class="dt">xend =</span> <span class="op">~</span>x, <span class="dt">y =</span> <span class="op">~</span>ymin, <span class="dt">yend =</span> <span class="op">~</span>ymax) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">add_annotations</span>(<span class="st">&quot;Minimum uncertainty&quot;</span>)
  })</code></pre>
<div class="figure" style="text-align: center"><span id="fig:se-annotations"></span>
<img src="images/se-annotations.svg" alt="Leveraging data associated with a `geom_smooth()` layer to display additional information about the model fit." width="100%" />
<p class="caption">
FIGURE 31.5: Leveraging data associated with a <code>geom_smooth()</code> layer to display additional information about the model fit.
</p>
</div>
<p>In addition to leveraging output from <code>StatSmooth</code>, it is sometimes useful to leverage output of other statistics, especially for annotation purposes. Figure <a href="modifying-ggplotly.html#fig:StatBin">31.6</a> leverages the output of <code>StatBin</code> to add annotations to a stacked bar chart. Annotation is primarily helpful for displaying the heights of bars in a stacked bar chart, since decoding the heights of bars is a fairly difficult perceptual task <span class="citation">(Cleveland and McGill <a href="#ref-graphical-perception" role="doc-biblioref">1984</a>)</span>. As result, it is much easier to compare bar heights representing the proportion of diamonds with a given clarity across various diamond cuts.</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(cut, <span class="dt">fill =</span> clarity)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>)

<span class="kw">ggplotly</span>(p, <span class="dt">originalData =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ydiff =</span> ymax <span class="op">-</span><span class="st"> </span>ymin) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_text</span>(
    <span class="dt">x =</span> <span class="op">~</span>x, <span class="dt">y =</span> <span class="op">~</span>(ymin <span class="op">+</span><span class="st"> </span>ymax) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,
    <span class="dt">text =</span> <span class="op">~</span><span class="kw">ifelse</span>(ydiff <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.02</span>, <span class="kw">round</span>(ydiff, <span class="dv">2</span>), <span class="st">&quot;&quot;</span>),
    <span class="dt">showlegend =</span> <span class="ot">FALSE</span>, <span class="dt">hoverinfo =</span> <span class="st">&quot;none&quot;</span>,
    <span class="dt">color =</span> <span class="kw">I</span>(<span class="st">&quot;black&quot;</span>), <span class="dt">size =</span> <span class="kw">I</span>(<span class="dv">9</span>)
  )</code></pre>
<div class="figure" style="text-align: center"><span id="fig:StatBin"></span>
<img src="images/StatBin.svg" alt="Leveraging output from `StatBin` to add annotations to a stacked bar chart (created via `geom_bar()`) which makes it easier to compare bar heights." width="100%" />
<p class="caption">
FIGURE 31.6: Leveraging output from <code>StatBin</code> to add annotations to a stacked bar chart (created via <code>geom_bar()</code>) which makes it easier to compare bar heights.
</p>
</div>
<p>Another useful application is labelling the levels of each piece/polygon output by <code>StatDensity2d</code> as shown in Figure <a href="modifying-ggplotly.html#fig:StatDensity2d">31.7</a>. Note that, in this example, the <code>add_text()</code> layer takes advantage of <code>ggplotly()</code>’s ability to inherit aesthetics from the global mapping. Furthermore, since <code>originalData</code> is <code>FALSE</code>, it attaches the “built” aesthetics (i.e., the <code>x</code>/<code>y</code> positions after <code>StatDensity2d</code> has been applied to the raw data).</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(MASS<span class="op">::</span>geyser, <span class="kw">aes</span>(<span class="dt">x =</span> waiting, <span class="dt">y =</span> duration)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density2d</span>()

<span class="kw">ggplotly</span>(p, <span class="dt">originalData =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(piece) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">slice</span>(<span class="kw">which.min</span>(y)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">add_text</span>(
    <span class="dt">text =</span> <span class="op">~</span>level, <span class="dt">size =</span> <span class="kw">I</span>(<span class="dv">9</span>), <span class="dt">color =</span> <span class="kw">I</span>(<span class="st">&quot;black&quot;</span>), <span class="dt">hoverinfo =</span> <span class="st">&quot;none&quot;</span>
  )</code></pre>
<div class="figure" style="text-align: center"><span id="fig:StatDensity2d"></span>
<img src="images/StatDensity2d.svg" alt="Leveraging output from `StatDensity2d` to add annotations to contour levels." width="100%" />
<p class="caption">
FIGURE 31.7: Leveraging output from <code>StatDensity2d</code> to add annotations to contour levels.
</p>
</div>
<!-- TODO: make this more convincing
## Choosing an interface

1. ggplot2 requires data frame(s) and can be inefficient (especially for time series).
2. ggplot2 does not have a functional interface (making it awkward to combine with modern functional interfaces such as dplyr), and does not satisfy [referential transparency](https://en.wikipedia.org/wiki/Referential_transparency) (making it easier to program with -- for more details, see )
3. `ggplotly()` tries to replicate _exactly_ what you see in the corresponding static ggplot2 graph. To do so, it sends axis tick information to plotly as [tickvals](https://plot.ly/r/reference/#layout-xaxis-tickvals)/[ticktext](https://plot.ly/r/reference/#layout-xaxis-ticktext) properties, and consequently, axis ticks do not update on zoom events.
4. ggplot2's interface wasn't designed for interactive graphics. Directly extending the grammar to support more advanced types of interaction (e.g., linked brushing) is a risky endeavor.
-->
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-listviewer">
<p>de Jong, Jos, and Kenton Russell. 2016. <em>Listviewer: ’Htmlwidget’ for Interactive Views of R Lists</em>. <a href="https://github.com/timelyportfolio/listviewer">https://github.com/timelyportfolio/listviewer</a>.</p>
</div>
<div id="ref-sine-illusion">
<p>VanderPlas, Susan, and Heike Hofmann. 2015. “Signs of the Sine Illusion—Why We Need to Care.” <em>Journal of Computational and Graphical Statistics</em> 24 (4): 1170–90. <a href="https://doi.org/10.1080/10618600.2014.951547">https://doi.org/10.1080/10618600.2014.951547</a>.</p>
</div>
<div id="ref-graphical-perception">
<p>Cleveland, William S, and Robert McGill. 1984. “Graphical Perception: Theory, Experimentation, and Application to the Development of Graphical Methods.” <em>Journal of the American Statistical Association</em> 79 (September): 531–54.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="40">
<li id="fn40"><p>It can also be helpful for correcting translations that <code>ggplotly()</code> doesn’t get quite right.<a href="modifying-ggplotly.html#fnref40" class="footnote-back">↩</a></p></li>
<li id="fn41"><p>It could be recreated by fitting the model via <code>loess()</code>, obtaining the fitted values and standard error with <code>predict()</code>, and feeding those results into <code>geom_line()</code>/<code>geom_ribbon()</code>/<code>geom_text()</code>/<code>geom_segment()</code>, but that process is much more onerous.<a href="modifying-ggplotly.html#fnref41" class="footnote-back">↩</a></p></li>
</ol>
</div>
<script>
  var header = document.querySelector(".book-header");

  var img = document.createElement("img");
  img.src = "images/rstudioCloud.svg";
  img.width = 200;
  img.align = "right";
  img.style = "margin-top:10px; float:right";

  var a = document.createElement("a");
  a.href = "https://rstudio.cloud/project/156701";
  a.target = "_blank";

  a.appendChild(img);
  header.appendChild(a);
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-60116966-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-60116966-3');
</script>
            </section>

          </div>
        </div>
      </div>
<a href="the-data-plot-pipeline.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="embedding-images.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cpsievert/plotly_book/edit/master/topics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
