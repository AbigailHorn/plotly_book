<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>18.1 Embedding plotly in shiny | Interactive web-based data visualization with R, plotly, and shiny</title>
  <meta name="description" content="A book example for a Chapman &amp; Hall book.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="18.1 Embedding plotly in shiny | Interactive web-based data visualization with R, plotly, and shiny" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book example for a Chapman &amp; Hall book." />
  <meta name="github-repo" content="ropensci/plotly" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18.1 Embedding plotly in shiny | Interactive web-based data visualization with R, plotly, and shiny" />
  <meta name="twitter:site" content="@cpsievert" />
  <meta name="twitter:description" content="A book example for a Chapman &amp; Hall book." />
  

<meta name="author" content="Carson Sievert">


<meta name="date" content="2019-01-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="linking-server-side.html">
<link rel="next" href="shiny-plotly-inputs.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>
<link href="libs/selectize/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize/selectize.min.js"></script>
<link href="libs/colourpicker/colourpicker.min.css" rel="stylesheet" />
<script src="libs/colourpicker/colourpicker.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/plotly.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/summary-fix.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="what-you-will-learn.html"><a href="what-you-will-learn.html"><i class="fa fa-check"></i><b>1.1</b> What you will learn</a></li>
<li class="chapter" data-level="1.2" data-path="how-this-book-is-organized.html"><a href="how-this-book-is-organized.html"><i class="fa fa-check"></i><b>1.2</b> How this book is organized</a></li>
<li class="chapter" data-level="1.3" data-path="what-you-wont-learn.html"><a href="what-you-wont-learn.html"><i class="fa fa-check"></i><b>1.3</b> What you won’t learn</a><ul>
<li class="chapter" data-level="1.3.1" data-path="what-you-wont-learn.html"><a href="what-you-wont-learn.html#web-technologies"><i class="fa fa-check"></i><b>1.3.1</b> Web technologies</a></li>
<li class="chapter" data-level="1.3.2" data-path="what-you-wont-learn.html"><a href="what-you-wont-learn.html#d3js"><i class="fa fa-check"></i><b>1.3.2</b> d3js</a></li>
<li class="chapter" data-level="1.3.3" data-path="what-you-wont-learn.html"><a href="what-you-wont-learn.html#ggplot2"><i class="fa fa-check"></i><b>1.3.3</b> ggplot2</a></li>
<li class="chapter" data-level="1.3.4" data-path="what-you-wont-learn.html"><a href="what-you-wont-learn.html#graphical-data-analysis"><i class="fa fa-check"></i><b>1.3.4</b> Graphical data analysis</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>1.4</b> Prerequisites</a></li>
<li class="chapter" data-level="1.5" data-path="run-code-examples.html"><a href="run-code-examples.html"><i class="fa fa-check"></i><b>1.5</b> Run code examples</a></li>
<li class="chapter" data-level="1.6" data-path="getting-help-and-learning-more.html"><a href="getting-help-and-learning-more.html"><i class="fa fa-check"></i><b>1.6</b> Getting help and learning more</a></li>
<li class="chapter" data-level="1.7" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>1.7</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.8" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i><b>1.8</b> Colophon</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="why-web-graphics.html"><a href="why-web-graphics.html"><i class="fa fa-check"></i><b>2</b> Why interactive web graphics in R?</a></li>
<li class="part"><span><b>I Creating views</b></span></li>
<li class="chapter" data-level="3" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>3</b> Introduction</a></li>
<li class="chapter" data-level="4" data-path="scatter-traces.html"><a href="scatter-traces.html"><i class="fa fa-check"></i><b>4</b> Scatter traces</a><ul>
<li class="chapter" data-level="4.1" data-path="scatterplots.html"><a href="scatterplots.html"><i class="fa fa-check"></i><b>4.1</b> Scatterplots</a><ul>
<li class="chapter" data-level="4.1.1" data-path="scatterplots.html"><a href="scatterplots.html#d-scatterplots"><i class="fa fa-check"></i><b>4.1.1</b> 3D scatterplots</a></li>
<li class="chapter" data-level="4.1.2" data-path="scatterplots.html"><a href="scatterplots.html#scatterplot-matrices"><i class="fa fa-check"></i><b>4.1.2</b> Scatterplot matrices</a></li>
<li class="chapter" data-level="4.1.3" data-path="scatterplots.html"><a href="scatterplots.html#dotplots-error-bars"><i class="fa fa-check"></i><b>4.1.3</b> Dotplots &amp; error bars</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="line-plots.html"><a href="line-plots.html"><i class="fa fa-check"></i><b>4.2</b> Line plots</a><ul>
<li class="chapter" data-level="4.2.1" data-path="line-plots.html"><a href="line-plots.html#density-plots"><i class="fa fa-check"></i><b>4.2.1</b> Density plots</a></li>
<li class="chapter" data-level="4.2.2" data-path="line-plots.html"><a href="line-plots.html#parallel-coordinates"><i class="fa fa-check"></i><b>4.2.2</b> Parallel Coordinates</a></li>
<li class="chapter" data-level="4.2.3" data-path="line-plots.html"><a href="line-plots.html#d-paths"><i class="fa fa-check"></i><b>4.2.3</b> 3D paths</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="segments.html"><a href="segments.html"><i class="fa fa-check"></i><b>4.3</b> Segments</a></li>
<li class="chapter" data-level="4.4" data-path="ribbons.html"><a href="ribbons.html"><i class="fa fa-check"></i><b>4.4</b> Ribbons</a></li>
<li class="chapter" data-level="4.5" data-path="polygons.html"><a href="polygons.html"><i class="fa fa-check"></i><b>4.5</b> Polygons</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>5</b> Maps</a><ul>
<li class="chapter" data-level="5.1" data-path="using-scatter-traces.html"><a href="using-scatter-traces.html"><i class="fa fa-check"></i><b>5.1</b> Using scatter traces</a></li>
<li class="chapter" data-level="5.2" data-path="choropleths.html"><a href="choropleths.html"><i class="fa fa-check"></i><b>5.2</b> Choropleths</a></li>
<li class="chapter" data-level="5.3" data-path="using-geom-sf.html"><a href="using-geom-sf.html"><i class="fa fa-check"></i><b>5.3</b> Using <code>geom_sf()</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bars-histograms.html"><a href="bars-histograms.html"><i class="fa fa-check"></i><b>6</b> Bars &amp; histograms</a><ul>
<li class="chapter" data-level="6.1" data-path="multiple-numeric-distributions.html"><a href="multiple-numeric-distributions.html"><i class="fa fa-check"></i><b>6.1</b> Multiple numeric distributions</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-discrete-distributions.html"><a href="multiple-discrete-distributions.html"><i class="fa fa-check"></i><b>6.2</b> Multiple discrete distributions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>7</b> Boxplots</a></li>
<li class="chapter" data-level="8" data-path="d-frequencies.html"><a href="d-frequencies.html"><i class="fa fa-check"></i><b>8</b> 2D frequencies</a><ul>
<li class="chapter" data-level="8.1" data-path="rectangular-binning-in-plotly-js.html"><a href="rectangular-binning-in-plotly-js.html"><i class="fa fa-check"></i><b>8.1</b> Rectangular binning in plotly.js</a></li>
<li class="chapter" data-level="8.2" data-path="rectangular-binning-in-r.html"><a href="rectangular-binning-in-r.html"><i class="fa fa-check"></i><b>8.2</b> Rectangular binning in R</a></li>
<li class="chapter" data-level="8.3" data-path="categorical-axes.html"><a href="categorical-axes.html"><i class="fa fa-check"></i><b>8.3</b> Categorical axes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="other-3d-plots.html"><a href="other-3d-plots.html"><i class="fa fa-check"></i><b>9</b> Other 3D plots</a></li>
<li class="chapter" data-level="10" data-path="raster-images.html"><a href="raster-images.html"><i class="fa fa-check"></i><b>10</b> Raster images</a></li>
<li class="part"><span><b>II Publishing views</b></span></li>
<li class="chapter" data-level="11" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>11</b> Introduction</a></li>
<li class="chapter" data-level="12" data-path="saving-and-embedding-html.html"><a href="saving-and-embedding-html.html"><i class="fa fa-check"></i><b>12</b> Saving and embedding HTML</a></li>
<li class="chapter" data-level="13" data-path="exporting-static-images.html"><a href="exporting-static-images.html"><i class="fa fa-check"></i><b>13</b> Exporting static images</a><ul>
<li class="chapter" data-level="13.1" data-path="with-code.html"><a href="with-code.html"><i class="fa fa-check"></i><b>13.1</b> With code</a></li>
<li class="chapter" data-level="13.2" data-path="from-a-browser.html"><a href="from-a-browser.html"><i class="fa fa-check"></i><b>13.2</b> From a browser</a></li>
<li class="chapter" data-level="13.3" data-path="sizing-exports.html"><a href="sizing-exports.html"><i class="fa fa-check"></i><b>13.3</b> Sizing exports</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="editing-views-for-publishing.html"><a href="editing-views-for-publishing.html"><i class="fa fa-check"></i><b>14</b> Editing views for publishing</a></li>
<li class="part"><span><b>III Combining multiple views</b></span></li>
<li class="chapter" data-level="15" data-path="arranging-views.html"><a href="arranging-views.html"><i class="fa fa-check"></i><b>15</b> Arranging views</a><ul>
<li class="chapter" data-level="15.1" data-path="arranging-htmlwidgets.html"><a href="arranging-htmlwidgets.html"><i class="fa fa-check"></i><b>15.1</b> Arranging htmlwidgets</a></li>
<li class="chapter" data-level="15.2" data-path="merging-plotly-objects.html"><a href="merging-plotly-objects.html"><i class="fa fa-check"></i><b>15.2</b> Merging plotly objects</a><ul>
<li class="chapter" data-level="15.2.1" data-path="merging-plotly-objects.html"><a href="merging-plotly-objects.html#recursive-subplots"><i class="fa fa-check"></i><b>15.2.1</b> Recursive subplots</a></li>
<li class="chapter" data-level="15.2.2" data-path="merging-plotly-objects.html"><a href="merging-plotly-objects.html#ggplot2-subplots"><i class="fa fa-check"></i><b>15.2.2</b> ggplot2 subplots</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="navigating-many-views.html"><a href="navigating-many-views.html"><i class="fa fa-check"></i><b>15.3</b> Navigating many views</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="animating-views.html"><a href="animating-views.html"><i class="fa fa-check"></i><b>16</b> Animating views</a></li>
<li class="part"><span><b>IV Linking multiple views</b></span></li>
<li class="chapter" data-level="17" data-path="client-side-linking.html"><a href="client-side-linking.html"><i class="fa fa-check"></i><b>17</b> Client-side linking</a><ul>
<li class="chapter" data-level="17.1" data-path="graphical-queries.html"><a href="graphical-queries.html"><i class="fa fa-check"></i><b>17.1</b> Graphical queries</a></li>
<li class="chapter" data-level="17.2" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>17.2</b> Highlight versus filter events</a></li>
<li class="chapter" data-level="17.3" data-path="linking-animated-views.html"><a href="linking-animated-views.html"><i class="fa fa-check"></i><b>17.3</b> Linking animated views</a></li>
<li class="chapter" data-level="17.4" data-path="querying-examples.html"><a href="querying-examples.html"><i class="fa fa-check"></i><b>17.4</b> Examples</a><ul>
<li class="chapter" data-level="17.4.1" data-path="querying-examples.html"><a href="querying-examples.html#trellis-linking"><i class="fa fa-check"></i><b>17.4.1</b> Querying facetted charts</a></li>
<li class="chapter" data-level="17.4.2" data-path="querying-examples.html"><a href="querying-examples.html#statistical-queries"><i class="fa fa-check"></i><b>17.4.2</b> Statistical queries</a></li>
<li class="chapter" data-level="17.4.3" data-path="querying-examples.html"><a href="querying-examples.html#statistical-queries-ggplot"><i class="fa fa-check"></i><b>17.4.3</b> Statistical queries with <code>ggplotly()</code></a></li>
<li class="chapter" data-level="17.4.4" data-path="querying-examples.html"><a href="querying-examples.html#geo-spatial-queries"><i class="fa fa-check"></i><b>17.4.4</b> Geo-spatial queries</a></li>
<li class="chapter" data-level="17.4.5" data-path="querying-examples.html"><a href="querying-examples.html#linking-with-other-htmlwidgets"><i class="fa fa-check"></i><b>17.4.5</b> Linking with other htmlwidgets</a></li>
<li class="chapter" data-level="17.4.6" data-path="querying-examples.html"><a href="querying-examples.html#generalized-pairs-plots"><i class="fa fa-check"></i><b>17.4.6</b> Generalized pairs plots</a></li>
<li class="chapter" data-level="17.4.7" data-path="querying-examples.html"><a href="querying-examples.html#querying-diagnostic-plots"><i class="fa fa-check"></i><b>17.4.7</b> Querying diagnostic plots</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="limitations.html"><a href="limitations.html"><i class="fa fa-check"></i><b>17.5</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linking-server-side.html"><a href="linking-server-side.html"><i class="fa fa-check"></i><b>18</b> Server-side linking with shiny</a><ul>
<li class="chapter" data-level="18.1" data-path="hello-shiny.html"><a href="hello-shiny.html"><i class="fa fa-check"></i><b>18.1</b> Embedding plotly in shiny</a><ul>
<li class="chapter" data-level="18.1.1" data-path="hello-shiny.html"><a href="hello-shiny.html#your-first-shiny-app"><i class="fa fa-check"></i><b>18.1.1</b> Your first shiny app</a></li>
<li class="chapter" data-level="18.1.2" data-path="hello-shiny.html"><a href="hello-shiny.html#hiding-and-redrawing-on-resize"><i class="fa fa-check"></i><b>18.1.2</b> Hiding and redrawing on resize</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html"><i class="fa fa-check"></i><b>18.2</b> Leveraging plotly input events</a><ul>
<li class="chapter" data-level="18.2.1" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html#dragging-events"><i class="fa fa-check"></i><b>18.2.1</b> Dragging events</a></li>
<li class="chapter" data-level="18.2.2" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html#d-events"><i class="fa fa-check"></i><b>18.2.2</b> 3D events</a></li>
<li class="chapter" data-level="18.2.3" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html#edit-events"><i class="fa fa-check"></i><b>18.2.3</b> Edit events</a></li>
<li class="chapter" data-level="18.2.4" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html#relayout-vs-restyle-events"><i class="fa fa-check"></i><b>18.2.4</b> Relayout vs restyle events</a></li>
<li class="chapter" data-level="18.2.5" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html#scoping-events"><i class="fa fa-check"></i><b>18.2.5</b> Scoping events</a></li>
<li class="chapter" data-level="18.2.6" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html#event-priority"><i class="fa fa-check"></i><b>18.2.6</b> Event priority</a></li>
<li class="chapter" data-level="18.2.7" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html#handling-discrete-axes"><i class="fa fa-check"></i><b>18.2.7</b> Handling discrete axes</a></li>
<li class="chapter" data-level="18.2.8" data-path="shiny-plotly-inputs.html"><a href="shiny-plotly-inputs.html#reactive-vals"><i class="fa fa-check"></i><b>18.2.8</b> Accumulating and managing event data</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="shiny-performance.html"><a href="shiny-performance.html"><i class="fa fa-check"></i><b>18.3</b> Improving performance</a><ul>
<li class="chapter" data-level="18.3.1" data-path="shiny-performance.html"><a href="shiny-performance.html#proxies"><i class="fa fa-check"></i><b>18.3.1</b> Partial plotly updates</a></li>
<li class="chapter" data-level="18.3.2" data-path="shiny-performance.html"><a href="shiny-performance.html#partial-update-examples"><i class="fa fa-check"></i><b>18.3.2</b> Partial update examples</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="advanced-applications.html"><a href="advanced-applications.html"><i class="fa fa-check"></i><b>18.4</b> Advanced applications</a><ul>
<li class="chapter" data-level="18.4.1" data-path="advanced-applications.html"><a href="advanced-applications.html#drill-down"><i class="fa fa-check"></i><b>18.4.1</b> Drill-down</a></li>
<li class="chapter" data-level="18.4.2" data-path="advanced-applications.html"><a href="advanced-applications.html#crossfilter"><i class="fa fa-check"></i><b>18.4.2</b> Cross-filter</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>18.5</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="javascript.html"><a href="javascript.html"><i class="fa fa-check"></i><b>19</b> Extending plotly with JavaScript</a><ul>
<li class="chapter" data-level="19.1" data-path="json.html"><a href="json.html"><i class="fa fa-check"></i><b>19.1</b> Working with JSON</a><ul>
<li class="chapter" data-level="19.1.1" data-path="json.html"><a href="json.html#assignment-subsetting-and-iteration"><i class="fa fa-check"></i><b>19.1.1</b> Assignment, subsetting, and iteration</a></li>
<li class="chapter" data-level="19.1.2" data-path="json.html"><a href="json.html#mapping-r-to-json"><i class="fa fa-check"></i><b>19.1.2</b> Mapping R to JSON</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="js-event-handlers.html"><a href="js-event-handlers.html"><i class="fa fa-check"></i><b>19.2</b> Adding custom event handlers</a></li>
<li class="chapter" data-level="19.3" data-path="supplying-custom-data.html"><a href="supplying-custom-data.html"><i class="fa fa-check"></i><b>19.3</b> Supplying custom data</a></li>
<li class="chapter" data-level="19.4" data-path="incorporating-other-client-side-tools.html"><a href="incorporating-other-client-side-tools.html"><i class="fa fa-check"></i><b>19.4</b> Incorporating other client-side tools</a></li>
</ul></li>
<li class="part"><span><b>V Various special topics</b></span></li>
<li class="chapter" data-level="20" data-path="is-plotly-free.html"><a href="is-plotly-free.html"><i class="fa fa-check"></i><b>20</b> Is plotly free?</a></li>
<li class="chapter" data-level="21" data-path="when-does-data-remain-local.html"><a href="when-does-data-remain-local.html"><i class="fa fa-check"></i><b>21</b> When does data remain local?</a></li>
<li class="chapter" data-level="22" data-path="language-support.html"><a href="language-support.html"><i class="fa fa-check"></i><b>22</b> Language support</a></li>
<li class="chapter" data-level="23" data-path="latex-rendering.html"><a href="latex-rendering.html"><i class="fa fa-check"></i><b>23</b> LaTeX rendering</a><ul>
<li class="chapter" data-level="23.1" data-path="mathjax-caveats.html"><a href="mathjax-caveats.html"><i class="fa fa-check"></i><b>23.1</b> MathJax caveats</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="control-tooltip-text.html"><a href="control-tooltip-text.html"><i class="fa fa-check"></i><b>24</b> Control tooltip text</a></li>
<li class="chapter" data-level="25" data-path="control-ggplotly-tooltips.html"><a href="control-ggplotly-tooltips.html"><i class="fa fa-check"></i><b>25</b> Control <code>ggplotly()</code> tooltips</a></li>
<li class="chapter" data-level="26" data-path="control-tooltip-styling.html"><a href="control-tooltip-styling.html"><i class="fa fa-check"></i><b>26</b> Control tooltip styling</a></li>
<li class="chapter" data-level="27" data-path="control-the-modebar.html"><a href="control-the-modebar.html"><i class="fa fa-check"></i><b>27</b> Control the modebar</a><ul>
<li class="chapter" data-level="27.1" data-path="remove-the-entire-modebar.html"><a href="remove-the-entire-modebar.html"><i class="fa fa-check"></i><b>27.1</b> Remove the entire modebar</a></li>
<li class="chapter" data-level="27.2" data-path="remove-the-plotly-logo.html"><a href="remove-the-plotly-logo.html"><i class="fa fa-check"></i><b>27.2</b> Remove the plotly logo</a></li>
<li class="chapter" data-level="27.3" data-path="remove-modebar-buttons.html"><a href="remove-modebar-buttons.html"><i class="fa fa-check"></i><b>27.3</b> Remove modebar buttons</a></li>
<li class="chapter" data-level="27.4" data-path="add-custom-modebar-buttons.html"><a href="add-custom-modebar-buttons.html"><i class="fa fa-check"></i><b>27.4</b> Add custom modebar buttons</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="facetted-subplot.html"><a href="facetted-subplot.html"><i class="fa fa-check"></i><b>28</b> Facetted <code>subplot()</code></a></li>
<li class="chapter" data-level="29" data-path="control-plot-margins.html"><a href="control-plot-margins.html"><i class="fa fa-check"></i><b>29</b> Control plot margin(s)</a></li>
<li class="chapter" data-level="30" data-path="control-axes.html"><a href="control-axes.html"><i class="fa fa-check"></i><b>30</b> Control axes</a></li>
<li class="chapter" data-level="31" data-path="why-does-my-line-plot-appear-blank-i-e-malformed-group-definition.html"><a href="why-does-my-line-plot-appear-blank-i-e-malformed-group-definition.html"><i class="fa fa-check"></i><b>31</b> Why does my line plot appear blank (i.e., malformed group definition)?</a></li>
<li class="chapter" data-level="32" data-path="improving-performance.html"><a href="improving-performance.html"><i class="fa fa-check"></i><b>32</b> Improving performance</a></li>
<li class="chapter" data-level="33" data-path="r-file-size-so-big.html"><a href="r-file-size-so-big.html"><i class="fa fa-check"></i><b>33</b> R file size so big?</a></li>
<li class="chapter" data-level="34" data-path="how-to-prevent-plotly-from-graying-out-in-shiny.html"><a href="how-to-prevent-plotly-from-graying-out-in-shiny.html"><i class="fa fa-check"></i><b>34</b> How to prevent plotly from graying-out in shiny?</a></li>
<li class="chapter" data-level="35" data-path="why-am-i-getting-a-blank-plot.html"><a href="why-am-i-getting-a-blank-plot.html"><i class="fa fa-check"></i><b>35</b> Why am I getting a blank plot?</a></li>
<li class="chapter" data-level="36" data-path="learn-how-to-fish-plotly-js.html"><a href="learn-how-to-fish-plotly-js.html"><i class="fa fa-check"></i><b>36</b> Learn how to fish (plotly.js)</a></li>
<li class="chapter" data-level="37" data-path="how-can-i-report-a-bug.html"><a href="how-can-i-report-a-bug.html"><i class="fa fa-check"></i><b>37</b> How can I report a bug?</a></li>
<li class="chapter" data-level="38" data-path="what-advantages-does-plotlyshiny-have-over-dash.html"><a href="what-advantages-does-plotlyshiny-have-over-dash.html"><i class="fa fa-check"></i><b>38</b> What advantages does plotly+shiny have over dash?</a></li>
<li class="chapter" data-level="39" data-path="developer-facing-topics.html"><a href="developer-facing-topics.html"><i class="fa fa-check"></i><b>39</b> Developer-facing topics</a><ul>
<li class="chapter" data-level="39.1" data-path="translating-custom-ggplot2-geoms.html"><a href="translating-custom-ggplot2-geoms.html"><i class="fa fa-check"></i><b>39.1</b> Translating custom ggplot2 geoms</a></li>
<li class="chapter" data-level="39.2" data-path="designing-an-htmlwidget-interface.html"><a href="designing-an-htmlwidget-interface.html"><i class="fa fa-check"></i><b>39.2</b> Designing an htmlwidget interface</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive web-based data visualization with R, plotly, and shiny</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hello-shiny" class="section level2">
<h2><span class="header-section-number">18.1</span> Embedding plotly in shiny</h2>
<p>Before linking views with <strong>plotly</strong> inside <strong>shiny</strong>, let’s first talk about how to embed <strong>plotly</strong> inside a basic <strong>shiny</strong> app! Through a couple basic examples, you’ll learn the basic components of a <strong>shiny</strong> and get a feel for <strong>shiny</strong>’s reactive programming model, as well as pointers to more learning materials.</p>
<div id="your-first-shiny-app" class="section level3">
<h3><span class="header-section-number">18.1.1</span> Your first shiny app</h3>
<p>The most common <strong>plotly</strong>+<strong>shiny</strong> pattern uses a <strong>shiny</strong> input to control a <strong>plotly</strong> output. Figure <a href="hello-shiny.html#fig:shiny-intro">18.1</a> gives a simple example of using <strong>shiny</strong>’s <code>selectizeInput()</code> function to create a dropdown that controls a <strong>plotly</strong> graph. This example, as well as every other <strong>shiny</strong> app, has two main parts:</p>
<ol style="list-style-type: decimal">
<li>The <em>user interface</em>, <code>ui</code>, defines how inputs and output widgets are displayed on the page. The <code>fluidPage()</code> function offers a nice and quick way get a grid-based responsive layout<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>, but it’s also worth noting the UI is completely customizable<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a>, and packages such as <strong>shinydashboard</strong> make it easy to leverage more sophisticated layout frameworks <span class="citation">(Chang and Borges Ribeiro <a href="#ref-shinydashboard">2018</a>)</span>.</li>
<li>The <em>server</em> function, <code>server</code>, defines a mapping from input values to output widgets. More specifically, the <strong>shiny</strong> <code>server</code> is an R <code>function()</code> between <code>input</code> values on the client and <code>output</code>s generated on the web server.</li>
</ol>
<p>Every input widget, including the <code>selectizeInput()</code> in Figure <a href="hello-shiny.html#fig:shiny-intro">18.1</a>, is tied to a input value that can be accesssed on the server inside a reactive expression. <strong>Shiny</strong>’s reactive expressions build a dependency graph between outputs (aka, reactive endpoints) and inputs (aka, reactive sources). The true power of reactive expressions lies in their ability to chain together and cache computations, but let’s first focus on generating outputs. In order to generate an output, you have to choose a suitable function for rendering the result of a reactive expression.</p>
<p>Figure <a href="hello-shiny.html#fig:shiny-intro">18.1</a> uses the <code>renderPlotly()</code> function to render a reactive expression that generates a <strong>plotly</strong> graph. This expression depends in the input value <code>input$cities</code> (i.e., the input value tied to the input widget with an <code>inputId</code> of <code>"cities"</code>) and stores the output as <code>output$p</code>. This instructs <strong>shiny</strong> to insert the reactive graph into the <code>plotlyOutput(outputId = "p")</code> container defined in the user interface.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shiny)
<span class="kw">library</span>(plotly)

ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(
  <span class="kw">selectizeInput</span>(
    <span class="dt">inputId =</span> <span class="st">&quot;cities&quot;</span>, 
    <span class="dt">label =</span> <span class="st">&quot;Select a city&quot;</span>, 
    <span class="dt">choices =</span> <span class="kw">unique</span>(txhousing<span class="op">$</span>city), 
    <span class="dt">selected =</span> <span class="st">&quot;Abilene&quot;</span>,
    <span class="dt">multiple =</span> <span class="ot">TRUE</span>
  ),
  <span class="kw">plotlyOutput</span>(<span class="dt">outputId =</span> <span class="st">&quot;p&quot;</span>)
)

server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, ...) {
  output<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">renderPlotly</span>({
    <span class="kw">plot_ly</span>(txhousing, <span class="dt">x =</span> <span class="op">~</span>date, <span class="dt">y =</span> <span class="op">~</span>median) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">filter</span>(city <span class="op">%in%</span><span class="st"> </span>input<span class="op">$</span>cities) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">group_by</span>(city) <span class="op">%&gt;%</span>
<span class="st">      </span><span class="kw">add_lines</span>()
  })
}

<span class="kw">shinyApp</span>(ui, server)</code></pre>
<div class="figure"><span id="fig:shiny-intro"></span>
<iframe src="https://player.vimeo.com/video/307597444?title=0&amp;byline=0&amp;portrait=0" width="100%" height="400" frameborder="0" seamless="seamless" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<p class="caption">
FIGURE 18.1: Using a <strong>shiny</strong> input widget to control which time series are shown on a <strong>plotly</strong> graph.
</p>
</div>
<p>If, instead of a <strong>plotly</strong> graph, a reactive expression generates a static R graphic, simply use <code>renderPlot()</code> (instead of <code>renderPlotly()</code>) to render it and <code>plotOutput()</code> (instead of <code>plotlyOutput()</code>) to position it. Other <strong>shiny</strong> output widgets also use this naming convention: <code>renderDataTable()</code>/<code>datatableOutput()</code>, <code>renderPrint()</code>/<code>verbatimTextOutput()</code>, <code>renderText()</code>/<code>textOutput()</code>, <code>renderImage()</code>/<code>imageOutput()</code>, etc. Packages that are built on the <strong>htmlwidgets</strong> standard (e.g. <strong>plotly</strong> and <strong>leaflet</strong>) are, in some sense, also <strong>shiny</strong> output widgets that are encouraged to follow this same naming convention (e.g. <code>renderPlotly()</code>/<code>plotlyOutput()</code> and <code>renderLeaflet()</code>/<code>leafletOutput()</code>).</p>
<p><strong>Shiny</strong> also comes pre-packaged with a handful of other useful input widgets. Although many <strong>shiny</strong> apps use them straight “out-of-the-box”, input widgets can easily be stylized with CSS and/or SASS, and even custom input widgets can be integrated <span class="citation">(Mastny <a href="#ref-sass">2018</a>, <span class="citation">@shiny-custom-inputs</span>)</span>.</p>
<ul>
<li><code>selectInput()</code>/<code>selectizeInput()</code> for dropdown menus.</li>
<li><code>numericInput()</code> for a single number.</li>
<li><code>sliderInput()</code> for a numeric range.</li>
<li><code>textInput()</code> for a character string.</li>
<li><code>dateInput()</code> for a single date.</li>
<li><code>dateRangeInput()</code> for a range of dates.</li>
<li><code>fileInput()</code> for uploading files.</li>
<li><code>checkboxInput()</code>/<code>checkboxGroupInput()</code>/<code>radioButtons()</code> for choosing a list of options.</li>
</ul>
<p>Going forward our focus is to link multiple graphs in <strong>shiny</strong> through direct manipulation, so we focus less on using these input widgets, and more on using <strong>plotly</strong> and static R graphics as inputs to other output widgets. Section <a href="shiny-plotly-inputs.html#shiny-plotly-inputs">18.2</a> provides an introduction to this idea, but before we learn how to access these input events, you may want to know a bit more about rendering <strong>plotly</strong> inside <strong>shiny</strong>.</p>
</div>
<div id="hiding-and-redrawing-on-resize" class="section level3">
<h3><span class="header-section-number">18.1.2</span> Hiding and redrawing on resize</h3>
<p>The <code>renderPlotly()</code> function renders anything that the <code>plotly_build()</code> function understands, including <code>plot_ly()</code>, <code>ggplotly()</code>, and <strong>ggplot2</strong> objects.<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> It also renders <code>NULL</code> as an empty HTML div, which is handy for certain cases where it doesn’t make sense to render a graph. Figure <a href="hello-shiny.html#fig:shiny-ggplotly">18.2</a> leverages these features to render an empty div while <code>selectizeInput()</code>’s placeholder is shown, but then render a <strong>plotly</strong> graph via <code>ggplotly()</code> once cities have been selected. Figure <a href="hello-shiny.html#fig:shiny-ggplotly">18.2</a> also shows how to make the <strong>plotly</strong> output depend on the size of the container that holds the <strong>plotly</strong> graph. By default, when a browser is resized, the graph size is changed purely client-side, but this reactive expression will re-execute when the browser window is resized. Due to technical reasons this can improve <code>ggplotly()</code> resizing behavior<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>, but should be used with caution when handling large data and long render times.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(shiny)
<span class="kw">library</span>(plotly)

cities &lt;-<span class="st"> </span><span class="kw">unique</span>(txhousing<span class="op">$</span>city)

ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(
  <span class="kw">selectizeInput</span>(
    <span class="dt">inputId =</span> <span class="st">&quot;cities&quot;</span>, 
    <span class="dt">label =</span> <span class="ot">NULL</span>,
    <span class="co"># placeholder prompt is triggered when first choice is an empty string</span>
    <span class="dt">choices =</span> <span class="kw">c</span>(<span class="st">&quot;Please choose a city&quot;</span> =<span class="st"> &quot;&quot;</span>, cities), 
    <span class="dt">multiple =</span> <span class="ot">TRUE</span>
  ),
  <span class="kw">plotlyOutput</span>(<span class="dt">outputId =</span> <span class="st">&quot;p&quot;</span>)
)

server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session, ...) {
  output<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">renderPlotly</span>({
    <span class="kw">req</span>(input<span class="op">$</span>cities)
    <span class="cf">if</span> (<span class="kw">identical</span>(input<span class="op">$</span>cities, <span class="st">&quot;&quot;</span>)) <span class="kw">return</span>(<span class="ot">NULL</span>)
    p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">filter</span>(txhousing, city <span class="op">%in%</span><span class="st"> </span>input<span class="op">$</span>cities)) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(date, median, <span class="dt">group =</span> city))
    <span class="kw">ggplotly</span>(p, <span class="dt">height =</span> session<span class="op">$</span>clientData<span class="op">$</span>output_p_height, <span class="dt">width =</span> session<span class="op">$</span>clientData<span class="op">$</span>output_p_width)
  })
}

<span class="kw">shinyApp</span>(ui, server)</code></pre>
<div class="figure"><span id="fig:shiny-ggplotly"></span>
<iframe src="https://player.vimeo.com/video/307598318?title=0&amp;byline=0&amp;portrait=0" width="100%" height="400" frameborder="0" seamless="seamless" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
<p class="caption">
FIGURE 18.2: Rendering a <strong>plotly</strong> graph in <strong>shiny</strong> if and only if the <code>selectizeInput()</code>’s dropdown is non-empty. When the graph is present, and the window is resized, then the reactive expression is re-evaluated.
</p>
</div>
<p>When a reactive expression inside <code>renderPlotly()</code> is re-executes, it triggers a full redraw of the <strong>plotly</strong> graph on the client. Generally speaking, this makes your <strong>shiny</strong> app logic easy to reason about, but it’s not always performant enough. For example, say you have a scatterplot with 10s of thousands of points, and you just want to add a fitted line to those points (in respond to input event)? Instead of redrawing the whole plot from scratch, it can be way more performant to partially update specific components of the visual. Section <a href="shiny-performance.html#proxies">18.3.1</a> covers this idea through a handful of examples.</p>
<!--
The `renderPlotly()` function anticipates a reactive expression that generates a **plotly** object. **Shiny** itself provides a handful of similar functions that anticipate more "standard" R outputs, like data frames (`renderTable()` or `renderDataTable()`), output from the R graphics device (`renderPlot()`), and things printed to the R console (`renderPrint()` or `renderText()`). Other R packages sometimes provide a custom reactive for a custom R object, and in fact, the **htmlwidgets** package provides a standard way to scaffold this reactive glue which **plotly** implements with `renderPlotly()` and **leaflet** implements with `renderLeaflet()`.

Once a reactive expression generates a value, it needs to know where on the user interface to place the output result. That is why the result of `renderPlotly()` in Figure \@ref(fig:shiny-intro) is assigned to `output$p`. This information lets **shiny** know to insert the code result into `plotlyOutput("p")`, the UI output with an id of "p". At face value, it may seem like **shiny**'s reactive expressions can only produce output widgets, but `renderUI()` allows one to dynamically render input widgets on the server as well.
-->
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-shinydashboard">
<p>Chang, Winston, and Barbara Borges Ribeiro. 2018. <em>Shinydashboard: Create Dashboards with ’Shiny’</em>. <a href="https://CRAN.R-project.org/package=shinydashboard">https://CRAN.R-project.org/package=shinydashboard</a>.</p>
</div>
<div id="ref-sass">
<p>Mastny, Timothy. 2018. <em>Sass: Syntactically Awesome Stylesheets (Sass) Compiler</em>. <a href="https://github.com/rstudio/sass">https://github.com/rstudio/sass</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="17">
<li id="fn17"><p>Read more about <strong>shiny</strong>’s responsive layout here <a href="https://shiny.rstudio.com/articles/layout-guide.html" class="uri">https://shiny.rstudio.com/articles/layout-guide.html</a><a href="hello-shiny.html#fnref17" class="footnote-back">↩</a></p></li>
<li id="fn18"><p>Read more about using custom HTML templates here <a href="https://shiny.rstudio.com/articles/html-ui.html" class="uri">https://shiny.rstudio.com/articles/html-ui.html</a><a href="hello-shiny.html#fnref18" class="footnote-back">↩</a></p></li>
<li id="fn19"><p>The <code>plotly_build()</code> function is an S3 generic, so you can list all relevant the methods with <code>methods(plotly_build)</code>, and write you’re own method to translate a custom object to <strong>plotly</strong>.<a href="hello-shiny.html#fnref19" class="footnote-back">↩</a></p></li>
<li id="fn20"><p>In order to convert <strong>grid</strong> grobs that are relatively sized, the <code>ggplotly()</code> function uses the size of the current graphics device at print-time, meaning that resizing the browser window without a hook back to R can create wonky sizes.<a href="hello-shiny.html#fnref20" class="footnote-back">↩</a></p></li>
</ol>
</div>
<script>
  var header = document.querySelector(".book-header h1");

  var img = document.createElement("img");
  img.src = "images/rstudioCloud.svg";
  img.width = 200;
  img.align = "right";
  img.style = "margin-top: 10px";

  var a = document.createElement("a");
  a.href = "https://rstudio.cloud/project/156701";
  a.target = "_blank";
  a.appendChild(img);

  header.appendChild(a);
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-60116966-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-60116966-3');
</script>
            </section>

          </div>
        </div>
      </div>
<a href="linking-server-side.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="shiny-plotly-inputs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cpsievert/plotly_book/edit/master/linked-views-shiny.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
