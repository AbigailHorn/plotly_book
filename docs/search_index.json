[
["index.html", "plotly for R Overview", " plotly for R Carson Sievert Overview This website explains and partially documents the R package plotly, a high-level interface to the open source JavaScript graphing library plotly.js (which powers plot.ly). The R package already has numerous examples and documentation on https://plot.ly/r and https://plot.ly/ggplot2, but this website provides more of a cohesive narrative to help explain fundamental concepts and recent developments. By reading from start to finish, readers new to R and plotly should be able to get up and running fairly quickly. That being said, advanced R and plotly users should still find the majority of this material useful and informative. I highly recommend copying/pasting examples into your R console, and modifying them as you read along, to aid the learning process. This work is licensed under the Creative Commons Attribution-NonCommercial-NoDerivs 3.0 United States License. "],
["installation.html", "Installation", " Installation If you have R installed, you can install the stable release of plotly by typing this in your R console: install.packages(&quot;plotly&quot;) Or you can install the development release via the devtools package: if (!require(&quot;devtools&quot;)) install.packages(&quot;devtools&quot;) devtools::install_github(&quot;ropensci/plotly&quot;) "],
["get-started.html", "Get started", " Get started To ensure plotly is installed correctly, try loading the package and creating this example by pasting the code inside your R console. library(plotly) plot_ly(z = ~volcano) plotly uses the htmlwidget framework, which allows plots to work seamlessly and consistently in various contexts (e.g., R Markdown documents, shiny apps, inside RStudio, or any other R command prompt) without an internet connection. IPython/Jupyter notebook users should wrap plots with the embed_notebook() function to embed them inline inside a notebook. "],
["plot-ly-for-collaboration.html", "plot.ly for collaboration", " plot.ly for collaboration plot.ly subscribers can use plotly_POST() function to publish plots onto plotly’s web platform. This platform makes it very easy to host/share your graphs, collaborate with others, and is free to use for public graphs (have a look at our pricing options if you need privacy or customer support). Once a plot is hosted on your account, others may copy/fork your graph to their account (given the right permissions) using a friendly user-interface. As long as you can view a plot hosted on http://plot.ly, you can obtain the data behind with plot via the get_figure() function. This makes it easy to access and modify plots created with any plotly.js interface (e.g., Python, MATLAB, Julia, Scala, etc) from your R console. Not only is this web-based user-interface to plotly.js useful for collaborating with others, but it is also useful for completing tasks that are cumbersome to do at the command-line. For instance, annotations can be added to any plot via a point-and-click interface: -->"],
["two-approaches-one-object.html", "1 Two approaches, one object", " 1 Two approaches, one object There are two main ways to initiate a plotly object in R. The plot_ly() function transforms data into a plotly object, while the ggplotly() function transforms a ggplot object into a plotly object (Wickham 2009); (Sievert et al. 2016). Regardless how plotly object is created, printing it results in an interactive web-based visualization with tooltips, zooming, and panning enabled by default. It is also possible to enable more advanced interactive techniques, such as animation and linked highlighting. This chapter discusses some of the philosophy behind each approach, explores some of their similarities, and explains why understanding both approaches is extremely powerful. The initial inspiration for the plot_ly() function was to support plotly.js chart types that ggplot2 doesn’t support, such as 3D surface and mesh plots. Over time, this effort snowballed into an interface to the entire plotly.js graphing library with additional abstractions inspired by the grammar of graphics (Wilkinson 2005). This newer “non-ggplot2” interface to plotly.js is currently not, and may never be, as fully featured as ggplot2. Since we can already translate a fairly large amount of ggplot objects to plotly objects, I’d rather not reinvent those same abstractions, and focus providing useful tools for advanced interactive graphics. The next section uses a case study to introduce some of the similarities between ggplotly() and plot_ly(), dives into the cognitive framework behind plot_ly(), and also demonstrates how to extend ggplotly() with functions that can modify plotly objects. "],
["a-case-study-of-housing-sales-in-texas.html", "1.1 A case study of housing sales in Texas", " 1.1 A case study of housing sales in Texas The plotly package depends on ggplot2 which bundles a data set on monthly housing sales in Texan cities acquired from the TAMU real estate center. After the loading the package, the data is “lazily loaded” into your session, so you may reference it by name: library(plotly) txhousing ## # A tibble: 8,602 × 9 ## city year month sales volume median listings inventory date ## &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Abilene 2000 1 72 5380000 71400 701 6.3 2000.000 ## 2 Abilene 2000 2 98 6505000 58700 746 6.6 2000.083 ## 3 Abilene 2000 3 130 9285000 58100 784 6.8 2000.167 ## 4 Abilene 2000 4 98 9730000 68600 785 6.9 2000.250 ## 5 Abilene 2000 5 141 10590000 67300 794 6.8 2000.333 ## 6 Abilene 2000 6 156 13910000 66900 780 6.6 2000.417 ## 7 Abilene 2000 7 152 12635000 73500 742 6.2 2000.500 ## 8 Abilene 2000 8 131 10710000 75000 765 6.4 2000.583 ## 9 Abilene 2000 9 104 7615000 64500 771 6.5 2000.667 ## 10 Abilene 2000 10 101 7040000 59300 764 6.6 2000.750 ## # ... with 8,592 more rows In attempt to understand house price behavior over time, we could plot date on x, median on y, and group the lines connecting these x/y pairs by city. Using ggplot2, we can initiate a ggplot object with the ggplot() function which accepts a data frame and a mapping from data variables to visual aesthetics. By just initiating the object, ggplot2 won’t know how to geometrically represent the mapping until we add a layer to the plot via one of geom_*() (or stat_*()) functions (in this case, we want geom_line()). In this case, it is also a good idea to specify alpha transparency so that 5 lines plotted on top of each other appear as solid black, to help avoid overplotting. If you’re new to ggplot2, the ggplot2 cheatsheet provides a nice quick overview. The online docs or R graphics cookbook are helpful for learning by example, and the ggplot2 book provides a nice overview of the conceptual underpinnings. p &lt;- ggplot(txhousing, aes(date, median)) + geom_line(aes(group = city), alpha = 0.2) Now that we have a valid ggplot2 object, p, the plotly package provides the ggplotly() function which converts a ggplot object to a plotly object. By default, it supplies the entire aesthetic mapping to the tooltip, but the tooltip argument provides a way to restrict tooltip info to a subset of that mapping. Furthermore, in cases where the statistic of a layer is something other than the identity function (e.g., geom_bin2d() and geom_hex()), relevant “intermediate” variables generated in the process are also supplied to the tooltip. This provides a nice mechanism for decoding visual aesthetics (e.g., color) used to represent a measure of interest (e.g, count/value). In Figure ??, the subplot() function from the plotly package (discussed in more detail in subplots), which accepts a collection of ggplot and/or plotly objects, helps to concisely display tooltips for a number of scenarios, and how to suppress them. subplot( p, ggplotly(p, tooltip = &quot;city&quot;), ggplot(txhousing, aes(date, median)) + geom_bin2d(), ggplot(txhousing, aes(date, median)) + geom_hex(), nrows = 2, shareX = TRUE, shareY = TRUE, titleY = FALSE, titleX = FALSE ) Although ggplot2 does not have a text aesthetic, the ggplotly() function recognizes this aesthetic and displays it in the tooltip by default. In addition to providing a way to supply “meta” information, it also provides a way to customize your tooltips (do this by restricting the tooltip to the text aesthetic – ggplotly(p, tooltip = “text”)) The ggplotly() function translates most things that you can do in ggplot2, but not quite everything. To help demonstrate the coverage, I’ve built a plotly version of the ggplot2 docs. This version of the docs displays the ggplotly() version of each plot in a static form (to reduce page loading time), but you can click any plot to view its interactive version. The next section deomnstrates how to create plotly.js visualizations via the R package, without ggplot2, via the plot_ly() interface. We’ll then leverage those concepts to extend ggplotly(). 1.1.1 The plot_ly() interface 1.1.1.1 The Layered Grammar of Graphics The cognitive framework underlying the plot_ly() interface draw inspiration from the layered grammar of graphics (Wickham 2010), but in contrast to ggplotly(), it provides a more flexible and direct interface to plotly.js. It is more direct in the sense that it doesn’t call ggplot2’s sometimes expensive plot building routines, and it is more flexible in the sense that data frames are not required, which is useful for visualizing matrices, as shown in Get Started. Although data frames are not required, it is recommended to use them whenever possible, especially when constructing a plot with multiple layers or groups. When a data frame is associated with a plotly object, it allows us to manipulate the data underlying that object in the same way we would directly manipulate the data. Currently, plot_ly() borrows semantics from and provides special plotly methods for generic functions in the dplyr and tidyr packages (Wickham and Francois 2016); (Wickham, n.d.). Most importantly, plot_ly() recognizes and preserves groupings created with dplyr’s group_by(). library(dplyr) tx &lt;- group_by(txhousing, city) # initiate a plotly object with date on x and median on y p &lt;- plot_ly(tx, x = ~date, y = ~median) # plotly_data() returns data associated with a plotly object, note the group attribute! plotly_data(p) ## Source: local data frame [8,602 x 9] ## Groups: city [46] ## ## city year month sales volume median listings inventory date ## &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 Abilene 2000 1 72 5380000 71400 701 6.3 2000.000 ## 2 Abilene 2000 2 98 6505000 58700 746 6.6 2000.083 ## 3 Abilene 2000 3 130 9285000 58100 784 6.8 2000.167 ## 4 Abilene 2000 4 98 9730000 68600 785 6.9 2000.250 ## 5 Abilene 2000 5 141 10590000 67300 794 6.8 2000.333 ## 6 Abilene 2000 6 156 13910000 66900 780 6.6 2000.417 ## 7 Abilene 2000 7 152 12635000 73500 742 6.2 2000.500 ## 8 Abilene 2000 8 131 10710000 75000 765 6.4 2000.583 ## 9 Abilene 2000 9 104 7615000 64500 771 6.5 2000.667 ## 10 Abilene 2000 10 101 7040000 59300 764 6.6 2000.750 ## # ... with 8,592 more rows Defining groups in this fashion ensures plot_ly() will produce at least one graphical mark per group.1 So far we’ve specified x/y attributes in the plotly object p, but we have not yet specified the geometric relation between these x/y pairs. Similar to geom_line() in ggplot2, the add_lines() function connects (a group of) x/y pairs with lines in the order of their x values, which is useful when plotting time series as shown in Figure ??. # add a line highlighting houston add_lines( # plots one line per city since p knows city is a grouping variable add_lines(p, alpha = 0.2, name = &quot;Texan Cities&quot;, hoverinfo = &quot;none&quot;), name = &quot;Houston&quot;, data = filter(txhousing, city == &quot;Houston&quot;) ) The plotly package has a collection of add_*() functions, all of which inherit attributes defined in plot_ly(). These functions also inherit the data associated with the plotly object provided as input, unless otherwise specified with the data argument. I prefer to think about add_*() functions like a layer in ggplot2, which is slightly different, but related to a plotly.js trace. In Figure ??, there is a 1-to-1 correspondence between layers and traces, but add_*() functions do generate numerous traces whenever mapping a discrete variable to a visual aesthetic (e.g., color). In this case, since each call to add_lines() generates a single trace, it makes sense to name the trace, so a sensible legend entry is created. In the first layer of Figure ??, there is one line per city, but all these lines belong a single trace. We could have produced one trace for each line, but this is way more computationally expensive because, among other things, each trace produces a legend entry and tries to display meaningful hover information. It is much more efficient to render this layer as a single trace with missing values to differentiate groups. In fact, this is exactly how the group aesthetic is translated in ggplotly(); otherwise, layers with many groups (e.g., geom_map()) would be slow to render. 1.1.1.2 The data-plot-pipeline Since every plotly function modifies a plotly object (or the data underlying that object), we can express complex multi-layer plots as a sequence (or, more specifically, a directed acyclic graph) of data manipulations and mappings to the visual space. Moreover, plotly functions are designed to take a plotly object as input, and return a modified plotly object, making it easy to chain together operations via the pipe operator (%&gt;%) from the magrittr package (Bache and Wickham 2014). Consequently, we can re-express Figure ?? in a much more readable and understandable fashion. allCities &lt;- txhousing %&gt;% group_by(city) %&gt;% plot_ly(x = ~date, y = ~median) %&gt;% add_lines(alpha = 0.2, name = &quot;Texan Cities&quot;, hoverinfo = &quot;none&quot;) allCities %&gt;% filter(city == &quot;Houston&quot;) %&gt;% add_lines(name = &quot;Houston&quot;) Sometimes the directed acyclic graph property of a pipeline can be too restrictive for certain types of plots. In this example, after filtering the data down to Houston, there is no way to recover the original data inside the pipeline. The add_fun() function helps to work-around this restriction2 – it works by applying some function to the plotly object, then returns the data that was originally fed into it. This effectively provides a way to isolate data transformations from the data associated with the plotly object3. Figure ?? uses this idea to highlight both Houston and San Antonio. allCities %&gt;% add_fun(function(plot) { plot %&gt;% filter(city == &quot;Houston&quot;) %&gt;% add_lines(name = &quot;Houston&quot;) }) %&gt;% add_fun(function(plot) { plot %&gt;% filter(city == &quot;San Antonio&quot;) %&gt;% add_lines(name = &quot;San Antonio&quot;) }) It’s helpful to conceptual the function supplied to add_fun() as a “layer” function – a function that accepts a plot object as input, possibly applies a summary statistic to the data, and maps that data to visual objects. To make layering functions more modular, flexible, and expressive, the add_fun() allows you to pass additional arguments to a layer function. Figure ?? makes use of this pattern, by creating a reusable function for layering both a particular city as well as the first, second, and third quartile of median monthly house sales (by city). # reusable function for highlighting a particular city layer_city &lt;- function(plot, name) { plot %&gt;% filter(city == name) %&gt;% add_lines(name = name) } # reusable function for plotting overall median &amp; IQR layer_iqr &lt;- function(plot) { plot %&gt;% group_by(date) %&gt;% summarise( q1 = quantile(median, 0.25, na.rm = TRUE), m = median(median, na.rm = TRUE), q3 = quantile(median, 0.75, na.rm = TRUE) ) %&gt;% add_lines(y = ~m, name = &quot;median&quot;, color = I(&quot;black&quot;)) %&gt;% add_ribbons(ymin = ~q1, ymax = ~q3, name = &quot;IQR&quot;, color = I(&quot;black&quot;)) } allCities %&gt;% add_fun(layer_iqr) %&gt;% add_fun(layer_city, &quot;Houston&quot;) %&gt;% add_fun(layer_city, &quot;San Antonio&quot;) A layering function does not have to be data-plot-pipeline itself. It’s only requirement on a layering function is that the first argument is a plot object and it returns a plot object. This provides an opportunity to fit a model to the plot data, extract the model components you desire, and map those components to visuals. Furthermore, since plotly’s add_*() functions don’t require a data.frame, you can supply those components directly to attributes (as long as they are well-defined), as done in Figure ?? via the forecast package (Hyndman, n.d.). library(forecast) layer_forecast &lt;- function(plot) { d &lt;- plotly_data(plot) series &lt;- with(d, ts(median, frequency = 12, start = c(2000, 1), end = c(2015, 7)) ) fore &lt;- forecast(ets(series), h = 48, level = c(80, 95)) plot %&gt;% add_ribbons(x = time(fore$mean), ymin = fore$lower[, 2], ymax = fore$upper[, 2], color = I(&quot;gray95&quot;), name = &quot;95% confidence&quot;, inherit = FALSE) %&gt;% add_ribbons(x = time(fore$mean), ymin = fore$lower[, 1], ymax = fore$upper[, 1], color = I(&quot;gray80&quot;), name = &quot;80% confidence&quot;, inherit = FALSE) %&gt;% add_lines(x = time(fore$mean), y = fore$mean, color = I(&quot;blue&quot;), name = &quot;prediction&quot;) } txhousing %&gt;% group_by(city) %&gt;% plot_ly(x = ~date, y = ~median) %&gt;% add_lines(alpha = 0.2, name = &quot;Texan Cities&quot;, hoverinfo = &quot;none&quot;) %&gt;% add_fun(layer_iqr) %&gt;% add_fun(layer_forecast) In summary, the “data-plot-pipeline” is desirable for a number of reasons: (1) makes your code easier to read and understand, (2) encourages you to think of both your data and plots using a single, uniform data structure, and (3) provides a natural mechanism for implementing the pipeline(s) necessary in interactive graphics system with support for Linked Highlighting (Wickham et al. 2010). In practice, it’s easy to forget about “lingering” groups (e.g., mtcars %&gt;% group_by(vs, am) %&gt;% summarise(s = sum(mpg))), so in some cases, you may need to ungroup() your data before plotting it.↩ Credit to Winston Chang and Hadley Wickham for this idea. The add_fun() is very much like layer_f() function in ggvis.↩ Also, effectively putting a pipeline inside a pipeline↩ "],
["extending-ggplotly.html", "1.2 Extending ggplotly()", " 1.2 Extending ggplotly() 1.2.1 Customizing the layout Since the ggplotly() function returns a plotly object, we can manipulate that object in the same way that we would manipulate an object created with plot_ly(). A simple and obviously useful application of this is for changing default interaction modes, like plotly.js’ layout.hovermode. p &lt;- ggplot(fortify(gold), aes(x, y)) + geom_line() gg &lt;- ggplotly(p) layout(gg, hovermode = &quot;x&quot;) We can also easily add a range slider to the x-axis, which allows you to zoom on the x-axis, without losing the global context. This is quite useful for quickly altering the limits of your plot to achieve an optimal aspect ratio for your data (William S. Cleveland 1988), without losing the global perspective. rangeslider(gg) Since a single plotly object can only have one layout, modifying the layout of ggplotly() is fairly easy, but it’s trickier to add and modify layers. 1.2.2 Adding layers Since ggplotly() returns a plotly object, and plotly objects have data associated with them, we can effectively associate data from a ggplot object with a plotly object, before or after summary statistics have been applied. Since each ggplot layer owns a data frame, it is useful to have some way to specify the particular layer of data of interest, which is the point of the layerData argument in ggplotly(). Also, when a particular layer applies a summary statistic (e.g., geom_bin()), or applies a model (e.g., geom_smooth()) to the data, it might be useful to access the output of that transformation, which is the point of the originalData argument in ggplotly(). p &lt;- ggplot(mtcars, aes(x = wt, y = mpg)) + geom_point() + geom_smooth() p %&gt;% ggplotly(layerData = 2, originalData = FALSE) %&gt;% plotly_data() ## # A tibble: 80 × 13 ## x y ymin ymax se PANEL group colour ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; ## 1 1.513000 32.08897 28.14821 36.02974 1.9183213 1 -1 #3366FF ## 2 1.562506 31.68786 28.15439 35.22134 1.7200573 1 -1 #3366FF ## 3 1.612013 31.28163 28.10997 34.45329 1.5439313 1 -1 #3366FF ## 4 1.661519 30.87037 28.01249 33.72825 1.3911843 1 -1 #3366FF ## 5 1.711025 30.45419 27.85973 33.04864 1.2629527 1 -1 #3366FF ## 6 1.760532 30.03318 27.65029 32.41607 1.1599650 1 -1 #3366FF ## 7 1.810038 29.60745 27.38445 31.83046 1.0821338 1 -1 #3366FF ## 8 1.859544 29.17711 27.06496 31.28925 1.0281676 1 -1 #3366FF ## 9 1.909051 28.74224 26.69739 30.78709 0.9954106 1 -1 #3366FF ## 10 1.958557 28.30017 26.28752 30.31283 0.9797387 1 -1 #3366FF ## # ... with 70 more rows, and 5 more variables: fill &lt;chr&gt;, size &lt;dbl&gt;, ## # linetype &lt;dbl&gt;, weight &lt;dbl&gt;, alpha &lt;dbl&gt; This is the dataset ggplot2 uses to actually draw the fitted values (as a line) and standard error bounds (as a ribbon). Figure ?? uses this data to add additional information about the model fit; in particular, it adds a vertical lines and annotations at the x-values that are associated with the highest and lowest amount uncertainty in y. p %&gt;% ggplotly(layerData = 2, originalData = F) %&gt;% add_fun(function(p) { p %&gt;% slice(which.max(se)) %&gt;% add_segments(x = ~x, xend = ~x, y = ~ymin, yend = ~ymax) %&gt;% add_annotations(&quot;Maximum uncertainty&quot;, ax = 60) }) %&gt;% add_fun(function(p) { p %&gt;% slice(which.min(se)) %&gt;% add_segments(x = ~x, xend = ~x, y = ~ymin, yend = ~ymax) %&gt;% add_annotations(&quot;Minimum uncertainty&quot;) }) Although it is not used in this example, it worth noting that when adding plotly layers to the output of ggplotly(), it will inherit the global mapping by default, which may or may not be desired, but the inherit argument in any of the add_*() functions may be set to FALSE to avoid this behavoir. 1.2.3 Modifying layers As mentioned previously, ggplotly() translates each ggplot2 layer into one or more plotly.js traces. In this translation, it is forced to make a number of assumptions about trace attribute values that may or may not be appropriate for the use case. The style() function is useful in this scenario, as it provides a way to modify trace attribute values in a plotly object. Before using it, you may want to inspect the actual traces in a given plotly object using the plotly_json() function. This function uses the listviewer package to display a convenient interactive view of the JSON object sent to plotly.js (de Jong and Russell 2016). By clicking on the arrow next to the data element, you can see the traces (data) behind the plot. In this case, we have three traces: one for the geom_point() layer and two for the geom_smooth() layer. plotly_json(p) ## { ## &quot;data&quot;: [ ## { ## &quot;x&quot;: [2.62, 2.875, 2.32, 3.215, 3.44, 3.46, 3.57, 3.19, 3.15, 3.44, 3.44, 4.07, 3.73, 3.78, 5.25, 5.424, 5.345, 2.2, 1.615, 1.835, 2.465, 3.52, 3.435, 3.84, 3.845, 1.935, 2.14, 1.513, 3.17, 2.77, 3.57, 2.78], ## &quot;y&quot;: [21, 21, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.8, 16.4, 17.3, 15.2, 10.4, 10.4, 14.7, 32.4, 30.4, 33.9, 21.5, 15.5, 15.2, 13.3, 19.2, 27.3, 26, 30.4, 15.8, 19.7, 15, 21.4], ## &quot;text&quot;: [&quot;wt: 2.62&lt;br&gt;mpg: 21&quot;, &quot;wt: 2.88&lt;br&gt;mpg: 21&quot;, &quot;wt: 2.32&lt;br&gt;mpg: 22.8&quot;, &quot;wt: 3.21&lt;br&gt;mpg: 21.4&quot;, &quot;wt: 3.44&lt;br&gt;mpg: 18.7&quot;, &quot;wt: 3.46&lt;br&gt;mpg: 18.1&quot;, &quot;wt: 3.57&lt;br&gt;mpg: 14.3&quot;, &quot;wt: 3.19&lt;br&gt;mpg: 24.4&quot;, &quot;wt: 3.15&lt;br&gt;mpg: 22.8&quot;, &quot;wt: 3.44&lt;br&gt;mpg: 19.2&quot;, &quot;wt: 3.44&lt;br&gt;mpg: 17.8&quot;, &quot;wt: 4.07&lt;br&gt;mpg: 16.4&quot;, &quot;wt: 3.73&lt;br&gt;mpg: 17.3&quot;, &quot;wt: 3.78&lt;br&gt;mpg: 15.2&quot;, &quot;wt: 5.25&lt;br&gt;mpg: 10.4&quot;, &quot;wt: 5.42&lt;br&gt;mpg: 10.4&quot;, &quot;wt: 5.34&lt;br&gt;mpg: 14.7&quot;, &quot;wt: 2.2&lt;br&gt;mpg: 32.4&quot;, &quot;wt: 1.62&lt;br&gt;mpg: 30.4&quot;, &quot;wt: 1.84&lt;br&gt;mpg: 33.9&quot;, &quot;wt: 2.46&lt;br&gt;mpg: 21.5&quot;, &quot;wt: 3.52&lt;br&gt;mpg: 15.5&quot;, &quot;wt: 3.44&lt;br&gt;mpg: 15.2&quot;, &quot;wt: 3.84&lt;br&gt;mpg: 13.3&quot;, &quot;wt: 3.85&lt;br&gt;mpg: 19.2&quot;, &quot;wt: 1.94&lt;br&gt;mpg: 27.3&quot;, &quot;wt: 2.14&lt;br&gt;mpg: 26&quot;, &quot;wt: 1.51&lt;br&gt;mpg: 30.4&quot;, &quot;wt: 3.17&lt;br&gt;mpg: 15.8&quot;, &quot;wt: 2.77&lt;br&gt;mpg: 19.7&quot;, &quot;wt: 3.57&lt;br&gt;mpg: 15&quot;, &quot;wt: 2.78&lt;br&gt;mpg: 21.4&quot;], ## &quot;key&quot;: null, ## &quot;type&quot;: &quot;scatter&quot;, ## &quot;mode&quot;: &quot;markers&quot;, ## &quot;marker&quot;: { ## &quot;autocolorscale&quot;: false, ## &quot;color&quot;: &quot;rgba(0,0,0,1)&quot;, ## &quot;opacity&quot;: 1, ## &quot;size&quot;: 5.66929133858268, ## &quot;symbol&quot;: &quot;circle&quot;, ## &quot;line&quot;: { ## &quot;width&quot;: 1.88976377952756, ## &quot;color&quot;: &quot;rgba(0,0,0,1)&quot; ## } ## }, ## &quot;hoveron&quot;: &quot;points&quot;, ## &quot;showlegend&quot;: false, ## &quot;xaxis&quot;: &quot;x&quot;, ## &quot;yaxis&quot;: &quot;y&quot;, ## &quot;hoverinfo&quot;: &quot;text&quot;, ## &quot;name&quot;: &quot;&quot; ## }, ## { ## &quot;x&quot;: [1.513, 1.56250632911392, 1.61201265822785, 1.66151898734177, 1.7110253164557, 1.76053164556962, 1.81003797468354, 1.85954430379747, 1.90905063291139, 1.95855696202532, 2.00806329113924, 2.05756962025316, 2.10707594936709, 2.15658227848101, 2.20608860759494, 2.25559493670886, 2.30510126582278, 2.35460759493671, 2.40411392405063, 2.45362025316456, 2.50312658227848, 2.55263291139241, 2.60213924050633, 2.65164556962025, 2.70115189873418, 2.7506582278481, 2.80016455696203, 2.84967088607595, 2.89917721518987, 2.9486835443038, 2.99818987341772, 3.04769620253165, 3.09720253164557, 3.14670886075949, 3.19621518987342, 3.24572151898734, 3.29522784810127, 3.34473417721519, 3.39424050632911, 3.44374683544304, 3.49325316455696, 3.54275949367089, 3.59226582278481, 3.64177215189873, 3.69127848101266, 3.74078481012658, 3.79029113924051, 3.83979746835443, 3.88930379746835, 3.93881012658228, 3.9883164556962, 4.03782278481013, 4.08732911392405, 4.13683544303798, 4.1863417721519, 4.23584810126582, 4.28535443037975, 4.33486075949367, 4.3843670886076, 4.43387341772152, 4.48337974683544, 4.53288607594937, 4.58239240506329, 4.63189873417722, 4.68140506329114, 4.73091139240506, 4.78041772151899, 4.82992405063291, 4.87943037974684, 4.92893670886076, 4.97844303797468, 5.02794936708861, 5.07745569620253, 5.12696202531646, 5.17646835443038, 5.2259746835443, 5.27548101265823, 5.32498734177215, 5.37449367088608, 5.424], ## &quot;y&quot;: [32.08897233857, 31.6878645869701, 31.2816303797919, 30.8703709543688, 30.4541875480347, 30.0331813981232, 29.6074537419678, 29.1771058169022, 28.7422388602601, 28.3001719301537, 27.834621969428, 27.3476575600419, 26.84497968394, 26.3322893230667, 25.8152874593666, 25.2996750747841, 24.7911531512637, 24.29542267075, 23.8181846151875, 23.3651399665205, 22.955253039598, 22.6138488714952, 22.3275852300224, 22.0817586181852, 21.8616655389892, 21.65260249544, 21.4398659905432, 21.2087525273044, 20.953335722037, 20.7158424594628, 20.4957065225374, 20.2829337645837, 20.0675300389245, 19.8395011988825, 19.5888530977805, 19.2971559094315, 18.9444093670088, 18.5670026794964, 18.2056968860288, 17.9009022641924, 17.620602502374, 17.3400153015964, 17.079077805285, 16.8175887231322, 16.5575726926136, 16.3083303048321, 16.0791621508901, 15.8793688218903, 15.7018119854881, 15.5259429561214, 15.3517253848296, 15.1793328075288, 15.0089387601353, 14.8407167785652, 14.6748403987346, 14.5114831565596, 14.3508185879563, 14.193020228841, 14.0382616151298, 13.8867162827388, 13.7385577675841, 13.5939596055819, 13.4530953326483, 13.3161384846995, 13.1832625976516, 13.0546412074207, 12.930447849923, 12.8108560610747, 12.6960393767918, 12.5861713329905, 12.4814254655869, 12.3819753104973, 12.2879944036376, 12.1996562809241, 12.117134478273, 12.0406025316002, 11.9702339768221, 11.9062023498547, 11.8486811866141, 11.7978440230166], ## &quot;text&quot;: [&quot;wt: 1.51&lt;br&gt;mpg: 32.09&quot;, &quot;wt: 1.56&lt;br&gt;mpg: 31.69&quot;, &quot;wt: 1.61&lt;br&gt;mpg: 31.28&quot;, &quot;wt: 1.66&lt;br&gt;mpg: 30.87&quot;, &quot;wt: 1.71&lt;br&gt;mpg: 30.45&quot;, &quot;wt: 1.76&lt;br&gt;mpg: 30.03&quot;, &quot;wt: 1.81&lt;br&gt;mpg: 29.61&quot;, &quot;wt: 1.86&lt;br&gt;mpg: 29.18&quot;, &quot;wt: 1.91&lt;br&gt;mpg: 28.74&quot;, &quot;wt: 1.96&lt;br&gt;mpg: 28.3&quot;, &quot;wt: 2.01&lt;br&gt;mpg: 27.83&quot;, &quot;wt: 2.06&lt;br&gt;mpg: 27.35&quot;, &quot;wt: 2.11&lt;br&gt;mpg: 26.84&quot;, &quot;wt: 2.16&lt;br&gt;mpg: 26.33&quot;, &quot;wt: 2.21&lt;br&gt;mpg: 25.82&quot;, &quot;wt: 2.26&lt;br&gt;mpg: 25.3&quot;, &quot;wt: 2.31&lt;br&gt;mpg: 24.79&quot;, &quot;wt: 2.35&lt;br&gt;mpg: 24.3&quot;, &quot;wt: 2.4&lt;br&gt;mpg: 23.82&quot;, &quot;wt: 2.45&lt;br&gt;mpg: 23.37&quot;, &quot;wt: 2.5&lt;br&gt;mpg: 22.96&quot;, &quot;wt: 2.55&lt;br&gt;mpg: 22.61&quot;, &quot;wt: 2.6&lt;br&gt;mpg: 22.33&quot;, &quot;wt: 2.65&lt;br&gt;mpg: 22.08&quot;, &quot;wt: 2.7&lt;br&gt;mpg: 21.86&quot;, &quot;wt: 2.75&lt;br&gt;mpg: 21.65&quot;, &quot;wt: 2.8&lt;br&gt;mpg: 21.44&quot;, &quot;wt: 2.85&lt;br&gt;mpg: 21.21&quot;, &quot;wt: 2.9&lt;br&gt;mpg: 20.95&quot;, &quot;wt: 2.95&lt;br&gt;mpg: 20.72&quot;, &quot;wt: 3&lt;br&gt;mpg: 20.5&quot;, &quot;wt: 3.05&lt;br&gt;mpg: 20.28&quot;, &quot;wt: 3.1&lt;br&gt;mpg: 20.07&quot;, &quot;wt: 3.15&lt;br&gt;mpg: 19.84&quot;, &quot;wt: 3.2&lt;br&gt;mpg: 19.59&quot;, &quot;wt: 3.25&lt;br&gt;mpg: 19.3&quot;, &quot;wt: 3.3&lt;br&gt;mpg: 18.94&quot;, &quot;wt: 3.34&lt;br&gt;mpg: 18.57&quot;, &quot;wt: 3.39&lt;br&gt;mpg: 18.21&quot;, &quot;wt: 3.44&lt;br&gt;mpg: 17.9&quot;, &quot;wt: 3.49&lt;br&gt;mpg: 17.62&quot;, &quot;wt: 3.54&lt;br&gt;mpg: 17.34&quot;, &quot;wt: 3.59&lt;br&gt;mpg: 17.08&quot;, &quot;wt: 3.64&lt;br&gt;mpg: 16.82&quot;, &quot;wt: 3.69&lt;br&gt;mpg: 16.56&quot;, &quot;wt: 3.74&lt;br&gt;mpg: 16.31&quot;, &quot;wt: 3.79&lt;br&gt;mpg: 16.08&quot;, &quot;wt: 3.84&lt;br&gt;mpg: 15.88&quot;, &quot;wt: 3.89&lt;br&gt;mpg: 15.7&quot;, &quot;wt: 3.94&lt;br&gt;mpg: 15.53&quot;, &quot;wt: 3.99&lt;br&gt;mpg: 15.35&quot;, &quot;wt: 4.04&lt;br&gt;mpg: 15.18&quot;, &quot;wt: 4.09&lt;br&gt;mpg: 15.01&quot;, &quot;wt: 4.14&lt;br&gt;mpg: 14.84&quot;, &quot;wt: 4.19&lt;br&gt;mpg: 14.67&quot;, &quot;wt: 4.24&lt;br&gt;mpg: 14.51&quot;, &quot;wt: 4.29&lt;br&gt;mpg: 14.35&quot;, &quot;wt: 4.33&lt;br&gt;mpg: 14.19&quot;, &quot;wt: 4.38&lt;br&gt;mpg: 14.04&quot;, &quot;wt: 4.43&lt;br&gt;mpg: 13.89&quot;, &quot;wt: 4.48&lt;br&gt;mpg: 13.74&quot;, &quot;wt: 4.53&lt;br&gt;mpg: 13.59&quot;, &quot;wt: 4.58&lt;br&gt;mpg: 13.45&quot;, &quot;wt: 4.63&lt;br&gt;mpg: 13.32&quot;, &quot;wt: 4.68&lt;br&gt;mpg: 13.18&quot;, &quot;wt: 4.73&lt;br&gt;mpg: 13.05&quot;, &quot;wt: 4.78&lt;br&gt;mpg: 12.93&quot;, &quot;wt: 4.83&lt;br&gt;mpg: 12.81&quot;, &quot;wt: 4.88&lt;br&gt;mpg: 12.7&quot;, &quot;wt: 4.93&lt;br&gt;mpg: 12.59&quot;, &quot;wt: 4.98&lt;br&gt;mpg: 12.48&quot;, &quot;wt: 5.03&lt;br&gt;mpg: 12.38&quot;, &quot;wt: 5.08&lt;br&gt;mpg: 12.29&quot;, &quot;wt: 5.13&lt;br&gt;mpg: 12.2&quot;, &quot;wt: 5.18&lt;br&gt;mpg: 12.12&quot;, &quot;wt: 5.23&lt;br&gt;mpg: 12.04&quot;, &quot;wt: 5.28&lt;br&gt;mpg: 11.97&quot;, &quot;wt: 5.32&lt;br&gt;mpg: 11.91&quot;, &quot;wt: 5.37&lt;br&gt;mpg: 11.85&quot;, &quot;wt: 5.42&lt;br&gt;mpg: 11.8&quot;], ## &quot;key&quot;: null, ## &quot;type&quot;: &quot;scatter&quot;, ## &quot;mode&quot;: &quot;lines&quot;, ## &quot;name&quot;: &quot;fitted values&quot;, ## &quot;line&quot;: { ## &quot;width&quot;: 3.77952755905512, ## &quot;color&quot;: &quot;rgba(51,102,255,1)&quot;, ## &quot;dash&quot;: &quot;solid&quot; ## }, ## &quot;hoveron&quot;: &quot;points&quot;, ## &quot;showlegend&quot;: false, ## &quot;xaxis&quot;: &quot;x&quot;, ## &quot;yaxis&quot;: &quot;y&quot;, ## &quot;hoverinfo&quot;: &quot;text&quot; ## }, ## { ## &quot;x&quot;: [1.513, 1.56250632911392, 1.61201265822785, 1.66151898734177, 1.7110253164557, 1.76053164556962, 1.81003797468354, 1.85954430379747, 1.90905063291139, 1.95855696202532, 2.00806329113924, 2.05756962025316, 2.10707594936709, 2.15658227848101, 2.20608860759494, 2.25559493670886, 2.30510126582278, 2.35460759493671, 2.40411392405063, 2.45362025316456, 2.50312658227848, 2.55263291139241, 2.60213924050633, 2.65164556962025, 2.70115189873418, 2.7506582278481, 2.80016455696203, 2.84967088607595, 2.89917721518987, 2.9486835443038, 2.99818987341772, 3.04769620253165, 3.09720253164557, 3.14670886075949, 3.19621518987342, 3.24572151898734, 3.29522784810127, 3.34473417721519, 3.39424050632911, 3.44374683544304, 3.49325316455696, 3.54275949367089, 3.59226582278481, 3.64177215189873, 3.69127848101266, 3.74078481012658, 3.79029113924051, 3.83979746835443, 3.88930379746835, 3.93881012658228, 3.9883164556962, 4.03782278481013, 4.08732911392405, 4.13683544303798, 4.1863417721519, 4.23584810126582, 4.28535443037975, 4.33486075949367, 4.3843670886076, 4.43387341772152, 4.48337974683544, 4.53288607594937, 4.58239240506329, 4.63189873417722, 4.68140506329114, 4.73091139240506, 4.78041772151899, 4.82992405063291, 4.87943037974684, 4.92893670886076, 4.97844303797468, 5.02794936708861, 5.07745569620253, 5.12696202531646, 5.17646835443038, 5.2259746835443, 5.27548101265823, 5.32498734177215, 5.37449367088608, 5.424, 5.424, 5.424, 5.37449367088608, 5.32498734177215, 5.27548101265823, 5.2259746835443, 5.17646835443038, 5.12696202531646, 5.07745569620253, 5.02794936708861, 4.97844303797468, 4.92893670886076, 4.87943037974684, 4.82992405063291, 4.78041772151899, 4.73091139240506, 4.68140506329114, 4.63189873417722, 4.58239240506329, 4.53288607594937, 4.48337974683544, 4.43387341772152, 4.3843670886076, 4.33486075949367, 4.28535443037975, 4.23584810126582, 4.1863417721519, 4.13683544303798, 4.08732911392405, 4.03782278481013, 3.9883164556962, 3.93881012658228, 3.88930379746835, 3.83979746835443, 3.79029113924051, 3.74078481012658, 3.69127848101266, 3.64177215189873, 3.59226582278481, 3.54275949367089, 3.49325316455696, 3.44374683544304, 3.39424050632911, 3.34473417721519, 3.29522784810127, 3.24572151898734, 3.19621518987342, 3.14670886075949, 3.09720253164557, 3.04769620253165, 2.99818987341772, 2.9486835443038, 2.89917721518987, 2.84967088607595, 2.80016455696203, 2.7506582278481, 2.70115189873418, 2.65164556962025, 2.60213924050633, 2.55263291139241, 2.50312658227848, 2.45362025316456, 2.40411392405063, 2.35460759493671, 2.30510126582278, 2.25559493670886, 2.20608860759494, 2.15658227848101, 2.10707594936709, 2.05756962025316, 2.00806329113924, 1.95855696202532, 1.90905063291139, 1.85954430379747, 1.81003797468354, 1.76053164556962, 1.7110253164557, 1.66151898734177, 1.61201265822785, 1.56250632911392, 1.513, 1.513], ## &quot;y&quot;: [28.1482086220996, 28.1543901127744, 28.1099674436912, 28.0124927543079, 27.8597327000998, 27.65029180851, 27.3844510391609, 27.0649645489388, 26.6973896057635, 26.2875171160579, 25.8324317349282, 25.3425270424539, 24.8283183379919, 24.2983639184935, 23.760112467877, 23.2206139894969, 22.687036670636, 22.1669802400544, 21.6686013586079, 21.2005795966642, 20.7958707916955, 20.4925717120642, 20.2505759220062, 20.029411327989, 19.7997196881028, 19.5493238069997, 19.2825463474608, 19.0136396315242, 18.7710547647632, 18.6211620442909, 18.5230794674341, 18.4189767758076, 18.2669703402974, 18.0571226848891, 17.8114857990939, 17.5530651234175, 17.2593882498087, 16.9389000862352, 16.6206523252766, 16.3538304090665, 16.1088696663206, 15.8521950118163, 15.5982657057393, 15.310315393258, 14.9820175870996, 14.6192730587362, 14.2305037174933, 13.8250338832656, 13.4106256557153, 12.9994899989408, 12.6032526728482, 12.2284161008376, 11.878558950985, 11.5555601503064, 11.2602695449179, 10.9928832380879, 10.7531583791314, 10.5405374596263, 10.3542190987777, 10.1931951633603, 10.0562649052018, 9.94203169291403, 9.84888494120486, 9.77496807618837, 9.71813244341526, 9.67587696866419, 9.64527447672617, 9.62288862080818, 9.60469153661199, 9.58600284245437, 9.56148555087706, 9.52525005390405, 9.47112215607742, 9.39310561955942, 9.28599841671342, 9.14602153848871, 8.97125544941046, 8.76172457616168, 8.5191180560953, 8.24628312123558, 8.24628312123558, 15.3494049247976, 15.1782443171329, 15.0506801235477, 14.9692125042337, 14.9351835247118, 14.9482705398325, 15.0062069422889, 15.1048666511978, 15.2387005670905, 15.4013653802968, 15.5863398235266, 15.7873872169716, 15.9988235013412, 16.2156212231199, 16.4334054461773, 16.6483927518879, 16.8573088932106, 17.0573057240918, 17.2458875182498, 17.4208506299664, 17.5802374021172, 17.722304131482, 17.8455029980558, 17.9484787967813, 18.0300830750312, 18.0894112525512, 18.1258734068239, 18.1393185692856, 18.1302495142201, 18.1001980968109, 18.052395913302, 17.992998315261, 17.9337037605149, 17.9278205842869, 17.997387550928, 18.1331277981277, 18.3248620530063, 18.5598899048308, 18.8278355913766, 19.1323353384275, 19.4479741193182, 19.7907414467811, 20.1951052727576, 20.6294304842089, 21.0412466954455, 21.3662203964672, 21.621879712876, 21.8680897375516, 22.1468907533599, 22.4683335776407, 22.8105228746346, 23.1356166793108, 23.4038654230847, 23.5971856336257, 23.7558811838804, 23.9236113898757, 24.1341059083815, 24.4045945380386, 24.7351260309263, 25.1146352875006, 25.5297003363769, 25.967767871767, 26.4238651014456, 26.8952696318915, 27.3787361600713, 27.8704624508562, 28.36621472764, 28.8616410298881, 29.3527880776299, 29.8368122039277, 30.3128267442494, 30.7870881147566, 31.2892470848656, 31.8304564447746, 32.4160709877363, 33.0486423959696, 33.7282491544298, 34.4532933158925, 35.2213390611659, 36.0297360550404, 28.1482086220996], ## &quot;text&quot;: [&quot;wt: 1.51&lt;br&gt;mpg: 32.09&quot;, &quot;wt: 1.56&lt;br&gt;mpg: 31.69&quot;, &quot;wt: 1.61&lt;br&gt;mpg: 31.28&quot;, &quot;wt: 1.66&lt;br&gt;mpg: 30.87&quot;, &quot;wt: 1.71&lt;br&gt;mpg: 30.45&quot;, &quot;wt: 1.76&lt;br&gt;mpg: 30.03&quot;, &quot;wt: 1.81&lt;br&gt;mpg: 29.61&quot;, &quot;wt: 1.86&lt;br&gt;mpg: 29.18&quot;, &quot;wt: 1.91&lt;br&gt;mpg: 28.74&quot;, &quot;wt: 1.96&lt;br&gt;mpg: 28.3&quot;, &quot;wt: 2.01&lt;br&gt;mpg: 27.83&quot;, &quot;wt: 2.06&lt;br&gt;mpg: 27.35&quot;, &quot;wt: 2.11&lt;br&gt;mpg: 26.84&quot;, &quot;wt: 2.16&lt;br&gt;mpg: 26.33&quot;, &quot;wt: 2.21&lt;br&gt;mpg: 25.82&quot;, &quot;wt: 2.26&lt;br&gt;mpg: 25.3&quot;, &quot;wt: 2.31&lt;br&gt;mpg: 24.79&quot;, &quot;wt: 2.35&lt;br&gt;mpg: 24.3&quot;, &quot;wt: 2.4&lt;br&gt;mpg: 23.82&quot;, &quot;wt: 2.45&lt;br&gt;mpg: 23.37&quot;, &quot;wt: 2.5&lt;br&gt;mpg: 22.96&quot;, &quot;wt: 2.55&lt;br&gt;mpg: 22.61&quot;, &quot;wt: 2.6&lt;br&gt;mpg: 22.33&quot;, &quot;wt: 2.65&lt;br&gt;mpg: 22.08&quot;, &quot;wt: 2.7&lt;br&gt;mpg: 21.86&quot;, &quot;wt: 2.75&lt;br&gt;mpg: 21.65&quot;, &quot;wt: 2.8&lt;br&gt;mpg: 21.44&quot;, &quot;wt: 2.85&lt;br&gt;mpg: 21.21&quot;, &quot;wt: 2.9&lt;br&gt;mpg: 20.95&quot;, &quot;wt: 2.95&lt;br&gt;mpg: 20.72&quot;, &quot;wt: 3&lt;br&gt;mpg: 20.5&quot;, &quot;wt: 3.05&lt;br&gt;mpg: 20.28&quot;, &quot;wt: 3.1&lt;br&gt;mpg: 20.07&quot;, &quot;wt: 3.15&lt;br&gt;mpg: 19.84&quot;, &quot;wt: 3.2&lt;br&gt;mpg: 19.59&quot;, &quot;wt: 3.25&lt;br&gt;mpg: 19.3&quot;, &quot;wt: 3.3&lt;br&gt;mpg: 18.94&quot;, &quot;wt: 3.34&lt;br&gt;mpg: 18.57&quot;, &quot;wt: 3.39&lt;br&gt;mpg: 18.21&quot;, &quot;wt: 3.44&lt;br&gt;mpg: 17.9&quot;, &quot;wt: 3.49&lt;br&gt;mpg: 17.62&quot;, &quot;wt: 3.54&lt;br&gt;mpg: 17.34&quot;, &quot;wt: 3.59&lt;br&gt;mpg: 17.08&quot;, &quot;wt: 3.64&lt;br&gt;mpg: 16.82&quot;, &quot;wt: 3.69&lt;br&gt;mpg: 16.56&quot;, &quot;wt: 3.74&lt;br&gt;mpg: 16.31&quot;, &quot;wt: 3.79&lt;br&gt;mpg: 16.08&quot;, &quot;wt: 3.84&lt;br&gt;mpg: 15.88&quot;, &quot;wt: 3.89&lt;br&gt;mpg: 15.7&quot;, &quot;wt: 3.94&lt;br&gt;mpg: 15.53&quot;, &quot;wt: 3.99&lt;br&gt;mpg: 15.35&quot;, &quot;wt: 4.04&lt;br&gt;mpg: 15.18&quot;, &quot;wt: 4.09&lt;br&gt;mpg: 15.01&quot;, &quot;wt: 4.14&lt;br&gt;mpg: 14.84&quot;, &quot;wt: 4.19&lt;br&gt;mpg: 14.67&quot;, &quot;wt: 4.24&lt;br&gt;mpg: 14.51&quot;, &quot;wt: 4.29&lt;br&gt;mpg: 14.35&quot;, &quot;wt: 4.33&lt;br&gt;mpg: 14.19&quot;, &quot;wt: 4.38&lt;br&gt;mpg: 14.04&quot;, &quot;wt: 4.43&lt;br&gt;mpg: 13.89&quot;, &quot;wt: 4.48&lt;br&gt;mpg: 13.74&quot;, &quot;wt: 4.53&lt;br&gt;mpg: 13.59&quot;, &quot;wt: 4.58&lt;br&gt;mpg: 13.45&quot;, &quot;wt: 4.63&lt;br&gt;mpg: 13.32&quot;, &quot;wt: 4.68&lt;br&gt;mpg: 13.18&quot;, &quot;wt: 4.73&lt;br&gt;mpg: 13.05&quot;, &quot;wt: 4.78&lt;br&gt;mpg: 12.93&quot;, &quot;wt: 4.83&lt;br&gt;mpg: 12.81&quot;, &quot;wt: 4.88&lt;br&gt;mpg: 12.7&quot;, &quot;wt: 4.93&lt;br&gt;mpg: 12.59&quot;, &quot;wt: 4.98&lt;br&gt;mpg: 12.48&quot;, &quot;wt: 5.03&lt;br&gt;mpg: 12.38&quot;, &quot;wt: 5.08&lt;br&gt;mpg: 12.29&quot;, &quot;wt: 5.13&lt;br&gt;mpg: 12.2&quot;, &quot;wt: 5.18&lt;br&gt;mpg: 12.12&quot;, &quot;wt: 5.23&lt;br&gt;mpg: 12.04&quot;, &quot;wt: 5.28&lt;br&gt;mpg: 11.97&quot;, &quot;wt: 5.32&lt;br&gt;mpg: 11.91&quot;, &quot;wt: 5.37&lt;br&gt;mpg: 11.85&quot;, &quot;wt: 5.42&lt;br&gt;mpg: 11.8&quot;, &quot;wt: 5.42&lt;br&gt;mpg: 11.8&quot;, &quot;wt: 5.42&lt;br&gt;mpg: 11.8&quot;, &quot;wt: 5.37&lt;br&gt;mpg: 11.85&quot;, &quot;wt: 5.32&lt;br&gt;mpg: 11.91&quot;, &quot;wt: 5.28&lt;br&gt;mpg: 11.97&quot;, &quot;wt: 5.23&lt;br&gt;mpg: 12.04&quot;, &quot;wt: 5.18&lt;br&gt;mpg: 12.12&quot;, &quot;wt: 5.13&lt;br&gt;mpg: 12.2&quot;, &quot;wt: 5.08&lt;br&gt;mpg: 12.29&quot;, &quot;wt: 5.03&lt;br&gt;mpg: 12.38&quot;, &quot;wt: 4.98&lt;br&gt;mpg: 12.48&quot;, &quot;wt: 4.93&lt;br&gt;mpg: 12.59&quot;, &quot;wt: 4.88&lt;br&gt;mpg: 12.7&quot;, &quot;wt: 4.83&lt;br&gt;mpg: 12.81&quot;, &quot;wt: 4.78&lt;br&gt;mpg: 12.93&quot;, &quot;wt: 4.73&lt;br&gt;mpg: 13.05&quot;, &quot;wt: 4.68&lt;br&gt;mpg: 13.18&quot;, &quot;wt: 4.63&lt;br&gt;mpg: 13.32&quot;, &quot;wt: 4.58&lt;br&gt;mpg: 13.45&quot;, &quot;wt: 4.53&lt;br&gt;mpg: 13.59&quot;, &quot;wt: 4.48&lt;br&gt;mpg: 13.74&quot;, &quot;wt: 4.43&lt;br&gt;mpg: 13.89&quot;, &quot;wt: 4.38&lt;br&gt;mpg: 14.04&quot;, &quot;wt: 4.33&lt;br&gt;mpg: 14.19&quot;, &quot;wt: 4.29&lt;br&gt;mpg: 14.35&quot;, &quot;wt: 4.24&lt;br&gt;mpg: 14.51&quot;, &quot;wt: 4.19&lt;br&gt;mpg: 14.67&quot;, &quot;wt: 4.14&lt;br&gt;mpg: 14.84&quot;, &quot;wt: 4.09&lt;br&gt;mpg: 15.01&quot;, &quot;wt: 4.04&lt;br&gt;mpg: 15.18&quot;, &quot;wt: 3.99&lt;br&gt;mpg: 15.35&quot;, &quot;wt: 3.94&lt;br&gt;mpg: 15.53&quot;, &quot;wt: 3.89&lt;br&gt;mpg: 15.7&quot;, &quot;wt: 3.84&lt;br&gt;mpg: 15.88&quot;, &quot;wt: 3.79&lt;br&gt;mpg: 16.08&quot;, &quot;wt: 3.74&lt;br&gt;mpg: 16.31&quot;, &quot;wt: 3.69&lt;br&gt;mpg: 16.56&quot;, &quot;wt: 3.64&lt;br&gt;mpg: 16.82&quot;, &quot;wt: 3.59&lt;br&gt;mpg: 17.08&quot;, &quot;wt: 3.54&lt;br&gt;mpg: 17.34&quot;, &quot;wt: 3.49&lt;br&gt;mpg: 17.62&quot;, &quot;wt: 3.44&lt;br&gt;mpg: 17.9&quot;, &quot;wt: 3.39&lt;br&gt;mpg: 18.21&quot;, &quot;wt: 3.34&lt;br&gt;mpg: 18.57&quot;, &quot;wt: 3.3&lt;br&gt;mpg: 18.94&quot;, &quot;wt: 3.25&lt;br&gt;mpg: 19.3&quot;, &quot;wt: 3.2&lt;br&gt;mpg: 19.59&quot;, &quot;wt: 3.15&lt;br&gt;mpg: 19.84&quot;, &quot;wt: 3.1&lt;br&gt;mpg: 20.07&quot;, &quot;wt: 3.05&lt;br&gt;mpg: 20.28&quot;, &quot;wt: 3&lt;br&gt;mpg: 20.5&quot;, &quot;wt: 2.95&lt;br&gt;mpg: 20.72&quot;, &quot;wt: 2.9&lt;br&gt;mpg: 20.95&quot;, &quot;wt: 2.85&lt;br&gt;mpg: 21.21&quot;, &quot;wt: 2.8&lt;br&gt;mpg: 21.44&quot;, &quot;wt: 2.75&lt;br&gt;mpg: 21.65&quot;, &quot;wt: 2.7&lt;br&gt;mpg: 21.86&quot;, &quot;wt: 2.65&lt;br&gt;mpg: 22.08&quot;, &quot;wt: 2.6&lt;br&gt;mpg: 22.33&quot;, &quot;wt: 2.55&lt;br&gt;mpg: 22.61&quot;, &quot;wt: 2.5&lt;br&gt;mpg: 22.96&quot;, &quot;wt: 2.45&lt;br&gt;mpg: 23.37&quot;, &quot;wt: 2.4&lt;br&gt;mpg: 23.82&quot;, &quot;wt: 2.35&lt;br&gt;mpg: 24.3&quot;, &quot;wt: 2.31&lt;br&gt;mpg: 24.79&quot;, &quot;wt: 2.26&lt;br&gt;mpg: 25.3&quot;, &quot;wt: 2.21&lt;br&gt;mpg: 25.82&quot;, &quot;wt: 2.16&lt;br&gt;mpg: 26.33&quot;, &quot;wt: 2.11&lt;br&gt;mpg: 26.84&quot;, &quot;wt: 2.06&lt;br&gt;mpg: 27.35&quot;, &quot;wt: 2.01&lt;br&gt;mpg: 27.83&quot;, &quot;wt: 1.96&lt;br&gt;mpg: 28.3&quot;, &quot;wt: 1.91&lt;br&gt;mpg: 28.74&quot;, &quot;wt: 1.86&lt;br&gt;mpg: 29.18&quot;, &quot;wt: 1.81&lt;br&gt;mpg: 29.61&quot;, &quot;wt: 1.76&lt;br&gt;mpg: 30.03&quot;, &quot;wt: 1.71&lt;br&gt;mpg: 30.45&quot;, &quot;wt: 1.66&lt;br&gt;mpg: 30.87&quot;, &quot;wt: 1.61&lt;br&gt;mpg: 31.28&quot;, &quot;wt: 1.56&lt;br&gt;mpg: 31.69&quot;, &quot;wt: 1.51&lt;br&gt;mpg: 32.09&quot;, &quot;wt: 1.51&lt;br&gt;mpg: 32.09&quot;], ## &quot;key&quot;: null, ## &quot;type&quot;: &quot;scatter&quot;, ## &quot;mode&quot;: &quot;lines&quot;, ## &quot;line&quot;: { ## &quot;width&quot;: 3.77952755905512, ## &quot;color&quot;: &quot;transparent&quot;, ## &quot;dash&quot;: &quot;solid&quot; ## }, ## &quot;fill&quot;: &quot;toself&quot;, ## &quot;fillcolor&quot;: &quot;rgba(153,153,153,0.4)&quot;, ## &quot;hoveron&quot;: &quot;points&quot;, ## &quot;hoverinfo&quot;: &quot;x+y&quot;, ## &quot;showlegend&quot;: false, ## &quot;xaxis&quot;: &quot;x&quot;, ## &quot;yaxis&quot;: &quot;y&quot;, ## &quot;name&quot;: &quot;&quot; ## } ## ], ## &quot;layout&quot;: { ## &quot;margin&quot;: { ## &quot;t&quot;: 27.8219030308404, ## &quot;r&quot;: 7.30593607305936, ## &quot;b&quot;: 41.7762409303838, ## &quot;l&quot;: 37.2602739726027 ## }, ## &quot;plot_bgcolor&quot;: &quot;rgba(235,235,235,1)&quot;, ## &quot;paper_bgcolor&quot;: &quot;rgba(255,255,255,1)&quot;, ## &quot;font&quot;: { ## &quot;color&quot;: &quot;rgba(0,0,0,1)&quot;, ## &quot;family&quot;: &quot;&quot;, ## &quot;size&quot;: 14.6118721461187 ## }, ## &quot;xaxis&quot;: { ## &quot;type&quot;: &quot;linear&quot;, ## &quot;autorange&quot;: false, ## &quot;tickmode&quot;: &quot;array&quot;, ## &quot;range&quot;: [1.31745, 5.61955], ## &quot;ticktext&quot;: [&quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;], ## &quot;tickvals&quot;: [2, 3, 4, 5], ## &quot;ticks&quot;: &quot;outside&quot;, ## &quot;tickcolor&quot;: &quot;rgba(51,51,51,1)&quot;, ## &quot;ticklen&quot;: 3.65296803652968, ## &quot;tickwidth&quot;: 0.66417600664176, ## &quot;showticklabels&quot;: true, ## &quot;tickfont&quot;: { ## &quot;color&quot;: &quot;rgba(77,77,77,1)&quot;, ## &quot;family&quot;: &quot;&quot;, ## &quot;size&quot;: 11.689497716895 ## }, ## &quot;tickangle&quot;: -0, ## &quot;showline&quot;: false, ## &quot;linecolor&quot;: null, ## &quot;linewidth&quot;: 0, ## &quot;showgrid&quot;: true, ## &quot;domain&quot;: [0, 1], ## &quot;gridcolor&quot;: &quot;rgba(255,255,255,1)&quot;, ## &quot;gridwidth&quot;: 0.66417600664176, ## &quot;zeroline&quot;: false, ## &quot;anchor&quot;: &quot;y&quot;, ## &quot;title&quot;: &quot;wt&quot;, ## &quot;titlefont&quot;: { ## &quot;color&quot;: &quot;rgba(0,0,0,1)&quot;, ## &quot;family&quot;: &quot;&quot;, ## &quot;size&quot;: 14.6118721461187 ## }, ## &quot;hoverformat&quot;: &quot;.2f&quot; ## }, ## &quot;yaxis&quot;: { ## &quot;type&quot;: &quot;linear&quot;, ## &quot;autorange&quot;: false, ## &quot;tickmode&quot;: &quot;array&quot;, ## &quot;range&quot;: [6.85711047454534, 37.4189087017306], ## &quot;ticktext&quot;: [&quot;10&quot;, &quot;20&quot;, &quot;30&quot;], ## &quot;tickvals&quot;: [10, 20, 30], ## &quot;ticks&quot;: &quot;outside&quot;, ## &quot;tickcolor&quot;: &quot;rgba(51,51,51,1)&quot;, ## &quot;ticklen&quot;: 3.65296803652968, ## &quot;tickwidth&quot;: 0.66417600664176, ## &quot;showticklabels&quot;: true, ## &quot;tickfont&quot;: { ## &quot;color&quot;: &quot;rgba(77,77,77,1)&quot;, ## &quot;family&quot;: &quot;&quot;, ## &quot;size&quot;: 11.689497716895 ## }, ## &quot;tickangle&quot;: -0, ## &quot;showline&quot;: false, ## &quot;linecolor&quot;: null, ## &quot;linewidth&quot;: 0, ## &quot;showgrid&quot;: true, ## &quot;domain&quot;: [0, 1], ## &quot;gridcolor&quot;: &quot;rgba(255,255,255,1)&quot;, ## &quot;gridwidth&quot;: 0.66417600664176, ## &quot;zeroline&quot;: false, ## &quot;anchor&quot;: &quot;x&quot;, ## &quot;title&quot;: &quot;mpg&quot;, ## &quot;titlefont&quot;: { ## &quot;color&quot;: &quot;rgba(0,0,0,1)&quot;, ## &quot;family&quot;: &quot;&quot;, ## &quot;size&quot;: 14.6118721461187 ## }, ## &quot;hoverformat&quot;: &quot;.2f&quot; ## }, ## &quot;shapes&quot;: [ ## { ## &quot;type&quot;: &quot;rect&quot;, ## &quot;fillcolor&quot;: null, ## &quot;line&quot;: { ## &quot;color&quot;: null, ## &quot;width&quot;: 0, ## &quot;linetype&quot;: [] ## }, ## &quot;yref&quot;: &quot;paper&quot;, ## &quot;xref&quot;: &quot;paper&quot;, ## &quot;x0&quot;: 0, ## &quot;x1&quot;: 1, ## &quot;y0&quot;: 0, ## &quot;y1&quot;: 1 ## } ## ], ## &quot;showlegend&quot;: false, ## &quot;legend&quot;: { ## &quot;bgcolor&quot;: &quot;rgba(255,255,255,1)&quot;, ## &quot;bordercolor&quot;: &quot;transparent&quot;, ## &quot;borderwidth&quot;: 1.88976377952756, ## &quot;font&quot;: { ## &quot;color&quot;: &quot;rgba(0,0,0,1)&quot;, ## &quot;family&quot;: &quot;&quot;, ## &quot;size&quot;: 11.689497716895 ## } ## }, ## &quot;hovermode&quot;: &quot;closest&quot; ## }, ## &quot;source&quot;: &quot;A&quot;, ## &quot;cur_data&quot;: &quot;171a6e5a2f05&quot;, ## &quot;attrs&quot;: { ## &quot;171a6e5a2f05&quot;: { ## &quot;x&quot;: {}, ## &quot;y&quot;: {} ## } ## }, ## &quot;visdat&quot;: { ## &quot;171a6e5a2f05&quot;: [&quot;function () &quot;, &quot;dat&quot;] ## } ## } Say, for example, we’d like to display information when hovering over points, but not when hovering over the fitted values or error bounds. The ggplot2 API has no semantics for making this distinction, but this is easily done in plotly.js by setting the hoverinfo attribute to &quot;none&quot;. Since the fitted values or error bounds are contained in the second and third traces, we can hide the information on just these traces using the traces attribute in the style() function: style(p, hoverinfo = &quot;none&quot;, traces = 2:3) "],
["choosing-an-interface.html", "1.3 Choosing an interface", " 1.3 Choosing an interface ggplot2’s interface wasn’t designed for interactive graphics. Directly extending the grammar to support more advanced types of interaction (e.g., linked brushing) is a risky endeavor. ggplot2 requires data frame(s) and can be inefficient (especially for time series). ggplot2 does not have a functional interface (making it awkward to combine with modern functional interfaces such as dplyr), and does not satisfy referential transparency (making it easier to program with – for more details, see ) ggplotly() tries to replicate exactly what you see in the corresponding static ggplot2 graph. To do so, it sends axis tick information to plotly as tickvals/ticktext properties, and consequently, axis ticks do not update on zoom events. -->"],
["the-plotly-cookbook.html", "2 The plotly cookbook", " 2 The plotly cookbook This chapter demonstrates the capabilities of plot_ly() through a series of examples. In a nutshell, plot_ly() aims to: Provide sensible defaults/messages/warnings based on the information supplied, but still allows for full customization through plotly.js’ (the open source JavaScript graphing library which powers plotly) figure reference. Leverage useful concepts from the grammar of graphics (without requiring it to be used). "],
["scatterplots.html", "2.1 Scatterplots", " 2.1 Scatterplots Given a numeric variable(s) on x and y, plot_ly() defaults to a scatterplot subplot( plot_ly(mtcars, x = ~wt, y = ~mpg), plot_ly(mtcars, x = ~wt, y = ~mpg, color = ~disp), plot_ly(mtcars, x = ~wt, y = ~mpg, color = ~factor(vs)) ) "],
["smart-defaults-messages-warnings-errors.html", "2.2 Smart defaults, messages, warnings, errors", " 2.2 Smart defaults, messages, warnings, errors If no visualization type is specified, plot_ly() infers a sensible type based on the information provided. In this case, a numeric matrix (named volcano) is mapped to the z attribute, so a heatmap is a sensible default. library(plotly) str(volcano) ## num [1:87, 1:61] 100 101 102 103 104 105 105 106 107 108 ... plot_ly(z = ~volcano) ## No trace type specified: ## Based on info supplied, a &#39;heatmap&#39; trace seems appropriate. ## Read more about this trace type -&gt; https://plot.ly/r/reference/#heatmap A heatmap is not the only way to visualize a numeric matrix. Since plot_ly() only initializes a plotly object, we can change the default visualization type using any of the add_*() functions: add_surface(plot_ly(z = ~volcano)) There are a number of add_*() functions, for a number "],
["functional-interface.html", "2.3 Functional interface", " 2.3 Functional interface Plotly’s R package has a functional interface: every function takes a plotly object as it’s first input argument and returns a modified plotly object. To make code more readable, plotly re-exports the pipe operator (%&gt;%) from the magrittr package. The pipe operator takes the object on the left-hand side and injects it into the first argument (by default) of the function on the right-hand side. This allows us to read code from left to right instead of inside out. # these two lines of code are equivalent, but the second is easier to read plotly_POST(add_surface(plot_ly(z = ~volcano))) plot_ly(z = ~volcano) %&gt;% add_surface() %&gt;% plotly_POST() plot_ly(diamonds, x = ~cut) plot_ly(diamonds, y = ~cut) To create a plotly visualization, start with plot_ly(). library(plotly) plot_ly(economics, x = ~date, y = ~unemploy / pop) A plotly visualization is composed of one (or more) trace(s), and every trace has a type (the default type is ‘scatter’). The arguments/properties that a trace will respect (documented here) depend on it’s type. A scatter trace respects mode, which can be any combination of “lines”, “markers”, “text” joined with a “+”: library(plotly) plot_ly(economics, x = ~date, y = ~unemploy / pop, type = &quot;scatter&quot;, mode = &quot;markers+lines&quot;) You can manually add a trace to an existing plot with add_trace(). In that case, you’ll want to either name your traces, or hide the legend by setting showlegend = FALSE m &lt;- loess(unemploy / pop ~ as.numeric(date), data = economics) p &lt;- plot_ly(economics, x = ~date, y = ~unemploy / pop, name = &quot;raw&quot;) add_lines(p, y = ~fitted(m), name = &quot;loess&quot;) plotly was designed with a pure, predictable, and pipeable interface in mind, so you can also use the %&gt;% operator to create a visualization pipeline: economics %&gt;% plot_ly(x = ~date, y = ~unemploy / pop) %&gt;% add_lines(y = ~fitted(m)) %&gt;% layout(showlegend = F) TODO: talk about dplyr verbs! library(dplyr) economics %&gt;% mutate(rate = unemploy / pop) %&gt;% plot_ly(x = ~date, y = ~rate) %&gt;% filter(rate == max(rate)) %&gt;% layout( showlegend = F, annotations = list(x = ~date, y = ~rate, text = &quot;Peak&quot;, showarrow = T) ) Although these functions output special “plotly data frames”, plot_ly() doesn’t require a data frame for input. This makes chart types that accept a z argument especially easy to use if you have a numeric matrix: s &lt;- plot_ly(z = volcano, type = &quot;surface&quot;) If you have a free plotly account, plotly_POST() makes it easy to host/share any plotly figure (click on the image below to see the interactive version). plotly_POST(s) https://plot.ly/~agvd/1794 "],
["special-arguments.html", "2.4 Special arguments", " 2.4 Special arguments The plotly function arguments used thus far are documented in the figure reference, but there are a handful of additional arguments not described in the reference that make common visualizations a bit easier. These arguments are very much inspired by the semantics of ggplot2’s qplot() in the sense that a scales are automatically applied these variables. 2.4.1 The color argument 2.4.1.1 Qualitative color mappings If a ordinal variable (aka a non-ordered factor variable) is assigned to color, then a qualitative color palette is used by default. plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, color = ~Species, mode = &quot;markers&quot;) If you want to change the default palette, it’s recommended that you provide a http://colorbrewer2.org qualitative pallette name (e.g., “Set1” or “Accent”) to the colors argument. plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, color = ~Species, colors = &quot;Set1&quot;, mode = &quot;markers&quot;) In this case, the palette consists of 9 colors and the default behavior is to pick colors that are furthest apart (“#E41A1C”, “#FF7F00”, and “#999999”). cols &lt;- RColorBrewer::brewer.pal(9, &quot;Set1&quot;) scales::show_col(cols) If you’d like more control over the mapping, you can provide a vector of colors (of appropriate length). cols &lt;- RColorBrewer::brewer.pal(nlevels(iris$Species), &quot;Set1&quot;) plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, color = ~Species, colors = cols, mode = &quot;markers&quot;) 2.4.1.2 Sequential color mappings If either a numeric or an ordered factor is mapped to color, plot_ly() applies a sequential color scale by default. plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, color = ~as.ordered(Species), mode = &quot;markers&quot;) In the case of continuous numeric variables, plot_ly() performs a linear mapping between the data and an interpolated color pallette. plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, color = ~Sepal.Length, mode = &quot;markers&quot;) The colors argument takes arbitrary color codes of arbitrary length. Here is how we could use it to replicate the default mapping in ggplot2. plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, color = ~Sepal.Length, colors = c(&quot;#132B43&quot;, &quot;#56B1F7&quot;), mode = &quot;markers&quot;) 2.4.1.3 Diverging color mappings To obtain a diverging color mapping, just provide a diverging palette to the colors argument. plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, color = ~Sepal.Length, colors = &quot;PuOr&quot;, mode = &quot;markers&quot;) 2.4.2 The symbol argument To encode values using symbols, use the symbol argument. plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, symbol = ~Species, mode = &quot;markers&quot;) To change the default symbols used, use the symbols argument. All the valid symbol types are listed here. plot_ly(iris, x = ~Petal.Length, y = ~Petal.Width, mode = &quot;markers&quot;, symbol = ~Species, symbols = c(&quot;cross&quot;, &quot;square&quot;, &quot;triangle-down&quot;)) -->"],
["subplot.html", "3 The subplot() function", " 3 The subplot() function The subplot() function provides a flexible interface for arranging multiple plotly plots in a single view. The simplest way to use it is to pass plotly visualizations directly to subplot(). library(plotly) p1 &lt;- plot_ly(economics, x = ~date, y = ~unemploy, name = &quot;unemploy&quot;) p2 &lt;- plot_ly(economics, x = ~date, y = ~uempmed, name = &quot;uempmed&quot;) subplot(p1, p2) Although subplot() accepts an arbitrary number of plot objects, passing a list of plots can save typing and redundant code when dealing with a large number of plots. To demonstrate, let’s create one time series for each variable in the economics dataset and share the x-axis so that zoom/pan events are synchronized across each series: vars &lt;- setdiff(names(economics), &quot;date&quot;) plots &lt;- lapply(vars, function(var) { plot_ly(x = economics$date, y = economics[[var]], name = var) }) subplot(plots, nrows = length(plots), shareX = TRUE, titleX = FALSE) Conceptually, subplot() provides a way to place a collection of plots into a table with a given number of rows and columns. The number of rows (and, by consequence, the number of columns) is specified via the nrows argument. By default each row/column shares an equal proportion of the overall height/width, but as shown in the diagram below, that default can be changed via the heights and widths arguments. This flexibility is quite useful for a number of visualizations, for example, a joint density plot (the new heatmaply package is another good example). x &lt;- rnorm(100) y &lt;- rnorm(100) m &lt;- list(color = &quot;black&quot;) s &lt;- subplot( plot_ly(x = x, type = &quot;histogram&quot;, marker = m), plotly_empty(), plot_ly(x = x, y = y, mode = &quot;markers&quot;, marker = m), plot_ly(y = y, type = &quot;histogram&quot;, marker = m), nrows = 2, heights = c(0.2, 0.8), widths = c(0.8, 0.2), shareX = TRUE, shareY = TRUE, titleX = FALSE, titleY = FALSE ) layout(s, showlegend = FALSE) Note that, since subplot() returns a plotly object, any layout attribute can be modified downstream via layout(). "],
["recursive-subplots.html", "3.1 Recursive subplots", " 3.1 Recursive subplots The subplot() function is designed to work recursively so that you can have subplots of subplots. This idea is useful when your desired layout doesn’t conform to the table structure described in the previous section. In fact, you can think of a subplot of subplots like a spreadsheet with merged cells. plotList &lt;- function(nplots) { # TODO: use new images infrastructure to overlay an R image on each plot lapply(seq_len(nplots), function(x) plot_ly()) } s1 &lt;- subplot(plotList(6), nrows = 2, shareX = TRUE, shareY = TRUE) s2 &lt;- subplot(plotList(2), shareY = TRUE) subplot(s1, s2, plot_ly(), nrows = 3, margin = 0.04, heights = c(0.6, 0.3, 0.1)) The concept is particularly useful when you want plot(s) in a given row to have different widths from plot(s) in another row. # specify some map projection/options g &lt;- list( scope = &#39;usa&#39;, projection = list(type = &#39;albers usa&#39;), lakecolor = toRGB(&#39;white&#39;) ) # create a map of population density density &lt;- state.x77[, &quot;Population&quot;] / state.x77[, &quot;Area&quot;] map &lt;- plot_ly( z = ~density, text = state.name, locations = state.abb, type = &#39;choropleth&#39;, locationmode = &#39;USA-states&#39;, geo = &quot;geo&quot; ) %&gt;% layout(geo = g) # create a bunch of horizontal bar charts vars &lt;- colnames(state.x77) barcharts &lt;- lapply(vars, function(var) { plot_ly(x = state.x77[, var], y = state.name, type = &quot;bar&quot;, orientation = &quot;h&quot;, name = var) %&gt;% layout(showlegend = FALSE, hovermode = &quot;y&quot;, yaxis = list(showticklabels = FALSE)) }) subplot( subplot(barcharts, margin = 0.01), map, nrows = 2, heights = c(0.3, 0.7) ) "],
["ggplot2-subplots.html", "3.2 ggplot2 subplots", " 3.2 ggplot2 subplots The subplot() function also understands ggplot2 objects, and converts them to an interactive web-based version via ggplotly() before arranging them in the final layout. e &lt;- tidyr::gather(economics, variable, value, -date) gg1 &lt;- ggplot(e, aes(date, value)) + geom_line() + facet_wrap(~variable, scales = &quot;free_y&quot;, ncol = 1) gg2 &lt;- ggplot(e, aes(factor(1), value)) + geom_violin() + facet_wrap(~variable, scales = &quot;free_y&quot;, ncol = 1) + theme(axis.text = element_blank(), axis.ticks = element_blank()) subplot(gg1, gg2) %&gt;% layout(margin = list(l = 50)) This infrastructure allows ggplotly() to understand ggmatrix objects – the class of object returned by the ggpairs() function in the GGally package. pm &lt;- GGally::ggpairs(iris) ggplotly(pm) -->"],
["advanced-interactive-techniques.html", "4 Advanced interactive techniques", " 4 Advanced interactive techniques The code is this section is still under development and is likely to change. To run any of the code you see in this section, you’ll need this developmental version of the package: devtools::install_github(“ropensci/plotly#554”) As discussed in previous chapters, plotly graphs have zoom, pan, and identification type interactions enabled by default. This chapter will discuss ways we can enable other types of useful interactions listed in Table 4.1. Table 4.1: A taxonomy of interaction types Technique Related Questions Examples Identification What is this point/mark? Hover for additional info Zoom &amp; pan Is there local structure that can’t be viewed globally? Click &amp; drag to alter x/y axis limits Animation How does a distribution change over time? How does a fitted model look when projected into high-dimensional space? The grand tour Linked highlighting How does the marginal/joint compare to a conditional? Linked brushing on a scatterplot matrix Filter How does this subset compare to another? What happened during this time period? Click on legend entries shiny::selectInput() / shiny::sliderInput() "],
["highlighting.html", "4.1 Highlighting", " 4.1 Highlighting TODO: talk about how this improves the example in the first chapter library(plotly) library(crosstalk) d &lt;- SharedData$new(txhousing, ~city) p &lt;- ggplot(d, aes(date, median, group = city)) + geom_line(geom = &quot;line&quot;) ggplotly(p, tooltip = &quot;city&quot;) %&gt;% highlight(on = &quot;plotly_hover&quot;, color = &quot;red&quot;) TODO: Talk about the convenience of having “standard” events generated across chart types. When working with something like D3, you typically have to bind to DOM elements when attaching listeners, which does not generalize well. "],
["linked-highlighting.html", "4.2 Linked highlighting", " 4.2 Linked highlighting Linked highlighting between facets library(crosstalk) sd &lt;- SharedData$new(txhousing, ~year) p &lt;- ggplot(sd, aes(month, median)) + geom_line(aes(group = city)) + geom_smooth(method = &quot;gam&quot;) + facet_wrap(~ year) ggplotly(p) %&gt;% highlight(&quot;plotly_hover&quot;) TODO: show 06-plotly-pipeline.R example. Explain the importance of the pipeline. "],
["current-limitations.html", "4.3 Current limitations", " 4.3 Current limitations Currently not working with filled polygons (TODO: is this still true?) – https://github.com/plotly/plotly.js/issues/884 Currently not working with gl2d – https://github.com/plotly/plotly.js/issues/886 Currently leaflet is the only htmlwidget, with crosstalk support, that will respect non-default arguments in plotly’s highlight() function. -->"],
["animation.html", "5 Animation", " 5 Animation TODO: implement this! Do an example with touring "],
["shiny.html", "6 shiny", " 6 shiny "],
["accessing-plotly-js-events-in-r-without-shiny.html", "7 Accessing plotly.js events in R, without shiny", " 7 Accessing plotly.js events in R, without shiny Accessing plotly.js events in shiny is easy (for example), but shiny adds a lot of additional infrastructure that makes it hard to share your work, especially at scale. Very soon, plotly R users will have ways to perform highlighting and linked highlighting without shiny or any knowledge of HTML/JavaScript. However, if you do know some JavaScript, you can access (and respond to) plotly.js events without shiny, without having to leave the comfort of your R prompt, thanks to the onRender() function from the htmlwidgets package (Vaidyanathan et al. 2016). This function allows you to write a JavaScript function which will be invoked on the htmlwidget object after it is done rendering. This JavaScript function should have at least two arguments: (1) the DOM element containing the htmlwidget (el) and (2) the data passed from R (x). Here we use the onRender() function to send “event data” to the browser’s console upon hovering a point. library(plotly) library(htmlwidgets) plot_ly(mtcars, x = ~wt, y = ~mpg) %&gt;% onRender(&quot; function(el, x) { var gd = document.getElementById(el.id); gd.on(&#39;plotly_hover&#39;, function(pt) { console.log(&#39;hover&#39;, pt); }); } &quot;) "],
["plotly-interface-internals.html", "8 plotly interface internals", " 8 plotly interface internals This chapter describes some of the internals of the plotly package – specifically how it interfaces with the plotly.js graphing library. The plotly.js library (as with many other JavaScript graphing libraries) strives to describe any plot through a plot specification defined via JavaScript Object Notation (JSON). JSON is a language independent data-interchange format that was originally designed for JavaScript, but parsers for many different languages now exist, including R (Temple Lang 2014); (Ooms 2014). JSON is a recursive key-value data structure (similar to a list in R), and essentially any valid JavaScript value has a natural R equivalent (e.g., NULL/null). As a result, any JSON object can be created from an appropriate R list, meaning that theoretically any plotly.js plot can be described via an R list. The idea of interfacing R with JavaScript libraries via JSON data transfer has been popular way for quite some time (Vaidyanathan 2013); (???); (T. D. Hocking, VanderPlas, and Sievert 2015). The R package htmlwidgets standardized this bridge, and provides some additional infrastructure for making sure the HTML output works as expected in multiple contexts (in the R console or RStudio, within rmarkdown documents, and embedded inside shiny apps). The htmlwidgets also provides ways for both widget authors and users to extend the functionality of the underlying JavaScript library. In fact, the plotly package uses this mechanism to extend the plotly.js graphing library and enable all the material in Advanced interactive techniques. "],
["ensuring-type-safety-in-data-transfer.html", "8.1 Ensuring type safety in data transfer", " 8.1 Ensuring type safety in data transfer TODO: talk about using plotly.js plot schema for ensuring type safety, and throwing informative messages… "],
["plotly-object-representation.html", "8.2 plotly object representation", " 8.2 plotly object representation Inherits from an htmlwidget object Lazy evaluation of arguments "],
["miscellanous.html", "8.3 Miscellanous", " 8.3 Miscellanous Importance of generic functions for an extensible interface -->"],
["extending-ggplotly-and-plotly.html", "9 Extending ggplotly and plotly ", " 9 Extending ggplotly and plotly "],
["converting-custom-geoms.html", "9.1 Converting custom geoms", " 9.1 Converting custom geoms https://github.com/hrbrmstr/ggalt https://github.com/haleyjeppson/geom_mosaic "],
["wrappers-for-domain-specific-viz.html", "9.2 Wrappers for domain-specific viz", " 9.2 Wrappers for domain-specific viz https://github.com/talgalili/heatmaply https://github.com/natydasilva/PPforest -->"],
["references.html", "10 References", " 10 References Bache, Stefan Milton, and Hadley Wickham. 2014. Magrittr: A Forward-Pipe Operator for R. https://CRAN.R-project.org/package=magrittr. de Jong, Jos, and Kenton Russell. 2016. Listviewer: ’Htmlwidget’ for Interactive Views of R Lists. https://github.com/timelyportfolio/listviewer. Hocking, Toby Dylan, Susan VanderPlas, and Carson Sievert. 2015. Animint: Interactive Animations. Hyndman, Rob J. n.d. Forecast: Forecasting Functions for Time Series and Linear Models. http://github.com/robjhyndman/forecast. Ooms, Jeroen. 2014. “The Jsonlite Package: A Practical and Consistent Mapping Between Json Data and R Objects.” ArXiv:1403.2805 [Stat.CO]. http://arxiv.org/abs/1403.2805. Sievert, Carson, Chris Parmer, Toby Hocking, Scott Chamberlain, Karthik Ram, Marianne Corvellec, and Pedro Despouy. 2016. Plotly: Create Interactive Web Graphics via ’Plotly.js’. Temple Lang, Duncan. 2014. RJSONIO: Serialize R Objects to Json, Javascript Object Notation. http://CRAN.R-project.org/package=RJSONIO. Vaidyanathan, Ramnath. 2013. RCharts: Interactive Charts Using Javascript Visualization Libraries. https://github.com/ramnathv/rCharts/. Vaidyanathan, Ramnath, Yihui Xie, JJ Allaire, Joe Cheng, and Kenton Russell. 2016. Htmlwidgets: HTML Widgets for R. https://CRAN.R-project.org/package=htmlwidgets. Wickham, Hadley. 2009. Ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. http://ggplot2.org. ———. 2010. “A Layered Grammar of Graphics.” Journal of Computational and Graphical Statistics 19 (1): 3–28. ———. n.d. Tidyr: Easily Tidy Data with ‘Spread()‘ and ‘Gather()‘ Functions. https://github.com/hadley/tidyr. Wickham, Hadley, and Romain Francois. 2016. Dplyr: A Grammar of Data Manipulation. https://CRAN.R-project.org/package=dplyr. Wickham, Hadley, Michael Lawrence, Dianne Cook, Andreas Buja, Heike Hofmann, and Deborah F Swayne. 2010. “The Plumbing of Interactive Graphics.” Computational Statistics, April, 1–7. Wilkinson, Leland. 2005. The Grammar of Graphics (Statistics and Computing). Secaucus, NJ, USA: Springer-Verlag New York, Inc. William S. Cleveland, Robert McGill, Marylyn E. McGill. 1988. “The Shape Parameter of a Two-Variable Graph.” Journal of the American Statistical Association 83 (402). [American Statistical Association, Taylor &amp; Francis, Ltd.]: 289–300. http://www.jstor.org/stable/2288843. "]
]
