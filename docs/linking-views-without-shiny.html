<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>plotly for R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="An overview of the R package plotly">
  <meta name="generator" content="bookdown 0.1.14 and GitBook 2.6.7">

  <meta property="og:title" content="plotly for R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://ropensci.github.io/plotly/" />
  <meta property="og:image" content="http://ropensci.github.io/plotly/images/plotly.png" />
  <meta property="og:description" content="An overview of the R package plotly" />
  <meta name="github-repo" content="ropensci/plotly" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="plotly for R" />
  <meta name="twitter:site" content="@cpsievert" />
  <meta name="twitter:description" content="An overview of the R package plotly" />
  <meta name="twitter:image" content="http://ropensci.github.io/plotly/images/plotly.png" />

<meta name="author" content="Carson Sievert">

  


  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="linking-views-with-shiny.html">
<link rel="next" href="animating-views.html">

<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/plotlyjs/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs/plotly-latest.min.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/crosstalk/js/crosstalk.js"></script>
<link href="libs/jsoneditor/jsoneditor.min.css" rel="stylesheet" />
<script src="libs/jsoneditor/jsoneditor.min.js"></script>
<script src="libs/jsonedit-binding/jsonedit.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap/js/bootstrap.min.js"></script>
<script src="libs/bootstrap/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap/shim/respond.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/plotly.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">plotly for R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="get-started.html"><a href="get-started.html"><i class="fa fa-check"></i>Get started</a></li>
<li class="chapter" data-level="" data-path="plot-ly-for-collaboration.html"><a href="plot-ly-for-collaboration.html"><i class="fa fa-check"></i>plot.ly for collaboration</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="two-approaches-one-object.html"><a href="two-approaches-one-object.html"><i class="fa fa-check"></i><b>1</b> Two approaches, one object</a><ul>
<li class="chapter" data-level="1.1" data-path="a-case-study-of-housing-sales-in-texas.html"><a href="a-case-study-of-housing-sales-in-texas.html"><i class="fa fa-check"></i><b>1.1</b> A case study of housing sales in Texas</a><ul>
<li class="chapter" data-level="1.1.1" data-path="a-case-study-of-housing-sales-in-texas.html"><a href="a-case-study-of-housing-sales-in-texas.html#ggplotly"><i class="fa fa-check"></i><b>1.1.1</b> The <code>ggplotly()</code> function</a></li>
<li class="chapter" data-level="1.1.2" data-path="a-case-study-of-housing-sales-in-texas.html"><a href="a-case-study-of-housing-sales-in-texas.html#plot_ly"><i class="fa fa-check"></i><b>1.1.2</b> The <code>plot_ly()</code> interface</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="extending-ggplotly.html"><a href="extending-ggplotly.html"><i class="fa fa-check"></i><b>1.2</b> Extending <code>ggplotly()</code></a><ul>
<li class="chapter" data-level="1.2.1" data-path="extending-ggplotly.html"><a href="extending-ggplotly.html#customizing-the-layout"><i class="fa fa-check"></i><b>1.2.1</b> Customizing the layout</a></li>
<li class="chapter" data-level="1.2.2" data-path="extending-ggplotly.html"><a href="extending-ggplotly.html#adding-layers"><i class="fa fa-check"></i><b>1.2.2</b> Adding layers</a></li>
<li class="chapter" data-level="1.2.3" data-path="extending-ggplotly.html"><a href="extending-ggplotly.html#modifying-layers"><i class="fa fa-check"></i><b>1.2.3</b> Modifying layers</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="choosing-an-interface.html"><a href="choosing-an-interface.html"><i class="fa fa-check"></i><b>1.3</b> Choosing an interface</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-plotly-cookbook.html"><a href="the-plotly-cookbook.html"><i class="fa fa-check"></i><b>2</b> The plotly cookbook</a><ul>
<li class="chapter" data-level="2.1" data-path="scatter-traces.html"><a href="scatter-traces.html"><i class="fa fa-check"></i><b>2.1</b> Scatter traces</a><ul>
<li class="chapter" data-level="2.1.1" data-path="scatter-traces.html"><a href="scatter-traces.html#scatterplots"><i class="fa fa-check"></i><b>2.1.1</b> Scatterplots</a></li>
<li class="chapter" data-level="2.1.2" data-path="scatter-traces.html"><a href="scatter-traces.html#dotplots-error-bars"><i class="fa fa-check"></i><b>2.1.2</b> Dotplots &amp; error bars</a></li>
<li class="chapter" data-level="2.1.3" data-path="scatter-traces.html"><a href="scatter-traces.html#line-plots"><i class="fa fa-check"></i><b>2.1.3</b> Line plots</a></li>
<li class="chapter" data-level="2.1.4" data-path="scatter-traces.html"><a href="scatter-traces.html#segments"><i class="fa fa-check"></i><b>2.1.4</b> Segments</a></li>
<li class="chapter" data-level="2.1.5" data-path="scatter-traces.html"><a href="scatter-traces.html#ribbons"><i class="fa fa-check"></i><b>2.1.5</b> Ribbons</a></li>
<li class="chapter" data-level="2.1.6" data-path="scatter-traces.html"><a href="scatter-traces.html#polygons"><i class="fa fa-check"></i><b>2.1.6</b> Polygons</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>2.2</b> Maps</a><ul>
<li class="chapter" data-level="2.2.1" data-path="maps.html"><a href="maps.html#using-scatter-traces"><i class="fa fa-check"></i><b>2.2.1</b> Using scatter traces</a></li>
<li class="chapter" data-level="2.2.2" data-path="maps.html"><a href="maps.html#choropleths"><i class="fa fa-check"></i><b>2.2.2</b> Choropleths</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bars-histograms.html"><a href="bars-histograms.html"><i class="fa fa-check"></i><b>2.3</b> Bars &amp; histograms</a><ul>
<li class="chapter" data-level="2.3.1" data-path="bars-histograms.html"><a href="bars-histograms.html#multiple-numeric-distributions"><i class="fa fa-check"></i><b>2.3.1</b> Multiple numeric distributions</a></li>
<li class="chapter" data-level="2.3.2" data-path="bars-histograms.html"><a href="bars-histograms.html#multiple-discrete-distributions"><i class="fa fa-check"></i><b>2.3.2</b> Multiple discrete distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>2.4</b> Boxplots</a></li>
<li class="chapter" data-level="2.5" data-path="d-distributions.html"><a href="d-distributions.html"><i class="fa fa-check"></i><b>2.5</b> 2D distributions</a><ul>
<li class="chapter" data-level="2.5.1" data-path="d-distributions.html"><a href="d-distributions.html#rectangular-binning-in-plotly.js"><i class="fa fa-check"></i><b>2.5.1</b> Rectangular binning in plotly.js</a></li>
<li class="chapter" data-level="2.5.2" data-path="d-distributions.html"><a href="d-distributions.html#rectangular-binning-in-r"><i class="fa fa-check"></i><b>2.5.2</b> Rectangular binning in R</a></li>
<li class="chapter" data-level="2.5.3" data-path="d-distributions.html"><a href="d-distributions.html#basic-heatmaps"><i class="fa fa-check"></i><b>2.5.3</b> Basic heatmaps</a></li>
<li class="chapter" data-level="2.5.4" data-path="d-distributions.html"><a href="d-distributions.html#contours"><i class="fa fa-check"></i><b>2.5.4</b> Contours</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="d-plots.html"><a href="d-plots.html"><i class="fa fa-check"></i><b>2.6</b> 3D plots</a><ul>
<li class="chapter" data-level="2.6.1" data-path="d-plots.html"><a href="d-plots.html#surface"><i class="fa fa-check"></i><b>2.6.1</b> Surface</a></li>
<li class="chapter" data-level="2.6.2" data-path="d-plots.html"><a href="d-plots.html#mesh"><i class="fa fa-check"></i><b>2.6.2</b> Mesh</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="annotations.html"><a href="annotations.html"><i class="fa fa-check"></i><b>2.7</b> Annotations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="arranging-multiple-views.html"><a href="arranging-multiple-views.html"><i class="fa fa-check"></i><b>3</b> Arranging multiple views</a><ul>
<li class="chapter" data-level="3.1" data-path="arranging-htmlwidgets.html"><a href="arranging-htmlwidgets.html"><i class="fa fa-check"></i><b>3.1</b> Arranging htmlwidgets</a></li>
<li class="chapter" data-level="3.2" data-path="merging-plotly-objects.html"><a href="merging-plotly-objects.html"><i class="fa fa-check"></i><b>3.2</b> Merging plotly objects</a><ul>
<li class="chapter" data-level="3.2.1" data-path="merging-plotly-objects.html"><a href="merging-plotly-objects.html#recursive-subplots"><i class="fa fa-check"></i><b>3.2.1</b> Recursive subplots</a></li>
<li class="chapter" data-level="3.2.2" data-path="merging-plotly-objects.html"><a href="merging-plotly-objects.html#ggplot2-subplots"><i class="fa fa-check"></i><b>3.2.2</b> ggplot2 subplots</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="navigating-many-views.html"><a href="navigating-many-views.html"><i class="fa fa-check"></i><b>3.3</b> Navigating many views</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple-linked-views.html"><a href="multiple-linked-views.html"><i class="fa fa-check"></i><b>4</b> Multiple linked views</a><ul>
<li class="chapter" data-level="4.1" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html"><i class="fa fa-check"></i><b>4.1</b> Linking views with shiny</a><ul>
<li class="chapter" data-level="4.1.1" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#accessing-events-in-shiny"><i class="fa fa-check"></i><b>4.1.1</b> Accessing events in shiny</a></li>
<li class="chapter" data-level="4.1.2" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#updating-views"><i class="fa fa-check"></i><b>4.1.2</b> Updating views</a></li>
<li class="chapter" data-level="4.1.3" data-path="linking-views-with-shiny.html"><a href="linking-views-with-shiny.html#targeting-views"><i class="fa fa-check"></i><b>4.1.3</b> Targeting views</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html"><i class="fa fa-check"></i><b>4.2</b> Linking views without shiny</a><ul>
<li class="chapter" data-level="4.2.1" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html#motivating-examples"><i class="fa fa-check"></i><b>4.2.1</b> Motivating examples</a></li>
<li class="chapter" data-level="4.2.2" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html#transient-versus-persistent-selection"><i class="fa fa-check"></i><b>4.2.2</b> Transient versus persistent selection</a></li>
<li class="chapter" data-level="4.2.3" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html#linking-with-other-htmlwidgets"><i class="fa fa-check"></i><b>4.2.3</b> Linking with other htmlwidgets</a></li>
<li class="chapter" data-level="4.2.4" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html#the-shareddata-plot-pipeline"><i class="fa fa-check"></i><b>4.2.4</b> The SharedData plot pipeline</a></li>
<li class="chapter" data-level="4.2.5" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html#dynamic-aggregates"><i class="fa fa-check"></i><b>4.2.5</b> Dynamic aggregates</a></li>
<li class="chapter" data-level="4.2.6" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html#more-examples"><i class="fa fa-check"></i><b>4.2.6</b> More examples</a></li>
<li class="chapter" data-level="4.2.7" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html#custom-linking-via-javascript"><i class="fa fa-check"></i><b>4.2.7</b> Custom linking via JavaScript</a></li>
<li class="chapter" data-level="4.2.8" data-path="linking-views-without-shiny.html"><a href="linking-views-without-shiny.html#limitations"><i class="fa fa-check"></i><b>4.2.8</b> Limitations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="animating-views.html"><a href="animating-views.html"><i class="fa fa-check"></i><b>5</b> Animating views</a></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">plotly for R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linking-views-without-shiny" class="section level2">
<h2><span class="header-section-number">4.2</span> Linking views without shiny</h2>
<div class="rmdwarning">
<p>
The code is this section is still under development and is likely to change. To run any of the code you see in this section, you’ll need this developmental version of the package: <code>devtools::install_github(“ropensci/plotly#554”)</code>
</p>
</div>
<!-- TODO:
Explain again the importance of having standalone HTML?
-->
<div id="motivating-examples" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Motivating examples</h3>
<p>As shown in <a href="linking-views-with-shiny.html#linking-views-with-shiny">Linking views with shiny</a>, the <code>key</code> attribute provides a way to attach a key (i.e., ID) to graphical elements – an essential feature when making graphical queries. When linking views in <strong>plotly</strong> outside of <strong>shiny</strong>, the suggested way to attach a key to graphical elements is via the <code>SharedData</code> class from the <strong>crosstalk</strong> package <span class="citation">(Cheng <a href="references.html#ref-crosstalk">2016</a>)</span>. At the very least, the <code>new()</code> method for this class requires a data frame, and a key variable. Lets suppose we’re interested in making comparisons of housing sales across cities for a given year using the <code>txhousing</code> dataset. Given that interest, we may want to make graphical queries that condition on a year, so we start by creating a <code>SharedData</code> object with <code>year</code> as the shared key.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install_github(&quot;ropensci/crosstalk&quot;)</span>
<span class="kw">library</span>(crosstalk)
sd &lt;-<span class="st"> </span>SharedData$<span class="kw">new</span>(txhousing, ~year)</code></pre></div>
<p>As far as <code>ggplotly()</code> and <code>plot_ly()</code> are concerned, <code>SharedData</code> object(s) act just like a data frame, but with a special <code>key</code> attribute attached to graphical elements. Since both interfaces are based on <a href="a-case-study-of-housing-sales-in-texas.html#the-layered-grammar-of-graphics">the layered grammar of graphics</a>, <code>key</code> attributes can be attached at the layer level, and those attributes can also be shared across multiple views. Figure <a href="linking-views-without-shiny.html#fig:linked-panels">4.5</a> leverages both of these features to link multiple views of median house sales in various Texan cities. As the <a href="http://i.imgur.com/DdPdSBB.gif">video</a> shows, hovering over a line in any panel selects that particular year, and all corresponding panels update to highlight that year. The result is an incredibly powerful tool for quickly comparing house sale prices, not only across cities for a given year, but also across years for a given city.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sd, <span class="kw">aes</span>(month, median)) +
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> year)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">data =</span> txhousing, <span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(~<span class="st"> </span>city)

<span class="kw">ggplotly</span>(p, <span class="dt">tooltip =</span> <span class="st">&quot;year&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">highlight</span>(<span class="dt">on =</span> <span class="st">&quot;plotly_hover&quot;</span>, <span class="dt">defaultValues =</span> <span class="dv">2015</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:linked-panels"></span>
<img src="images/crosstalkLinkedPanels.gif" alt="Monthly median house sales by year and city. Each panel represents a city and panels are linked by year. A video demonstrating the graphical queries can be viewed [here](http://i.imgur.com/DdPdSBB.gif)" align:"center" />
<p class="caption">
Figure 4.5: Monthly median house sales by year and city. Each panel represents a city and panels are linked by year. A video demonstrating the graphical queries can be viewed <a href="http://i.imgur.com/DdPdSBB.gif">here</a>
</p>
</div>
<!-- TODO: talk more about the finding in the figure -->
<p>Figure <a href="linking-views-without-shiny.html#fig:linked-panels">4.5</a> uses the <code>highlight()</code> function from the <strong>plotly</strong> package to specify the type of plotly event for triggering a selection (via the <code>on</code> argument), the color of the selection (via the <code>color</code> argument), and set a default selection (via the <code>defaultValues</code> argument). The <code>off</code> argument controls the type of event that clears selections, and by default, is set to a <code>plotly_relayout</code> event, which can be triggered by clicking the home icon in the mode bar (or via zoom/pan). The <code>highlight()</code> function can also be used to control <a href="linking-views-without-shiny.html#transient-versus-persistent-selection">Transient versus persistent selection</a> modes, and dynamically control selection colors, which is very useful for making comparisons.</p>
<!--
TODO: Talk about the convenience of having "standard" events generated across chart types. When working with something like D3, you typically have to bind to DOM elements when attaching listeners, which does not generalize well.
-->
<p>Figure <a href="linking-views-without-shiny.html#fig:linked-ggally">4.6</a> shows another example of using <code>SharedData</code> objects to link multiple views, this time to enable linked brushing in a scatterplot matrix via the <code>ggpairs()</code> function from the <strong>GGally</strong> package. As discussed in <a href="scatter-traces.html#scatterplot-matrices">Scatterplot matrices</a>, the <code>ggpairs()</code> function implements the generalized pairs plot – a generalization of the scatterplot matrix – an incredibly useful tool for exploratory data analysis. Since the <code>Species</code> variable (as discrete variable) is mapped to colour in Figure <a href="linking-views-without-shiny.html#fig:linked-ggally">4.6</a>, we can inspect both correlations, and marginal densities, dependent upon Species type. By adding the brushing capabilities via <code>ggplotly()</code>, we add the ability to examine the dependence between a continuous conditional distribution and other variables. For this type of interaction, a unique key should be attached to each observation in the original data, which is the default behavior of the <code>SharedData</code> object’s <code>new()</code> method when no key is provided.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span>SharedData$<span class="kw">new</span>(iris)
p &lt;-<span class="st"> </span>GGally::<span class="kw">ggpairs</span>(d, <span class="kw">aes</span>(<span class="dt">color =</span> Species), <span class="dt">columns =</span> <span class="dv">1</span>:<span class="dv">4</span>)
<span class="kw">layout</span>(<span class="kw">ggplotly</span>(p), <span class="dt">dragmode =</span> <span class="st">&quot;select&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:linked-ggally"></span>
<img src="images/plotlyGGally.gif" alt="Brushing a scatterplot matrix via the `ggairs()` function in the **GGally** package. A video demonstrating the graphical queries can be viewed [here](http://i.imgur.com/dPTtH3H.gif)" align:"center" />
<p class="caption">
Figure 4.6: Brushing a scatterplot matrix via the <code>ggairs()</code> function in the <strong>GGally</strong> package. A video demonstrating the graphical queries can be viewed <a href="http://i.imgur.com/dPTtH3H.gif">here</a>
</p>
</div>
<p>When the graphical query is made is <a href="linking-views-without-shiny.html#fig:linked-ggally">4.6</a>, the marginal densities do not update. This points out one of the weaknesses of implementing multiple linked views without shiny (or some other R backend). The browser knows nothing about the algorithm <strong>GGally</strong> (or <strong>ggplot2</strong>) uses to compute a density, so updating the densities in a consistent way is not realistic without being able to call R from the browser. It is true that we could try to precompute densities for every possible selection state, but this does not generally scale well when the number of selection states is large, even as large as Figure <a href="linking-views-without-shiny.html#fig:linked-ggally">4.6</a>. As discussed briefly in <a href="bars-histograms.html#bars-histograms">bars &amp; histograms</a>, <a href="boxplots.html#boxplots">Boxplots</a>, and <a href="#2D-distributions">2D distributions</a>, plotly.js does have some statistical functionality that we can leverage to display <a href="linking-views-without-shiny.html#dynamic-aggregates">Dynamic aggregates</a>, but this currently covers only a few types of statistical displays.</p>
</div>
<div id="transient-versus-persistent-selection" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Transient versus persistent selection</h3>
<p>The examples in the previous section use transient selection – meaning that when a value is selected, previous selection(s) are forgotten. Sometimes it is more useful to allow selections to accumulate, a type of selection known as persistent selection. To demonstrate the difference, Figure <a href="linking-views-without-shiny.html#fig:persistent">4.7</a> presents two different takes a single view, one with transient selection (on the left) and one with persistent selection (on the right). Both selection modes can be used when linking multiple views, but as Figure <a href="linking-views-without-shiny.html#fig:persistent">4.7</a> shows, highlighting graphical elements, even in a single view, can be useful tool to avoid overplotting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd &lt;-<span class="st"> </span>SharedData$<span class="kw">new</span>(txhousing, ~city)
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(sd, <span class="kw">aes</span>(date, median)) +<span class="st"> </span><span class="kw">geom_line</span>()
gg &lt;-<span class="st"> </span><span class="kw">ggplotly</span>(p, <span class="dt">tooltip =</span> <span class="st">&quot;city&quot;</span>)

<span class="kw">highlight</span>(gg, <span class="dt">on =</span> <span class="st">&quot;plotly_hover&quot;</span>, <span class="dt">dynamic =</span> <span class="ot">TRUE</span>)
<span class="kw">highlight</span>(gg, <span class="dt">on =</span> <span class="st">&quot;plotly_hover&quot;</span>, <span class="dt">dynamic =</span> <span class="ot">TRUE</span>, <span class="dt">persistent =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">include_graphics</span>(<span class="st">&quot;images/transientVsPersist.gif&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:persistent"></span>
<img src="images/transientVsPersist.gif" alt="Highlighting lines with transient versus persistent selection. In the left hand panel, transient selection (the default); and in the right hand panel, persistent selection. The video may be accessed [here](http://i.imgur.com/WyBmdv3.gif)" align:"center" />
<p class="caption">
Figure 4.7: Highlighting lines with transient versus persistent selection. In the left hand panel, transient selection (the default); and in the right hand panel, persistent selection. The video may be accessed <a href="http://i.imgur.com/WyBmdv3.gif">here</a>
</p>
</div>
<p>Figure <a href="linking-views-without-shiny.html#fig:persistent">4.7</a> also sets the <code>dynamic</code> argument to <code>TRUE</code> to populate a widget, powered by the <strong>colourpicker</strong> package <span class="citation">(Attali <a href="references.html#ref-colourpicker">2016</a>)</span>, for dynamically altering the selection color. When paired with persistent selection, this makes for a powerful tool for making comparisons between two selection sets. For Figure <a href="linking-views-without-shiny.html#fig:persistent">4.7</a>, transient selection is probably the better mode for an initial look at the data (in particular, to help reveal any structure in missingness or anomalies), whereas persistent selection is better for making comparisons once have a better idea of what cities might be interesting to compare.</p>
</div>
<div id="linking-with-other-htmlwidgets" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Linking with other htmlwidgets</h3>
<p>Perhaps the most exciting thing about building a linked views framework on top of the <strong>crosstalk</strong> package is that it provides a standardized protocol for working with selections that other <strong>htmlwidget</strong> packages may build upon. If implemented carefully, this effectively provides a way to link views between two independent graphical systems – something that really has not been done in interactive statistical graphics. This grants a tremendous amount of power to the analyst since she/he may leverage the strengths of multiple systems in a single linked views analysis. Figure <a href="linking-views-without-shiny.html#fig:leaflet">4.8</a> shows an example of linked views between plotly and leaflet for exploring the relationship between the magnitude and geographic location of earthquakes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plotly)
<span class="kw">library</span>(leaflet)

sd &lt;-<span class="st"> </span>SharedData$<span class="kw">new</span>(quakes)

p &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(sd, <span class="dt">x =</span> ~depth, <span class="dt">y =</span> ~mag) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">add_markers</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) %&gt;%
<span class="st">  </span><span class="kw">layout</span>(<span class="dt">dragmode =</span> <span class="st">&quot;select&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">highlight</span>(<span class="dt">dynamic =</span> <span class="ot">TRUE</span>, <span class="dt">persistent =</span> <span class="ot">TRUE</span>)

map &lt;-<span class="st"> </span><span class="kw">leaflet</span>(sd) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">addTiles</span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">addCircles</span>()

htmltools::<span class="kw">tagList</span>(p, map)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">include_graphics</span>(<span class="st">&quot;images/plotlyLeaflet.gif&quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:leaflet"></span>
<img src="images/plotlyLeaflet.gif" alt="Linking views between plotly and leaflet to explore the relation between magnitude and geographic location of earthquakes around Fiji. The video may be accessed [here](http://i.imgur.com/hd0tG0r.gif)" align:"center" />
<p class="caption">
Figure 4.8: Linking views between plotly and leaflet to explore the relation between magnitude and geographic location of earthquakes around Fiji. The video may be accessed <a href="http://i.imgur.com/hd0tG0r.gif">here</a>
</p>
</div>
<p>In Figure <a href="linking-views-without-shiny.html#fig:leaflet">4.8</a>, the user first highlights earthquakes with a magnitude of 5 or higher in red (via plotly), then earthquakes with a magnitude of 4.5 or lower, and the corresponding earthquakes are highlighted in the leaflet map. This immediately reveals an interesting relationship in magnitude and geographic location, and leaflet provides the ability to zoom and pan on the map to investigate regions that have a high density of quakes. It’s worth noting that the <strong>crosstalk</strong> package itself does not provide semantics for describing persistent/dynamic selections, but <strong>plotly</strong> does inform crosstalk about these semantics which other <strong>htmlwidget</strong> authors can access in their JavaScript rendering logic.</p>
</div>
<div id="the-shareddata-plot-pipeline" class="section level3">
<h3><span class="header-section-number">4.2.4</span> The SharedData plot pipeline</h3>
<p>Sometimes it is useful to display a summary (i.e., overview) in one view and link that summary to more detailed views. Figure <a href="linking-views-without-shiny.html#fig:bars-lines">4.9</a> is one such example that displays a bar chart of all Texan cities with one or more missing values (the summary) linked with their values over time (the details). By default, the bar chart allows us to quickly see which cities have the most missing values, and by clicking a specific bar, it reveals the relationship between missing values and time for a given city. In cities with the most missing values, data did not start appearing until somewhere around 2006-2010, but for most other cities (e.g., Harlingen, Galveston, Temple-Belton, etc), values started appearing in 2000, but for some reason go missing around 2002-2003.</p>
<div class="figure"><span id="fig:bars-lines"></span>
<img src="images/plotlyLinkedBars.gif" alt="A bar chart of cities with one or more missing median house sales linked to a time series of those sales over time. The video may be accessed [here](http://i.imgur.com/hzVe2FR.gif)" align:"center" />
<p class="caption">
Figure 4.9: A bar chart of cities with one or more missing median house sales linked to a time series of those sales over time. The video may be accessed <a href="http://i.imgur.com/hzVe2FR.gif">here</a>
</p>
</div>
<p>When implementing linked views like Figure <a href="linking-views-without-shiny.html#fig:bars-lines">4.9</a>, it can be helpful to conceptualize a pipeline between a central data frame and the corresponding views. Figure <a href="linking-views-without-shiny.html#fig:pipeline">4.10</a> is a visual depcition of this conceptual model between the central data frame and the eventual linked views in Figure <a href="linking-views-without-shiny.html#fig:bars-lines">4.9</a>. In order to generate the bar chart on the left, the pipeline contains a function for computing summary statistics (the number of missing values per city). On the other hand, the time series does not require any summarization – implying the pipeline for this view is the identity function.</p>
<div class="figure"><span id="fig:pipeline"></span>
<img src="images/pipeline.png" alt="A diagram of the pipeline between the data and graphics." width="502" align:"center" />
<p class="caption">
Figure 4.10: A diagram of the pipeline between the data and graphics.
</p>
</div>
<p>Since the pipeline from data to graphic is either an identity function or a summarization of some kind, it is good idea to use the most granular form of the data for the <code>SharedData</code> object, and use <a href="a-case-study-of-housing-sales-in-texas.html#the-data-plot-pipeline">the data-plot-pipeline</a> to define a pipeline from the data to the plot. As <span class="citation">Wickham et al. (<a href="references.html#ref-plumbing">2010</a>)</span> writes, a true interactive graphics system is aware of the both the function from the central data object to the graphic, as well as the inverse function (i.e., the function from the graphic back to the cental data object). As it currently stands, <strong>plotly</strong> loses this information when the result is pushed to the web browser, but that does not matter for Figure <a href="linking-views-without-shiny.html#fig:bars-lines">4.9</a> since pipelines do not have to re-execute upon user selections.<a href="#fn15" class="footnoteRef" id="fnref15"><sup>15</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd &lt;-<span class="st"> </span>SharedData$<span class="kw">new</span>(txhousing, ~city)

base &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(sd, <span class="dt">color =</span> <span class="kw">I</span>(<span class="st">&quot;black&quot;</span>)) %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(city)

p1 &lt;-<span class="st"> </span>base %&gt;%
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">has =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(median))) %&gt;%
<span class="st">  </span><span class="kw">filter</span>(has &gt;<span class="st"> </span><span class="dv">0</span>) %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(has) %&gt;%
<span class="st">  </span><span class="kw">add_bars</span>(<span class="dt">x =</span> ~has, <span class="dt">y =</span> ~<span class="kw">factor</span>(city, <span class="dt">levels =</span> city), <span class="dt">hoverinfo =</span> <span class="st">&quot;none&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">layout</span>(
    <span class="dt">barmode =</span> <span class="st">&quot;overlay&quot;</span>,
    <span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Number of months missing&quot;</span>),
    <span class="dt">yaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;&quot;</span>)
  ) 

p2 &lt;-<span class="st"> </span>base %&gt;%
<span class="st">  </span><span class="kw">add_lines</span>(<span class="dt">x =</span> ~date, <span class="dt">y =</span> ~median, <span class="dt">alpha =</span> <span class="fl">0.3</span>) %&gt;%
<span class="st">  </span><span class="kw">layout</span>(<span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;&quot;</span>))

<span class="kw">subplot</span>(p1, p2, <span class="dt">titleX =</span> <span class="ot">TRUE</span>, <span class="dt">widths =</span> <span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>)) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">layout</span>(<span class="dt">margin =</span> <span class="kw">list</span>(<span class="dt">l =</span> <span class="dv">120</span>)) %&gt;%
<span class="st">  </span><span class="kw">highlight</span>(<span class="dt">on =</span> <span class="st">&quot;plotly_click&quot;</span>, <span class="dt">off =</span> <span class="st">&quot;plotly_unhover&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
</div>
<div id="dynamic-aggregates" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Dynamic aggregates</h3>
</div>
<div id="more-examples" class="section level3">
<h3><span class="header-section-number">4.2.6</span> More examples</h3>
<p>The most up-to-date examples are kept</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crosstalkDir &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;examples&quot;</span>, <span class="st">&quot;crosstalk&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;plotly&quot;</span>)
<span class="kw">list.files</span>(crosstalkDir)
<span class="co">#&gt; [1] &quot;01-intro.R&quot;              &quot;02-basic-ggplotly.R&quot;    </span>
<span class="co">#&gt; [3] &quot;03-linked-scatterplot.R&quot; &quot;04-linked-leaflet.R&quot;    </span>
<span class="co">#&gt; [5] &quot;05-ggally-ggpairs.R&quot;     &quot;06-plotly-pipeline.R&quot;   </span>
<span class="co">#&gt; [7] &quot;07-binned-target.R&quot;      &quot;shiny&quot;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="kw">file.path</span>(crosstalkDir, <span class="st">&quot;07-binned-target.R&quot;</span>), <span class="dt">print.eval =</span> <span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="custom-linking-via-javascript" class="section level3">
<h3><span class="header-section-number">4.2.7</span> Custom linking via JavaScript</h3>
<p>Accessing plotly.js events in shiny is easy (<a href="https://plot.ly/r/shiny-tutorial/">for example</a>), but shiny adds a lot of additional infrastructure that makes it hard to share your work, especially at scale. Very soon, plotly R users will have ways to perform <a href="https://cpsievert.github.io/plotly_book/highlighting.html">highlighting</a> and <a href="https://cpsievert.github.io/plotly_book/linked-highlighting.html">linked highlighting</a> without shiny or any knowledge of HTML/JavaScript. However, if you do know some JavaScript, you can access (and respond to) plotly.js events without shiny, without having to leave the comfort of your R prompt, thanks to the <code>onRender()</code> function from the <strong>htmlwidgets</strong> package <span class="citation">(Vaidyanathan et al. <a href="references.html#ref-htmlwidgets">2016</a>)</span>. This function allows you to write a JavaScript function which will be invoked on the htmlwidget object after it is done rendering. This JavaScript function should have at least two arguments: (1) the DOM element containing the htmlwidget (<code>el</code>) and (2) the data passed from R (<code>x</code>). Figure <a href="linking-views-without-shiny.html#fig:hover-log">4.11</a> the <code>onRender()</code> function to send “event data” to the browser’s console upon hovering a point.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plotly)
<span class="kw">library</span>(htmlwidgets)
<span class="kw">plot_ly</span>(mtcars, <span class="dt">x =</span> ~wt, <span class="dt">y =</span> ~mpg) %&gt;%
<span class="st">  </span><span class="kw">onRender</span>(<span class="st">&quot;</span>
<span class="st">    function(el, x) {</span>
<span class="st">      var gd = document.getElementById(el.id);</span>
<span class="st">      gd.on(&#39;plotly_hover&#39;, function(pt) { console.log(&#39;hover&#39;, pt); });</span>
<span class="st">    }</span>
<span class="st">  &quot;</span>)</code></pre></div>
<div class="figure"><span id="fig:hover-log"></span>
<div id="htmlwidget-e56ad552239eac452f54" style="width:576px;height:355.968px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e56ad552239eac452f54">{"x":{"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"wt"},"yaxis":{"domain":[0,1],"title":"mpg"},"hovermode":"closest","dragmode":"zoom","showlegend":false},"source":"A","data":[{"x":[2.62,2.875,2.32,3.215,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.424,5.345,2.2,1.615,1.835,2.465,3.52,3.435,3.84,3.845,1.935,2.14,1.513,3.17,2.77,3.57,2.78],"y":[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],"type":"scatter","mode":"markers","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y"}],"highlight":{"on":"plotly_selected","off":"plotly_relayout","dynamic":false,"persistent":false,"defaultValues":null,"color":null,"opacityDim":0.2,"showInLegend":false},"base_url":"https://plot.ly"},"evals":[],"jsHooks":{"render":[{"code":"\n    function(el, x) {\n      var gd = document.getElementById(el.id);\n      gd.on('plotly_hover', function(pt) { console.log('hover', pt); });\n    }\n  ","data":null}]}}</script>
<p class="caption">
Figure 4.11: A simple scatterplot that emits data whenever the user hovers on a point.
</p>
</div>
</div>
<div id="limitations" class="section level3">
<h3><span class="header-section-number">4.2.8</span> Limitations</h3>
<p>As discussed in previous chapters, <strong>plotly</strong> graphs have zoom, pan, and identification type interactions enabled by default. This chapter discusses methods that enable other types of useful interactions listed in Table <a href="linking-views-without-shiny.html#tab:techniques">4.1</a>.</p>
<table>
<caption><span id="tab:techniques">Table 4.1: </span>A taxonomy of interaction types</caption>
<thead>
<tr class="header">
<th align="left">Technique</th>
<th align="left">Related Questions</th>
<th align="left">Examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Identification</td>
<td align="left">What is this point/mark?</td>
<td align="left">Hover for additional info</td>
</tr>
<tr class="even">
<td align="left">Zoom &amp; pan</td>
<td align="left">Is there local structure that can’t be viewed globally?</td>
<td align="left">Click &amp; drag to alter x/y axis limits</td>
</tr>
<tr class="odd">
<td align="left">Animation</td>
<td align="left">How does a distribution change over time? <br /> How does a fitted model look when projected into high-dimensional space?</td>
<td align="left">The grand tour</td>
</tr>
<tr class="even">
<td align="left">Linked highlighting</td>
<td align="left">How does the marginal/joint compare to a conditional?</td>
<td align="left">Linked brushing on a scatterplot matrix</td>
</tr>
<tr class="odd">
<td align="left">Filter</td>
<td align="left">How does this subset compare to another? <br /> What happened during this time period?</td>
<td align="left">Click on legend entries <br /> <code>shiny::selectInput()</code> / <code>shiny::sliderInput()</code></td>
</tr>
</tbody>
</table>
<ul>
<li>Currently not working with filled polygons (TODO: is this still true?) – <a href="https://github.com/plotly/plotly.js/issues/884" class="uri">https://github.com/plotly/plotly.js/issues/884</a></li>
<li>Currently not working with gl2d – <a href="https://github.com/plotly/plotly.js/issues/886" class="uri">https://github.com/plotly/plotly.js/issues/886</a></li>
<li>Currently leaflet is the only htmlwidget, with crosstalk support, that will respect non-default arguments in plotly’s highlight() function.</li>
</ul>

</div>
</div>
<!-- </div> -->
<div class="footnotes">
<hr />
<ol start="15">
<li id="fn15"><p>Since <strong>dplyr</strong> semantics translate to <code>SQL</code> primitives, you could imagine a system that translates a data-plot-pipeline to <code>SQL</code> queries, and dynamically re-executes within the browser via something like <code>SQL.js</code> <span class="citation">(LOJKINE <a href="references.html#ref-SQLjs">2016</a>)</span>.<a href="linking-views-without-shiny.html#fnref15">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linking-views-with-shiny.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="animating-views.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cpsievert/plotly_book/edit/master/linked-views.Rmd",
"text": "Edit"
},
"download": ["plotly_book.pdf", "plotly_book.epub", "plotly_book.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', 'UA-39373211-1', 'auto');ga('send', 'pageview');</script>
</body>

</html>
